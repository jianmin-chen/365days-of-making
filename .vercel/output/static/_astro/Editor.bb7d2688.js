import{j as ni}from"./jsx-runtime.7d759e48.js";import{R as we,r as ke,c as cc}from"./index.8365acb2.js";import{r as uc,R as dc}from"./index.ddb867f9.js";function de(n){this.content=n}de.prototype={constructor:de,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),s=r.content.slice();return i==-1?s.push(t||n,e):(s[i+1]=e,t&&(s[i]=t)),new de(s)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new de(t)},addToStart:function(n,e){return new de([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new de(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),s=r.find(n);return i.splice(s==-1?i.length:s,0,e,t),new de(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=de.from(n),n.size?new de(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=de.from(n),n.size?new de(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=de.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};de.from=function(n){if(n instanceof de)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new de(e)};function pl(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),s=e.child(r);if(i==s){t+=i.nodeSize;continue}if(!i.sameMarkup(s))return t;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)t++;return t}if(i.content.size||s.content.size){let o=pl(i.content,s.content,t+1);if(o!=null)return o}t+=i.nodeSize}}function ml(n,e,t,r){for(let i=n.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:t,b:r};let o=n.child(--i),l=e.child(--s),a=o.nodeSize;if(o==l){t-=a,r-=a;continue}if(!o.sameMarkup(l))return{a:t,b:r};if(o.isText&&o.text!=l.text){let c=0,u=Math.min(o.text.length,l.text.length);for(;c<u&&o.text[o.text.length-c-1]==l.text[l.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||l.content.size){let c=ml(o.content,l.content,t-1,r-1);if(c)return c}t-=a,r-=a}}class S{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,s){for(let o=0,l=0;l<t;o++){let a=this.content[o],c=l+a.nodeSize;if(c>e&&r(a,i+l,s||null,o)!==!1&&a.content.size){let u=l+1;a.nodesBetween(Math.max(0,e-u),Math.min(a.content.size,t-u),r,i+u)}l=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let s="",o=!0;return this.nodesBetween(e,t,(l,a)=>{l.isText?(s+=l.text.slice(Math.max(e,a)-a,t-a),o=!r):l.isLeaf?(i?s+=typeof i=="function"?i(l):i:l.type.spec.leafText&&(s+=l.type.spec.leafText(l)),o=!r):!o&&l.isBlock&&(s+=r,o=!0)},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new S(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let s=0,o=0;o<t;s++){let l=this.content[s],a=o+l.nodeSize;a>e&&((o<e||a>t)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,t-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,t-o-1))),r.push(l),i+=l.nodeSize),o=a}return new S(r,i)}cutByIndex(e,t){return e==t?S.empty:e==0&&t==this.content.length?this:new S(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),s=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new S(i,s)}addToStart(e){return new S([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new S(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return pl(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return ml(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Jn(0,e);if(e==this.size)return Jn(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let s=this.child(r),o=i+s.nodeSize;if(o>=e)return o==e||t>0?Jn(r+1,o):Jn(r,i);i=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return S.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new S(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return S.empty;let t,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(t||(t=e.slice(0,i)),t[t.length-1]=s.withText(t[t.length-1].text+s.text)):t&&t.push(s)}return new S(t||e,r)}static from(e){if(!e)return S.empty;if(e instanceof S)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new S([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}S.empty=new S([],0);const ri={index:0,offset:0};function Jn(n,e){return ri.index=n,ri.offset=e,ri}function or(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!or(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!or(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let G=class Ii{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))t||(t=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(s)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&or(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Ii.none;if(e instanceof Ii)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};G.none=[];class lr extends Error{}class A{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=yl(this.content,e+this.openStart,t);return r&&new A(r,this.openStart,this.openEnd)}removeBetween(e,t){return new A(gl(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return A.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new A(S.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(t||!s.type.spec.isolating);s=s.lastChild)i++;return new A(e,r,i)}}A.empty=new A(S.empty,0,0);function gl(n,e,t){let{index:r,offset:i}=n.findIndex(e),s=n.maybeChild(r),{index:o,offset:l}=n.findIndex(t);if(i==e||s.isText){if(l!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,s.copy(gl(s.content,e-i-1,t-i-1)))}function yl(n,e,t,r){let{index:i,offset:s}=n.findIndex(e),o=n.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,t)?null:n.cut(0,e).append(t).append(n.cut(e));let l=yl(o.content,e-s-1,t);return l&&n.replaceChild(i,o.copy(l))}function hc(n,e,t){if(t.openStart>n.depth)throw new lr("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new lr("Inconsistent open depths");return bl(n,e,t,0)}function bl(n,e,t,r){let i=n.index(r),s=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let o=bl(n,e,t,r+1);return s.copy(s.content.replaceChild(i,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,l=o.content;return Ht(o,l.cut(0,n.parentOffset).append(t.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=fc(t,n);return Ht(s,Sl(n,o,l,e,r))}else return Ht(s,ar(n,e,r))}function kl(n,e){if(!e.type.compatibleContent(n.type))throw new lr("Cannot join "+e.type.name+" onto "+n.type.name)}function Di(n,e,t){let r=n.node(t);return kl(r,e.node(t)),r}function $t(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function On(n,e,t,r){let i=(e||n).node(t),s=0,o=e?e.index(t):i.childCount;n&&(s=n.index(t),n.depth>t?s++:n.textOffset&&($t(n.nodeAfter,r),s++));for(let l=s;l<o;l++)$t(i.child(l),r);e&&e.depth==t&&e.textOffset&&$t(e.nodeBefore,r)}function Ht(n,e){return n.type.checkContent(e),n.copy(e)}function Sl(n,e,t,r,i){let s=n.depth>i&&Di(n,e,i+1),o=r.depth>i&&Di(t,r,i+1),l=[];return On(null,n,i,l),s&&o&&e.index(i)==t.index(i)?(kl(s,o),$t(Ht(s,Sl(n,e,t,r,i+1)),l)):(s&&$t(Ht(s,ar(n,e,i+1)),l),On(e,t,i,l),o&&$t(Ht(o,ar(t,r,i+1)),l)),On(r,null,i,l),new S(l)}function ar(n,e,t){let r=[];if(On(null,n,t,r),n.depth>t){let i=Di(n,e,t+1);$t(Ht(i,ar(n,e,t+1)),r)}return On(e,null,t,r),new S(r)}function fc(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let s=t-1;s>=0;s--)i=e.node(s).copy(S.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class Pn{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return G.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new cr(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,s=t;for(let o=e;;){let{index:l,offset:a}=o.content.findIndex(s),c=s-a;if(r.push(o,l,i+a),!c||(o=o.child(l),o.isText))break;s=c-1,i+=a+1}return new Pn(t,r,s)}static resolveCached(e,t){for(let i=0;i<ii.length;i++){let s=ii[i];if(s.pos==t&&s.doc==e)return s}let r=ii[si]=Pn.resolve(e,t);return si=(si+1)%pc,r}}let ii=[],si=0,pc=12;class cr{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const mc=Object.create(null);let Vt=class Ri{constructor(e,t,r,i=G.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||S.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&or(this.attrs,t||e.defaultAttrs||mc)&&G.sameSet(this.marks,r||G.none)}copy(e=null){return e==this.content?this:new Ri(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Ri(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return A.empty;let i=this.resolve(e),s=this.resolve(t),o=r?0:i.sharedDepth(t),l=i.start(o),c=i.node(o).content.cut(i.pos-l,s.pos-l);return new A(c,i.depth-o,s.depth-o)}replace(e,t,r){return hc(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return Pn.resolveCached(this,e)}resolveNoCache(e){return Pn.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),wl(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=S.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let a=i;a<s;a++)if(!this.type.allowsMarks(r.child(a).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=G.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!G.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=S.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,i,r)}};Vt.prototype.text=void 0;class ur extends Vt{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):wl(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new ur(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new ur(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function wl(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Kt{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new gc(e,t);if(r.next==null)return Kt.empty;let i=xl(r);r.next&&r.err("Unexpected trailing text");let s=Mc(xc(i));return Cc(s,r),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let s=t;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function s(o,l){let a=o.matchFragment(e,r);if(a&&(!t||a.validEnd))return S.from(l.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:d}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let h=s(d,l.concat(u));if(h)return h}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:a}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in t)&&(!i.type||a.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),t[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Kt.empty=new Kt(!0);class gc{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function xl(n){let e=[];do e.push(yc(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function yc(n){let e=[];do e.push(bc(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function bc(n){let e=wc(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=kc(n,e);else break;return e}function Vs(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function kc(n,e){let t=Vs(n),r=t;return n.eat(",")&&(n.next!="}"?r=Vs(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function Sc(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let s in t){let o=t[s];o.groups.indexOf(e)>-1&&i.push(o)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function wc(n){if(n.eat("(")){let e=xl(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=Sc(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function xc(n){let e=[[]];return i(s(n,0),t()),e;function t(){return e.push([])-1}function r(o,l,a){let c={term:a,to:l};return e[o].push(c),c}function i(o,l){o.forEach(a=>a.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((a,c)=>a.concat(s(c,l)),[]);if(o.type=="seq")for(let a=0;;a++){let c=s(o.exprs[a],l);if(a==o.exprs.length-1)return c;i(c,l=t())}else if(o.type=="star"){let a=t();return r(l,a),i(s(o.expr,a),a),[r(a)]}else if(o.type=="plus"){let a=t();return i(s(o.expr,l),a),i(s(o.expr,a),a),[r(a)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let a=l;for(let c=0;c<o.min;c++){let u=t();i(s(o.expr,a),u),a=u}if(o.max==-1)i(s(o.expr,a),a);else for(let c=o.min;c<o.max;c++){let u=t();r(a,u),i(s(o.expr,a),u),a=u}return[r(a)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Ml(n,e){return e-n}function js(n,e){let t=[];return r(e),t.sort(Ml);function r(i){let s=n[i];if(s.length==1&&!s[0].term)return r(s[0].to);t.push(i);for(let o=0;o<s.length;o++){let{term:l,to:a}=s[o];!l&&t.indexOf(a)==-1&&r(a)}}}function Mc(n){let e=Object.create(null);return t(js(n,0));function t(r){let i=[];r.forEach(o=>{n[o].forEach(({term:l,to:a})=>{if(!l)return;let c;for(let u=0;u<i.length;u++)i[u][0]==l&&(c=i[u][1]);js(n,a).forEach(u=>{c||i.push([l,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let s=e[r.join(",")]=new Kt(r.indexOf(n.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(Ml);s.next.push({type:i[o][0],next:e[l.join(",")]||t(l)})}return s}}function Cc(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:a,next:c}=i.next[l];o.push(a.name),s&&!(a.isText||a.hasRequiredAttrs())&&(s=!1),r.indexOf(c)==-1&&r.push(c)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Cl(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function El(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let s=n[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Ol(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new Ec(n[t]);return e}let _s=class Tl{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Ol(r.attrs),this.defaultAttrs=Cl(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Kt.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:El(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Vt(this,this.computeAttrs(e),S.from(t),G.setFrom(r))}createChecked(e=null,t,r){return t=S.from(t),this.checkContent(t),new Vt(this,this.computeAttrs(e),t,G.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=S.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let i=this.contentMatch.matchFragment(t),s=i&&i.fillBefore(S.empty,!0);return s?new Vt(this,e,t.append(s),G.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:G.none:e}static compile(e,t){let r=Object.create(null);e.forEach((s,o)=>r[s]=new Tl(s,t,o));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class Ec{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class zr{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=Ol(i.attrs),this.excluded=null;let s=Cl(this.attrs);this.instance=s?new G(this,s):null}create(e=null){return!e&&this.instance?this.instance:new G(this,El(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new zr(s,i++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class Oc{constructor(e){this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=de.from(e.nodes),t.marks=de.from(e.marks||{}),this.nodes=_s.compile(this.spec.nodes,this),this.marks=zr.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;s.contentMatch=r[o]||(r[o]=Kt.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.markSet=l=="_"?null:l?Ws(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:Ws(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof _s){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new ur(r,r.defaultAttrs,e,G.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Vt.fromJSON(this,e)}markFromJSON(e){return G.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Ws(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],s=n.marks[i],o=s;if(s)t.push(s);else for(let l in n.marks){let a=n.marks[l];(i=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(i)>-1)&&t.push(o=a)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}class pn{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{r.tag?this.tags.push(r):r.style&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let i=e.nodes[r.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Us(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Us(this,t,!0);return r.addAll(e,t.from,t.to),A.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(Nc(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||t.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,t,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=t))){if(o.getAttrs){let a=o.getAttrs(t);if(a===!1)continue;o.attrs=a||void 0}return o}}}static schemaRules(e){let t=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<t.length;o++){let l=t[o];if((l.priority==null?50:l.priority)<s)break}t.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Js(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=Js(o)),o.node||o.ignore||o.mark||(o.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new pn(e,pn.schemaRules(e)))}}const Al={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Tc={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Nl={ol:!0,ul:!0},dr=1,hr=2,Tn=4;function Ks(n,e,t){return e!=null?(e?dr:0)|(e==="full"?hr:0):n&&n.whitespace=="pre"?dr|hr:t&~Tn}class qn{constructor(e,t,r,i,s,o,l){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=i,this.solid=s,this.options=l,this.content=[],this.activeMarks=G.none,this.stashMarks=[],this.match=o||(l&Tn?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(S.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&dr)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let t=S.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(S.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let i=r[t];(this.type?this.type.allowsMarkType(i.type):Ic(i.type,e))&&!i.isInSet(this.activeMarks)&&(this.activeMarks=i.addToSet(this.activeMarks),this.pendingMarks=i.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Al.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Us{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let i=t.topNode,s,o=Ks(null,t.preserveWhitespace,0)|(r?Tn:0);i?s=new qn(i.type,i.attrs,G.none,G.none,!0,t.topMatch||i.type.contentMatch,o):r?s=new qn(null,null,G.none,G.none,!0,null,o):s=new qn(e.schema.topNodeType,null,G.none,G.none,!0,null,o),this.nodes=[s],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let i=this.readStyles(vc(r));if(!i)return;let[s,o]=i,l=this.top;for(let a=0;a<o.length;a++)this.removePendingMark(o[a],l);for(let a=0;a<s.length;a++)this.addPendingMark(s[a]);t();for(let a=0;a<s.length;a++)this.removePendingMark(s[a],l);for(let a=0;a<o.length;a++)this.addPendingMark(o[a])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&hr||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&dr)r.options&hr?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let i=r.content[r.content.length-1],s=e.previousSibling;(!i||s&&s.nodeName=="BR"||i.isText&&/[ \t\r\n\u000c]$/.test(i.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),i;Nl.hasOwnProperty(r)&&this.parser.normalizeLists&&Ac(e);let s=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(i=this.parser.matchTag(e,this,t));if(s?s.ignore:Tc.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!s||s.skip||s.closeParent){s&&s.closeParent?this.open=Math.max(0,this.open-1):s&&s.skip.nodeType&&(e=s.skip);let o,l=this.top,a=this.needsBlock;if(Al.hasOwnProperty(r))l.content.length&&l.content[0].isInline&&this.open&&(this.open--,l=this.top),o=!0,l.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}s&&s.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(l),this.needsBlock=a}else this.withStyleRules(e,()=>{this.addElementByRule(e,s,s.consuming===!1?i:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=G.none,r=G.none;for(let i=0;i<e.length;i+=2)for(let s=void 0;;){let o=this.parser.matchStyle(e[i],e[i+1],this,s);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(l=>{o.clearMark(l)&&(r=l.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)s=o;else break}return[t,r]}addElementByRule(e,t,r){let i,s,o;t.node?(s=this.parser.schema.nodes[t.node],s.isLeaf?this.insertNode(s.create(t.attrs))||this.leafFallback(e):i=this.enter(s,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let l=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(a=>this.insertNode(a));else{let a=e;typeof t.contentElement=="string"?a=e.querySelector(t.contentElement):typeof t.contentElement=="function"?a=t.contentElement(e):t.contentElement&&(a=t.contentElement),this.findAround(e,a,!0),this.addAll(a)}i&&this.sync(l)&&this.open--,o&&this.removePendingMark(o,l)}addAll(e,t,r){let i=t||0;for(let s=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s);this.findAtPoint(e,i)}findPlace(e){let t,r;for(let i=this.open;i>=0;i--){let s=this.nodes[i],o=s.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=s,!o.length)||s.solid)break}if(!t)return!1;this.sync(r);for(let i=0;i<t.length;i++)this.enterInner(t[i],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let i=0;i<e.marks.length;i++)(!t.type||t.type.allowsMarkType(e.marks[i].type))&&(r=e.marks[i].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let i=this.findPlace(e.create(t));return i&&this.enterInner(e,t,!0,r),i}enterInner(e,t=null,r=!1,i){this.closeExtra();let s=this.top;s.applyPending(e),s.match=s.match&&s.match.matchType(e);let o=Ks(e,i,s.options);s.options&Tn&&s.content.length==0&&(o|=Tn),this.nodes.push(new qn(e,t,s.activeMarks,s.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,a)=>{for(;l>=0;l--){let c=t[l];if(c==""){if(l==t.length-1||l==0)continue;for(;a>=s;a--)if(o(l-1,a))return!0;return!1}else{let u=a>0||a==0&&i?this.nodes[a].type:r&&a>=s?r.node(a-s).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;a--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=Dc(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let i=this.nodes[r];if(i.pendingMarks.lastIndexOf(e)>-1)i.pendingMarks=e.removeFromSet(i.pendingMarks);else{i.activeMarks=e.removeFromSet(i.activeMarks);let o=i.popFromStashMark(e);o&&i.type&&i.type.allowsMarkType(o.type)&&(i.activeMarks=o.addToSet(i.activeMarks))}if(i==t)break}}}function Ac(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Nl.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function Nc(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function vc(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function Js(n){let e={};for(let t in n)e[t]=n[t];return e}function Ic(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let s=[],o=l=>{s.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:u}=l.edge(a);if(c==e||s.indexOf(u)<0&&o(u))return!0}};if(o(i.contentMatch))return!0}}function Dc(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Xe{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=oi(t).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,a=0;for(;l<s.length&&a<o.marks.length;){let c=o.marks[a];if(!this.marks[c.type.name]){a++;continue}if(!c.eq(s[l][0])||c.type.spec.spanning===!1)break;l++,a++}for(;l<s.length;)i=s.pop()[1];for(;a<o.marks.length;){let c=o.marks[a++],u=this.serializeMark(c,o.isInline,t);u&&(s.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=Xe.renderSpec(oi(t),this.nodes[e.type.name](e));if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,t);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&Xe.renderSpec(oi(r),i(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let i=t[0],s=i.indexOf(" ");s>0&&(r=i.slice(0,s),i=i.slice(s+1));let o,l=r?e.createElementNS(r,i):e.createElement(i),a=t[1],c=1;if(a&&typeof a=="object"&&a.nodeType==null&&!Array.isArray(a)){c=2;for(let u in a)if(a[u]!=null){let d=u.indexOf(" ");d>0?l.setAttributeNS(u.slice(0,d),u.slice(d+1),a[u]):l.setAttribute(u,a[u])}}for(let u=c;u<t.length;u++){let d=t[u];if(d===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:h,contentDOM:f}=Xe.renderSpec(e,d,r);if(l.appendChild(h),f){if(o)throw new RangeError("Multiple content holes");o=f}}}return{dom:l,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Xe(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=qs(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return qs(e.marks)}}function qs(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function oi(n){return n.document||window.document}const vl=65535,Il=Math.pow(2,16);function Rc(n,e){return n+e*Il}function Gs(n){return n&vl}function Pc(n){return(n-(n&vl))/Il}const Dl=1,Rl=2,tr=4,Pl=8;class Pi{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Pl)>0}get deletedBefore(){return(this.delInfo&(Dl|tr))>0}get deletedAfter(){return(this.delInfo&(Rl|tr))>0}get deletedAcross(){return(this.delInfo&tr)>0}}class Fe{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&Fe.empty)return Fe.empty}recover(e){let t=0,r=Gs(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+Pc(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?i:0);if(a>e)break;let c=this.ranges[l+s],u=this.ranges[l+o],d=a+c;if(e<=d){let h=c?e==a?-1:e==d?1:t:t,f=a+i+(h<0?0:u);if(r)return f;let p=e==(t<0?a:d)?null:Rc(l/3,e-a),m=e==a?Rl:e==d?Dl:tr;return(t<0?e!=a:e!=d)&&(m|=Pl),new Pi(f,m,p)}i+=u-c}return r?e+i:new Pi(e+i,0,null)}touches(e,t){let r=0,i=Gs(t),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let c=this.ranges[l+s],u=a+c;if(e<=u&&l==i*3)return!0;r+=this.ranges[l+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),a=o+(this.inverted?0:s),c=this.ranges[i+t],u=this.ranges[i+r];e(l,l+c,a,a+u),s+=u-c}}invert(){return new Fe(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Fe.empty:new Fe(e<0?[0,-e,0]:[0,0,e])}}Fe.empty=new Fe([]);class un{constructor(e=[],t,r=0,i=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=i}slice(e=0,t=this.maps.length){return new un(this.maps,this.mirror,e,t)}copy(){return new un(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let i=e.getMirror(t);this.appendMap(e.maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e.maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new un;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this.maps[s],l=o.mapResult(e,t);if(l.recover!=null){let a=this.getMirror(s);if(a!=null&&a>s&&a<this.to){s=a,e=this.maps[a].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new Pi(e,i,null)}}const li=Object.create(null);class Re{getMap(){return Fe.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=li[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in li)throw new RangeError("Duplicate use of step JSON ID "+e);return li[e]=t,t.prototype.jsonID=e,t}}class ie{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ie(e,null)}static fail(e){return new ie(null,e)}static fromReplace(e,t,r,i){try{return ie.ok(e.replace(t,r,i))}catch(s){if(s instanceof lr)return ie.fail(s.message);throw s}}}function ss(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let s=n.child(i);s.content.size&&(s=s.copy(ss(s.content,e,s))),s.isInline&&(s=e(s,t,i)),r.push(s)}return S.fromArray(r)}class gt extends Re{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new A(ss(t.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),t.openStart,t.openEnd);return ie.fromReplace(e,this.from,this.to,s)}invert(){return new Qe(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new gt(t.pos,r.pos,this.mark)}merge(e){return e instanceof gt&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new gt(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new gt(t.from,t.to,e.markFromJSON(t.mark))}}Re.jsonID("addMark",gt);class Qe extends Re{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new A(ss(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return ie.fromReplace(e,this.from,this.to,r)}invert(){return new gt(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Qe(t.pos,r.pos,this.mark)}merge(e){return e instanceof Qe&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Qe(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Qe(t.from,t.to,e.markFromJSON(t.mark))}}Re.jsonID("removeMark",Qe);class yt extends Re{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ie.fromReplace(e,this.pos,this.pos+1,new A(S.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new yt(this.pos,t.marks[i]);return new yt(this.pos,this.mark)}}return new mn(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new yt(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new yt(t.pos,e.markFromJSON(t.mark))}}Re.jsonID("addNodeMark",yt);class mn extends Re{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ie.fromReplace(e,this.pos,this.pos+1,new A(S.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new yt(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new mn(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new mn(t.pos,e.markFromJSON(t.mark))}}Re.jsonID("removeNodeMark",mn);class he extends Re{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&Li(e,this.from,this.to)?ie.fail("Structure replace would overwrite content"):ie.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Fe([this.from,this.to-this.from,this.slice.size])}invert(e){return new he(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new he(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof he)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?A.empty:new A(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new he(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?A.empty:new A(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new he(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new he(t.from,t.to,A.fromJSON(e,t.slice),!!t.structure)}}Re.jsonID("replace",he);class ae extends Re{constructor(e,t,r,i,s,o,l=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(Li(e,this.from,this.gapFrom)||Li(e,this.gapTo,this.to)))return ie.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ie.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ie.fromReplace(e,this.from,this.to,r):ie.fail("Content does not fit in gap")}getMap(){return new Fe([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new ae(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=e.map(this.gapFrom,-1),s=e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||s>r.pos?null:new ae(t.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new ae(t.from,t.to,t.gapFrom,t.gapTo,A.fromJSON(e,t.slice),t.insert,!!t.structure)}}Re.jsonID("replaceAround",ae);function Li(n,e,t){let r=n.resolve(e),i=t-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Lc(n,e,t,r){let i=[],s=[],o,l;n.doc.nodesBetween(e,t,(a,c,u)=>{if(!a.isInline)return;let d=a.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+a.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(o&&o.to==h&&o.mark.eq(d[m])?o.to=f:i.push(o=new Qe(h,f,d[m])));l&&l.to==h?l.to=f:s.push(l=new gt(h,f,r))}}),i.forEach(a=>n.step(a)),s.forEach(a=>n.step(a))}function Bc(n,e,t,r){let i=[],s=0;n.doc.nodesBetween(e,t,(o,l)=>{if(!o.isInline)return;s++;let a=null;if(r instanceof zr){let c=o.marks,u;for(;u=r.isInSet(c);)(a||(a=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(a=[r]):a=o.marks;if(a&&a.length){let c=Math.min(l+o.nodeSize,t);for(let u=0;u<a.length;u++){let d=a[u],h;for(let f=0;f<i.length;f++){let p=i[f];p.step==s-1&&d.eq(i[f].style)&&(h=p)}h?(h.to=c,h.step=s):i.push({style:d,from:Math.max(l,e),to:c,step:s})}}}),i.forEach(o=>n.step(new Qe(o.from,o.to,o.style)))}function zc(n,e,t,r=t.contentMatch){let i=n.doc.nodeAt(e),s=[],o=e+1;for(let l=0;l<i.childCount;l++){let a=i.child(l),c=o+a.nodeSize,u=r.matchType(a.type);if(!u)s.push(new he(o,c,A.empty));else{r=u;for(let d=0;d<a.marks.length;d++)t.allowsMarkType(a.marks[d].type)||n.step(new Qe(o,c,a.marks[d]));if(a.isText&&!t.spec.code){let d,h=/\r?\n|\r/g,f;for(;d=h.exec(a.text);)f||(f=new A(S.from(t.schema.text(" ",t.allowedMarks(a.marks))),0,0)),s.push(new he(o+d.index,o+d.index+d[0].length,f))}}o=c}if(!r.validEnd){let l=r.fillBefore(S.empty,!0);n.replace(o,o,new A(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function Fc(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function wn(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),s=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(s,o,t))return r;if(r==0||i.type.spec.isolating||!Fc(i,s,o))break}return null}function $c(n,e,t){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),a=o,c=l,u=S.empty,d=0;for(let p=s,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=S.from(r.node(p).copy(u)),d++):a--;let h=S.empty,f=0;for(let p=s,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,h=S.from(i.node(p).copy(h)),f++):c++;n.step(new ae(a,c,o,l,new A(u.append(h),d,f),u.size-d,!0))}function ls(n,e,t=null,r=n){let i=Hc(n,e),s=i&&Vc(r,e);return s?i.map(Ys).concat({type:e,attrs:t}).concat(s.map(Ys)):null}function Ys(n){return{type:n,attrs:null}}function Hc(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return t.canReplaceWith(r,i,o)?s:null}function Vc(n,e){let{parent:t,startIndex:r,endIndex:i}=n,s=t.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;a&&c<i;c++)a=a.matchType(t.child(c).type);return!a||!a.validEnd?null:o}function jc(n,e,t){let r=S.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let l=t[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=S.from(t[o].type.create(t[o].attrs,r))}let i=e.start,s=e.end;n.step(new ae(i,s,i,s,new A(r,0,0),t.length,!0))}function _c(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=n.steps.length;n.doc.nodesBetween(e,t,(o,l)=>{if(o.isTextblock&&!o.hasMarkup(r,i)&&Wc(n.doc,n.mapping.slice(s).map(l),r)){n.clearIncompatible(n.mapping.slice(s).map(l,1),r);let a=n.mapping.slice(s),c=a.map(l,1),u=a.map(l+o.nodeSize,1);return n.step(new ae(c,u,c+1,u-1,new A(S.from(r.create(i,null,o.marks)),0,0),1,!0)),!1}})}function Wc(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function Kc(n,e,t,r,i){let s=n.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");t||(t=s.type);let o=t.create(r,null,i||s.marks);if(s.isLeaf)return n.replaceWith(e,e+s.nodeSize,o);if(!t.validContent(s.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new ae(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new A(S.from(o),0,0),1,!0))}function dn(n,e,t=1,r){let i=n.resolve(e),s=i.depth-t,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>s;c--,u--){let d=i.node(c),h=i.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(f))return!1}let l=i.indexAfter(s),a=r&&r[0];return i.node(s).canReplaceWith(l,l,a?a.type:i.node(s+1).type)}function Uc(n,e,t=1,r){let i=n.doc.resolve(e),s=S.empty,o=S.empty;for(let l=i.depth,a=i.depth-t,c=t-1;l>a;l--,c--){s=S.from(i.node(l).copy(s));let u=r&&r[c];o=S.from(u?u.type.create(u.attrs,o):i.node(l).copy(o))}n.step(new he(e,e,new A(s.append(o),t,t),!0))}function Et(n,e){let t=n.resolve(e),r=t.index();return Ll(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function Ll(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Fr(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):t>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&Ll(s,o)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function Jc(n,e,t){let r=new he(e-t,e+t,A.empty,!0);n.step(r)}function qc(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,t))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,t))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function Bl(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let s=0;s<t.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(t.openStart==0&&t.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,a=r.index(o)+(l>0?1:0),c=r.node(o),u=!1;if(s==1)u=c.canReplace(a,a,i);else{let d=c.contentMatchAt(a).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(a,a,d[0])}if(u)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function as(n,e,t=e,r=A.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),s=n.resolve(t);return zl(i,s,r)?new he(e,t,r):new Gc(i,s,r).fit()}function zl(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class Gc{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=S.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=S.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let a=new A(s,o,l);return e>-1?new ae(r.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||r.pos!=this.$to.pos?new he(r.pos,i.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=t.firstChild;if(t.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}t=s.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=ai(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:c}=this.frontier[l],u,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(S.from(o),!1)):s&&a.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:d};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:u};if(s&&c.matchType(s.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ai(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new A(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=ai(e,t);if(i.childCount<=1&&t>0){let s=e.size-t<=t+i.size;this.unplaced=new A(Mn(e,t-1,1),t-1,s?t-1:r)}else this.unplaced=new A(Mn(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:s}){for(;this.depth>t;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,l=r?r.content:o.content,a=o.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));d=d.matchFragment(i)}let f=l.size+e-(o.content.size-o.openEnd);for(;c<l.childCount;){let m=l.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||a==0||m.content.size)&&(d=g,u.push(Fl(m.mark(h.allowedMarks(m.marks)),c==1?a:0,c==l.childCount?f:-1)))}let p=c==l.childCount;p||(f=-1),this.placed=Cn(this.placed,t,S.from(u)),this.frontier[t].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=l;m<f;m++){let k=g.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),g=k.content}this.unplaced=p?e==0?A.empty:new A(Mn(o.content,e-1,1),e-1,f<0?o.openEnd:e-1):new A(Mn(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!ci(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],s=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=ci(e,t,i,r,s);if(o){for(let l=t-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],u=ci(e,l,c,a,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:s?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Cn(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Cn(this.placed,this.depth,S.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(S.empty,!0);t.childCount&&(this.placed=Cn(this.placed,this.frontier.length,t))}}function Mn(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Mn(n.firstChild.content,e-1,t)))}function Cn(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Cn(n.lastChild.content,e-1,t)))}function ai(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function Fl(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,Fl(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(S.empty,!0)))),n.copy(r)}function ci(n,e,t,r,i){let s=n.node(e),o=i?n.indexAfter(e):n.index(e);if(o==s.childCount&&!t.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!Yc(t,s.content,o)?l:null}function Yc(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function Xc(n){return n.spec.defining||n.spec.definingForContent}function Qc(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),s=n.doc.resolve(t);if(zl(i,s,r))return n.step(new he(e,t,r));let o=Hl(i,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let h=i.depth,f=i.pos-1;h>0;h--,f--){let p=i.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;o.indexOf(h)>-1?l=h:i.before(h)==f&&o.splice(1,0,-h)}let a=o.indexOf(l),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=Xc(f.type);if(p&&!f.sameMarkup(i.node(Math.abs(l)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let m=0;m<o.length;m++){let g=o[(m+a)%o.length],k=!0;g<0&&(k=!1,g=-g);let w=i.node(g-1),P=i.index(g-1);if(w.canReplaceWith(P,P,p.type,p.marks))return n.replace(i.before(g),k?s.after(g):t,new A($l(r.content,0,r.openStart,f),f,r.openEnd))}}let d=n.steps.length;for(let h=o.length-1;h>=0&&(n.replace(e,t,r),!(n.steps.length>d));h--){let f=o[h];f<0||(e=i.before(f),t=s.after(f))}}function $l(n,e,t,r,i){if(e<t){let s=n.firstChild;n=n.replaceChild(0,s.copy($l(s.content,e+1,t,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(n).append(n);n=o.append(s.matchFragment(o).fillBefore(S.empty,!0))}return n}function Zc(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=qc(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new A(S.from(r),0,0))}function eu(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),s=Hl(r,i);for(let o=0;o<s.length;o++){let l=s[o],a=o==s.length-1;if(a&&l==0||r.node(l).type.contentMatch.validEnd)return n.delete(r.start(l),i.end(l));if(l>0&&(a||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return n.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&i.end(o)-t!=i.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function Hl(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let s=n.start(i);if(s<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&t.push(i)}return t}class hn extends Re{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ie.fail("No node at attribute step's position");let r=Object.create(null);for(let s in t.attrs)r[s]=t.attrs[s];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return ie.fromReplace(e,this.pos,this.pos+1,new A(S.from(i),0,t.isLeaf?0:1))}getMap(){return Fe.empty}invert(e){return new hn(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new hn(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new hn(t.pos,t.attr,t.value)}}Re.jsonID("attr",hn);let gn=class extends Error{};gn=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};gn.prototype=Object.create(Error.prototype);gn.prototype.constructor=gn;gn.prototype.name="TransformError";class Vl{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new un}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new gn(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=A.empty){let i=as(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new A(S.from(r),0,0))}delete(e,t){return this.replace(e,t,A.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return Qc(this,e,t,r),this}replaceRangeWith(e,t,r){return Zc(this,e,t,r),this}deleteRange(e,t){return eu(this,e,t),this}lift(e,t){return $c(this,e,t),this}join(e,t=1){return Jc(this,e,t),this}wrap(e,t){return jc(this,e,t),this}setBlockType(e,t=e,r,i=null){return _c(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return Kc(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new hn(e,t,r)),this}addNodeMark(e,t){return this.step(new yt(e,t)),this}removeNodeMark(e,t){if(!(t instanceof G)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new mn(e,t)),this}split(e,t=1,r){return Uc(this,e,t,r),this}addMark(e,t,r){return Lc(this,e,t,r),this}removeMark(e,t,r){return Bc(this,e,t,r),this}clearIncompatible(e,t,r){return zc(this,e,t,r),this}}const ui=Object.create(null);class j{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new tu(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=A.empty){let r=t.content.lastChild,i=null;for(let l=0;l<t.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:a,$to:c}=o[l],u=e.mapping.slice(s);e.replaceRange(u.map(a.pos),u.map(c.pos),l?A.empty:t),l==0&&Zs(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],a=e.mapping.slice(r),c=a.map(o.pos),u=a.map(l.pos);s?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),Zs(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new H(e):tn(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=t<0?tn(e.node(0),e.node(s),e.before(s+1),e.index(s),t,r):tn(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new je(e.node(0))}static atStart(e){return tn(e,e,0,0,1)||new je(e)}static atEnd(e){return tn(e,e,e.content.size,e.childCount,-1)||new je(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=ui[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in ui)throw new RangeError("Duplicate use of selection JSON ID "+e);return ui[e]=t,t.prototype.jsonID=e,t}getBookmark(){return H.between(this.$anchor,this.$head).getBookmark()}}j.prototype.visible=!0;class tu{constructor(e,t){this.$from=e,this.$to=t}}let Xs=!1;function Qs(n){!Xs&&!n.parent.inlineContent&&(Xs=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class H extends j{constructor(e,t=e){Qs(e),Qs(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return j.near(r);let i=e.resolve(t.map(this.anchor));return new H(i.parent.inlineContent?i:r,r)}replace(e,t=A.empty){if(super.replace(e,t),t==A.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof H&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new $r(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new H(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let s=j.findFrom(t,r,!0)||j.findFrom(t,-r,!0);if(s)t=s.$head;else return j.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(j.findFrom(e,-r,!0)||j.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new H(e,t)}}j.jsonID("text",H);class $r{constructor(e,t){this.anchor=e,this.head=t}map(e){return new $r(e.map(this.anchor),e.map(this.head))}resolve(e){return H.between(e.resolve(this.anchor),e.resolve(this.head))}}class B extends j{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),s=e.resolve(i);return r?j.near(s):new B(s)}content(){return new A(S.from(this.node),0,0)}eq(e){return e instanceof B&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new cs(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new B(e.resolve(t.anchor))}static create(e,t){return new B(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}B.prototype.visible=!1;j.jsonID("node",B);class cs{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new $r(r,r):new cs(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&B.isSelectable(r)?new B(t):j.near(t)}}class je extends j{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=A.empty){if(t==A.empty){e.delete(0,e.doc.content.size);let r=j.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new je(e)}map(e){return new je(e)}eq(e){return e instanceof je}getBookmark(){return nu}}j.jsonID("all",je);const nu={map(){return this},resolve(n){return new je(n)}};function tn(n,e,t,r,i,s=!1){if(e.inlineContent)return H.create(n,t);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&B.isSelectable(l))return B.create(n,t-(i<0?l.nodeSize:0))}else{let a=tn(n,l,t+i,i<0?l.childCount:0,i,s);if(a)return a}t+=l.nodeSize*i}return null}function Zs(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof he||i instanceof ae))return;let s=n.mapping.maps[r],o;s.forEach((l,a,c,u)=>{o==null&&(o=u)}),n.setSelection(j.near(n.doc.resolve(o),t))}const eo=1,Gn=2,to=4;class ru extends Vl{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|eo)&~Gn,this.storedMarks=null,this}get selectionSet(){return(this.updated&eo)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Gn,this}ensureMarks(e){return G.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Gn)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Gn,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||G.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(t);s=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,s)),this.selection.empty||this.setSelection(j.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=to,this}get scrolledIntoView(){return(this.updated&to)>0}}function no(n,e){return!e||!n?n:n.bind(e)}class En{constructor(e,t,r){this.name=e,this.init=no(t.init,r),this.apply=no(t.apply,r)}}const iu=[new En("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new En("selection",{init(n,e){return n.selection||j.atStart(e.doc)},apply(n){return n.selection}}),new En("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new En("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class di{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=iu.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new En(r.key,r.spec.state,r))})}}class sn{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let a=i?i[o].n:0,c=i?i[o].state:this,u=a<t.length&&l.spec.appendTransaction.call(l,a?t.slice(a):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),s=!0}i&&(i[o]={state:r,n:t.length})}}if(!s)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new sn(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];t[s.name]=s.apply(e,this[s.name],this,t)}return t}get tr(){return new ru(this)}static create(e){let t=new di(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new sn(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new di(this.schema,e.plugins),r=t.fields,i=new sn(t);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(t[r]=s.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new di(e.schema,e.plugins),s=new sn(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=Vt.fromJSON(e.schema,t.doc);else if(o.name=="selection")s.selection=j.fromJSON(s.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(s.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let a=r[l],c=a.spec.state;if(a.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,l)){s[o.name]=c.fromJSON.call(a,e,t[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function jl(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=jl(i,e,{})),t[r]=i}return t}class me{constructor(e){this.spec=e,this.props={},e.props&&jl(e.props,this,this.props),this.key=e.key?e.key.key:_l("plugin")}getState(e){return e[this.key]}}const hi=Object.create(null);function _l(n){return n in hi?n+"$"+ ++hi[n]:(hi[n]=0,n+"$")}class Pe{constructor(e="key"){this.key=_l(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Ce=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Ln=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let ro=null;const ot=function(n,e,t){let r=ro||(ro=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},Ut=function(n,e,t,r){return t&&(io(n,e,t,r,-1)||io(n,e,t,r,1))},su=/^(img|br|input|textarea|hr)$/i;function io(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Ye(n))){let s=n.parentNode;if(!s||s.nodeType!=1||us(n)||su.test(n.nodeName)||n.contentEditable=="false")return!1;e=Ce(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?Ye(n):0}else return!1}}function Ye(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ou(n,e,t){for(let r=e==0,i=e==Ye(n);r||i;){if(n==t)return!0;let s=Ce(n);if(n=n.parentNode,!n)return!1;r=r&&s==0,i=i&&s==Ye(n)}}function us(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Hr=function(n){return n.focusNode&&Ut(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function It(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function lu(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function au(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const Ze=typeof navigator<"u"?navigator:null,so=typeof document<"u"?document:null,Ot=Ze&&Ze.userAgent||"",Bi=/Edge\/(\d+)/.exec(Ot),Wl=/MSIE \d/.exec(Ot),zi=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ot),Ie=!!(Wl||zi||Bi),St=Wl?document.documentMode:zi?+zi[1]:Bi?+Bi[1]:0,_e=!Ie&&/gecko\/(\d+)/i.test(Ot);_e&&+(/Firefox\/(\d+)/.exec(Ot)||[0,0])[1];const Fi=!Ie&&/Chrome\/(\d+)/.exec(Ot),xe=!!Fi,cu=Fi?+Fi[1]:0,Ee=!Ie&&!!Ze&&/Apple Computer/.test(Ze.vendor),yn=Ee&&(/Mobile\/\w+/.test(Ot)||!!Ze&&Ze.maxTouchPoints>2),ze=yn||(Ze?/Mac/.test(Ze.platform):!1),uu=Ze?/Win/.test(Ze.platform):!1,He=/Android \d/.test(Ot),Vr=!!so&&"webkitFontSmoothing"in so.documentElement.style,du=Vr?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function hu(n){return{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function it(n,e){return typeof n=="number"?n:n[e]}function fu(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function oo(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,s=n.dom.ownerDocument;for(let o=t||n.dom;o;o=Ln(o)){if(o.nodeType!=1)continue;let l=o,a=l==s.body,c=a?hu(s):fu(l),u=0,d=0;if(e.top<c.top+it(r,"top")?d=-(c.top-e.top+it(i,"top")):e.bottom>c.bottom-it(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+it(i,"top")-c.top:e.bottom-c.bottom+it(i,"bottom")),e.left<c.left+it(r,"left")?u=-(c.left-e.left+it(i,"left")):e.right>c.right-it(r,"right")&&(u=e.right-c.right+it(i,"right")),u||d)if(a)s.defaultView.scrollBy(u,d);else{let h=l.scrollLeft,f=l.scrollTop;d&&(l.scrollTop+=d),u&&(l.scrollLeft+=u);let p=l.scrollLeft-h,m=l.scrollTop-f;e={left:e.left-p,top:e.top-m,right:e.right-p,bottom:e.bottom-m}}if(a||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function pu(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=n.root.elementFromPoint(s,o);if(!l||l==n.dom||!n.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=t-20){r=l,i=a.top;break}}return{refDOM:r,refTop:i,stack:Kl(n.dom)}}function Kl(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Ln(r));return e}function mu({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Ul(t,r==0?0:r-e)}function Ul(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:s}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Xt=null;function gu(n){if(n.setActive)return n.setActive();if(Xt)return n.focus(Xt);let e=Kl(n);n.focus(Xt==null?{get preventScroll(){return Xt={preventScroll:!0},!0}}:void 0),Xt||(Xt=!1,Ul(e,0))}function Jl(n,e){let t,r=2e8,i,s=0,o=e.top,l=e.top,a,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=ot(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=o&&p.bottom>=l){o=Math.max(p.bottom,o),l=Math.min(p.top,l);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(s=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!a&&p.left<=e.left&&p.right>=e.left&&(a=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(s=d+1)}}return!t&&a&&(t=a,i=c,r=0),t&&t.nodeType==3?yu(t,i):!t||r&&t.nodeType==1?{node:n,offset:s}:Jl(t,i)}function yu(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let s=dt(r,1);if(s.top!=s.bottom&&ds(e,s))return{node:n,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:n,offset:0}}function ds(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function bu(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function ku(n,e,t){let{node:r,offset:i}=Jl(e,t),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,i,s)}function Su(n,e,t,r){let i=-1;for(let s=e,o=!1;s!=n.dom;){let l=n.docView.nearestDesc(s,!0);if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent&&!o||!l.contentDOM)){let a=l.dom.getBoundingClientRect();if(l.node.isBlock&&l.parent&&!o&&(o=!0,a.left>r.left||a.top>r.top?i=l.posBefore:(a.right<r.left||a.bottom<r.top)&&(i=l.posAfter)),!l.contentDOM&&i<0&&!l.node.isText)return(l.node.isBlock?r.top<(a.top+a.bottom)/2:r.left<(a.left+a.right)/2)?l.posBefore:l.posAfter}s=l.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function ql(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),s=i;;){let o=n.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let a=0;a<l.length;a++){let c=l[a];if(ds(e,c))return ql(o,e,c)}}if((s=(s+1)%r)==i)break}return n}function wu(n,e){let t=n.dom.ownerDocument,r,i=0,s=au(t,e.left,e.top);s&&({node:r,offset:i}=s);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),l;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!ds(e,c)||(o=ql(n.dom,e,c),!o))return null}if(Ee)for(let c=o;r&&c;c=Ln(c))c.draggable&&(r=void 0);if(o=bu(o,e),r){if(_e&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let c=r.childNodes[i],u;c.nodeName=="IMG"&&(u=c.getBoundingClientRect()).right<=e.left&&u.bottom>e.top&&i++}r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=Su(n,r,i,e))}l==null&&(l=ku(n,o,e));let a=n.docView.nearestDesc(o,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function lo(n){return n.top<n.bottom||n.left<n.right}function dt(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(lo(r))return r}return Array.prototype.find.call(t,lo)||n.getBoundingClientRect()}const xu=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Gl(n,e,t){let{node:r,offset:i,atom:s}=n.docView.domFromPos(e,t<0?-1:1),o=Vr||_e;if(r.nodeType==3)if(o&&(xu.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let a=dt(ot(r,i,i),t);if(_e&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=dt(ot(r,i-1,i-1),-1);if(c.top==a.top){let u=dt(ot(r,i,i+1),-1);if(u.top!=a.top)return xn(u,u.left<c.left)}}return a}else{let a=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(a--,u=1):t<0?a--:c++,xn(dt(ot(r,a,c),u),u<0)}if(!n.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(t<0||i==Ye(r))){let a=r.childNodes[i-1];if(a.nodeType==1)return fi(a.getBoundingClientRect(),!1)}if(s==null&&i<Ye(r)){let a=r.childNodes[i];if(a.nodeType==1)return fi(a.getBoundingClientRect(),!0)}return fi(r.getBoundingClientRect(),t>=0)}if(s==null&&i&&(t<0||i==Ye(r))){let a=r.childNodes[i-1],c=a.nodeType==3?ot(a,Ye(a)-(o?0:1)):a.nodeType==1&&(a.nodeName!="BR"||!a.nextSibling)?a:null;if(c)return xn(dt(c,1),!1)}if(s==null&&i<Ye(r)){let a=r.childNodes[i];for(;a.pmViewDesc&&a.pmViewDesc.ignoreForCoords;)a=a.nextSibling;let c=a?a.nodeType==3?ot(a,0,o?0:1):a.nodeType==1?a:null:null;if(c)return xn(dt(c,-1),!0)}return xn(dt(r.nodeType==3?ot(r):r,-t),t>=0)}function xn(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function fi(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function Yl(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function Mu(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return Yl(n,e,()=>{let{node:s}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let l=n.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=Gl(n,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=ot(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<a.length;c++){let u=a[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const Cu=/[\u0590-\u08ac]/;function Eu(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=n.domSelection();return!Cu.test(r.parent.textContent)||!l.modify?t=="left"||t=="backward"?s:o:Yl(n,e,()=>{let{focusNode:a,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),h=l.caretBidiLevel;l.modify("move",t,"character");let f=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),g=p&&!f.contains(p.nodeType==1?p:p.parentNode)||a==p&&c==m;try{l.collapse(u,d),a&&(a!=u||c!=d)&&l.extend&&l.extend(a,c)}catch{}return h!=null&&(l.caretBidiLevel=h),g})}let ao=null,co=null,uo=!1;function Ou(n,e,t){return ao==e&&co==t?uo:(ao=e,co=t,uo=t=="up"||t=="down"?Mu(n,e,t):Eu(n,e,t))}const $e=0,ho=1,Lt=2,et=3;class Kn{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=$e,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>Ce(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!t||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)i=i.children[0];return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof Ql){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof Xl&&s.side>=0;r--);if(t<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&t&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,t):{node:this.contentDOM,offset:s?Ce(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,t):{node:this.contentDOM,offset:s?Ce(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let a=this.children[l],c=o+a.size;if(i==-1&&e<=c){let u=o+a.border;if(e>=u&&t<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(e,t,u);e=o;for(let d=l;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=Ce(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(c>t||l==this.children.length-1)){t=c;for(let u=l+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){s=Ce(d.dom);break}t+=d.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let s=Math.min(e,t),o=Math.max(e,t);for(let h=0,f=0;h<this.children.length;h++){let p=this.children[h],m=f+p.size;if(s>f&&o<m)return p.setSelection(e-f-p.border,t-f-p.border,r,i);f=m}let l=this.domFromPos(e,e?-1:1),a=t==e?l:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((_e||Ee)&&e==t){let{node:h,offset:f}=l;if(h.nodeType==3){if(u=!!(f&&h.nodeValue[f-1]==`
`),u&&f==h.nodeValue.length)for(let p=h,m;p;p=p.parentNode){if(m=p.nextSibling){m.nodeName=="BR"&&(l=a={node:m.parentNode,offset:Ce(m)+1});break}let g=p.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let p=h.childNodes[f-1];u=p&&(p.nodeName=="BR"||p.contentEditable=="false")}}if(_e&&c.focusNode&&c.focusNode!=a.node&&c.focusNode.nodeType==1){let h=c.focusNode.childNodes[c.focusOffset];h&&h.contentEditable=="false"&&(i=!0)}if(!(i||u&&Ee)&&Ut(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Ut(a.node,a.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!u){c.collapse(l.node,l.offset);try{e!=t&&c.extend(a.node,a.offset),d=!0}catch{}}if(!d){if(e>t){let f=l;l=a,a=f}let h=document.createRange();h.setEnd(a.node,a.offset),h.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(h)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let l=r+s.border,a=o-s.border;if(e>=l&&t<=a){this.dirty=e==r||t==o?Lt:ho,e==l&&t==a&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=et:s.markDirty(e-l,t-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?Lt:et}r=o}this.dirty=Lt}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Lt:ho;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Xl extends Kn{constructor(e,t,r,i){let s,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!t.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,s=this}matchesWidget(e){return this.dirty==$e&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class Tu extends Kn{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Jt extends Kn{constructor(e,t,r,i){super(e,[],r,i),this.mark=t}static create(e,t,r,i){let s=i.nodeViews[t.type.name],o=s&&s(t,i,r);return(!o||!o.dom)&&(o=Xe.renderSpec(document,t.type.spec.toDOM(t,r))),new Jt(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&et||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=et&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=$e){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=$e}}slice(e,t,r){let i=Jt.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;t<o&&(s=Vi(s,t,o,r)),e>0&&(s=Vi(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}}class wt extends Kn{constructor(e,t,r,i,s,o,l,a,c){super(e,[],s,o),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,t,r,i,s,o){let l=s.nodeViews[t.type.name],a,c=l&&l(t,s,()=>{if(!a)return o;if(a.parent)return a.parent.posBeforeChild(a)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Xe.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let h=u;return u=ta(u,r,t),c?a=new Au(e,t,r,i,u,d||null,h,c,s,o+1):t.isText?new jr(e,t,r,i,u,h,s):new wt(e,t,r,i,u,d||null,h,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>S.empty)}return e}matchesNode(e,t,r){return this.dirty==$e&&e.eq(this.node)&&Hi(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,s=e.composing?this.localCompositionInfo(e,t):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,a=new vu(this,o&&o.node,e);Ru(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?a.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&a.syncToMarks(u==this.node.childCount?G.none:this.node.child(u).marks,r,e),a.placeWidget(c,e,i)},(c,u,d,h)=>{a.syncToMarks(c.marks,r,e);let f;a.findNodeMatch(c,u,d,h)||l&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(f=a.findIndexWithChild(s.node))>-1&&a.updateNodeAt(c,u,d,f,e)||a.updateNextNode(c,u,d,e,h,i)||a.addNode(c,u,d,e,i),i+=c.nodeSize}),a.syncToMarks([],r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==Lt)&&(o&&this.protectLocalComposition(e,o),Zl(this.contentDOM,this.children,e),yn&&Pu(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof H)||r<t||i>t+this.node.content.size)return null;let s=e.domSelectionRange(),o=Lu(s.focusNode,s.focusOffset);if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let l=o.nodeValue,a=Bu(this.node.content,l,r-t,i-t);return a<0?null:{node:o,pos:a,text:l}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let s=t;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new Tu(this,s,t,i);e.input.compositionNodes.push(o),this.children=Vi(this.children,r,r+i.length,e,o)}update(e,t,r,i){return this.dirty==et||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=$e}updateOuterDeco(e){if(Hi(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ea(this.dom,this.nodeDOM,$i(this.outerDeco,this.node,t),$i(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function fo(n,e,t,r,i){ta(r,e,n);let s=new wt(void 0,n,e,t,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class jr extends wt{constructor(e,t,r,i,s,o,l){super(e,t,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==et||this.dirty!=$e&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=$e||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=$e,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),s=document.createTextNode(i.text);return new jr(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=et)}get domAtom(){return!1}}class Ql extends Kn{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==$e&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class Au extends wt{constructor(e,t,r,i,s,o,l,a,c,u){super(e,t,r,i,s,o,l,c,u),this.spec=a}update(e,t,r,i){if(this.dirty==et)return!1;if(this.spec.update){let s=this.spec.update(e,t,r);return s&&this.updateInner(e,t,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Zl(n,e,t){let r=n.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==n){for(;l!=r;)r=po(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(l,r);if(o instanceof Jt){let a=r?r.previousSibling:n.lastChild;Zl(o.contentDOM,o.children,t),r=a?a.nextSibling:n.firstChild}}for(;r;)r=po(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const An=function(n){n&&(this.nodeName=n)};An.prototype=Object.create(null);const Bt=[new An];function $i(n,e,t){if(n.length==0)return Bt;let r=t?Bt[0]:new An,i=[r];for(let s=0;s<n.length;s++){let o=n[s].type.attrs;if(o){o.nodeName&&i.push(r=new An(o.nodeName));for(let l in o){let a=o[l];a!=null&&(t&&i.length==1&&i.push(r=new An(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+a:l=="style"?r.style=(r.style?r.style+";":"")+a:l!="nodeName"&&(r[l]=a))}}}return i}function ea(n,e,t,r){if(t==Bt&&r==Bt)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=t[s];if(s){let a;l&&l.nodeName==o.nodeName&&i!=n&&(a=i.parentNode)&&a.nodeName.toLowerCase()==o.nodeName||(a=document.createElement(o.nodeName),a.pmIsDeco=!0,a.appendChild(i),l=Bt[0]),i=a}Nu(i,l||Bt[0],o)}return i}function Nu(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&n.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&n.classList.add(i[s]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function ta(n,e,t){return ea(n,n,Bt,$i(e,t,n.nodeType!=1))}function Hi(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function po(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class vu{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=Iu(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=$e,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let c=this.top.children[a];if(c.matchesMark(e[s])&&!this.isLocked(c.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=Jt.create(this.top,e[s],t,r);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,s++}}findNodeMatch(e,t,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let c=this.top.children[l];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,r,i,s){let o=this.top.children[i];return o.dirty==et&&o.dom==o.contentDOM&&(o.dirty=Lt),o.update(e,t,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof wt){let c=this.preMatch.matched.get(a);if(c!=null&&c!=s)return!1;let u=a.dom,d,h=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&a.dirty!=et&&Hi(t,a.outerDeco));if(!h&&a.update(e,t,r,i))return this.destroyBetween(this.index,l),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(a,e,t,r,i,o)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Lt,d.updateChildren(i,o+1),d.dirty=$e),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,s,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let l=wt.create(this.top,t,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let a of l.children)a.parent=l}return e.destroy(),l}addNode(e,t,r,i,s){let o=wt.create(this.top,e,t,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new Xl(this.top,e,t,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Jt;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof jr)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ee||xe)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new Ql(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function Iu(n,e){let t=e,r=t.children.length,i=n.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let c=t.children[r-1];if(c instanceof Jt)t=c,r=c.children.length;else{l=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let a=l.node;if(a){if(a!=n.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function Du(n,e){return n.type.side-e.type.side}function Ru(n,e,t,r){let i=e.locals(n),s=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(s,u),c),s+=u.nodeSize}return}let o=0,l=[],a=null;for(let c=0;;){let u,d;for(;o<i.length&&i[o].to==s;){let g=i[o++];g.widget&&(u?(d||(d=[u])).push(g):u=g)}if(u)if(d){d.sort(Du);for(let g=0;g<d.length;g++)t(d[g],c,!!a)}else t(u,c,!!a);let h,f;if(a)f=-1,h=a,a=null;else if(c<n.childCount)f=c,h=n.child(c++);else break;for(let g=0;g<l.length;g++)l[g].to<=s&&l.splice(g--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let p=s+h.nodeSize;if(h.isText){let g=p;o<i.length&&i[o].from<g&&(g=i[o].from);for(let k=0;k<l.length;k++)l[k].to<g&&(g=l[k].to);g<p&&(a=h.cut(g-s),h=h.cut(0,g-s),p=g,f=-1)}let m=h.isInline&&!h.isLeaf?l.filter(g=>!g.inline):l.slice();r(h,m,e.forChild(s,h),f),s=p}}function Pu(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function Lu(n,e){for(;;){if(n.nodeType==3)return n;if(n.nodeType==1&&e>0){if(n.childNodes.length>e&&n.childNodes[e].nodeType==3)return n.childNodes[e];n=n.childNodes[e-1],e=Ye(n)}else if(n.nodeType==1&&e<n.childNodes.length)n=n.childNodes[e],e=0;else return null}}function Bu(n,e,t,r){for(let i=0,s=0;i<n.childCount&&s<=r;){let o=n.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let a=o.text;for(;i<n.childCount;){let c=n.child(i++);if(s+=c.nodeSize,!c.isText)break;a+=c.text}if(s>=t){let c=l<r?a.lastIndexOf(e,r-l-1):-1;if(c>=0&&c+e.length+l>=t)return l+c;if(t==r&&a.length>=r+e.length-l&&a.slice(r-l,r-l+e.length)==e)return r}}return-1}function Vi(n,e,t,r,i){let s=[];for(let o=0,l=0;o<n.length;o++){let a=n[o],c=l,u=l+=a.size;c>=t||u<=e?s.push(a):(c<e&&s.push(a.slice(0,e-c,r)),i&&(s.push(i),i=void 0),u>t&&s.push(a.slice(t-c,a.size,r)))}return s}function hs(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),s=i&&i.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let l=r.resolve(o),a,c;if(Hr(t)){for(a=l;i&&!i.node;)i=i.parent;let u=i.node;if(i&&u.isAtom&&B.isSelectable(u)&&i.parent&&!(u.isInline&&ou(t.focusNode,t.focusOffset,i.dom))){let d=i.posBefore;c=new B(o==d?l:r.resolve(d))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;a=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<l.pos&&!s?1:-1;c=fs(n,a,l,u)}return c}function na(n){return n.editable?n.hasFocus():ia(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function lt(n,e=!1){let t=n.state.selection;if(ra(n,t),!!na(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&xe){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&Ut(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)Fu(n);else{let{anchor:r,head:i}=t,s,o;mo&&!(t instanceof H)&&(t.$from.parent.inlineContent||(s=go(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=go(n,t.to))),n.docView.setSelection(r,i,n.root,e),mo&&(s&&yo(s),o&&yo(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&zu(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const mo=Ee||xe&&cu<63;function go(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,s=r?t.childNodes[r-1]:null;if(Ee&&i&&i.contentEditable=="false")return pi(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return pi(i);if(s)return pi(s)}}function pi(n){return n.contentEditable="true",Ee&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function yo(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function zu(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!na(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function Fu(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setEnd(r.parentNode,Ce(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Ie&&St<=11&&(r.disabled=!0,r.disabled=!1)}function ra(n,e){if(e instanceof B){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(bo(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else bo(n)}function bo(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function fs(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||H.between(e,t,r)}function ko(n){return n.editable&&!n.hasFocus()?!1:ia(n)}function ia(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function $u(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Ut(e.node,e.offset,t.anchorNode,t.anchorOffset)}function ji(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),s=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return s&&j.findFrom(s,e)}function Dt(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function So(n,e,t){let r=n.state.selection;if(r instanceof H){if(!r.empty||t.indexOf("s")>-1)return!1;if(n.endOfTextblock(e>0?"forward":"backward")){let i=ji(n.state,e);return i&&i instanceof B?Dt(n,i):!1}else if(!(ze&&t.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=n.docView.descAt(l))&&!o.contentDOM?B.isSelectable(s)?Dt(n,new B(e<0?n.state.doc.resolve(i.pos-s.nodeSize):i)):Vr?Dt(n,new H(n.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else{if(r instanceof B&&r.node.isInline)return Dt(n,new H(e>0?r.$to:r.$from));{let i=ji(n.state,e);return i?Dt(n,i):!1}}}function fr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Nn(n,e){if(n.contentEditable=="false")return!0;let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Qt(n,e){return e<0?Hu(n):Vu(n)}function Hu(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,s,o=!1;for(_e&&t.nodeType==1&&r<fr(t)&&Nn(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let l=t.childNodes[r-1];if(Nn(l,-1))i=t,s=--r;else if(l.nodeType==3)t=l,r=t.nodeValue.length;else break}}else{if(sa(t))break;{let l=t.previousSibling;for(;l&&Nn(l,-1);)i=t.parentNode,s=Ce(l),l=l.previousSibling;if(l)t=l,r=fr(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?_i(n,t,r):i&&_i(n,i,s)}function Vu(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=fr(t),s,o;for(;;)if(r<i){if(t.nodeType!=1)break;let l=t.childNodes[r];if(Nn(l,1))s=t,o=++r;else break}else{if(sa(t))break;{let l=t.nextSibling;for(;l&&Nn(l,1);)s=l.parentNode,o=Ce(l)+1,l=l.nextSibling;if(l)t=l,r=0,i=fr(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}s&&_i(n,s,o)}function sa(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function ju(n,e){for(;n&&e==n.childNodes.length&&!us(n);)e=Ce(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function _u(n,e){for(;n&&!e&&!us(n);)e=Ce(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function _i(n,e,t){if(e.nodeType!=3){let s,o;(o=ju(e,t))?(e=o,t=0):(s=_u(e,t))&&(e=s,t=s.nodeValue.length)}let r=n.domSelection();if(Hr(r)){let s=document.createRange();s.setEnd(e,t),s.setStart(e,t),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&lt(n)},50)}function wo(n,e){let t=n.state.doc.resolve(e);if(!(xe||uu)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let s=n.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<t.end()){let s=n.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function xo(n,e,t){let r=n.state.selection;if(r instanceof H&&!r.empty||t.indexOf("s")>-1||ze&&t.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=ji(n.state,e);if(o&&o instanceof B)return Dt(n,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof je?j.near(o,e):j.findFrom(o,e);return l?Dt(n,l):!1}return!1}function Mo(n,e){if(!(n.state.selection instanceof H))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(s&&!s.isText){let o=n.state.tr;return e<0?o.delete(t.pos-s.nodeSize,t.pos):o.delete(t.pos,t.pos+s.nodeSize),n.dispatch(o),!0}return!1}function Co(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function Wu(n){if(!Ee||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Co(n,r,"true"),setTimeout(()=>Co(n,r,"false"),20)}return!1}function Ku(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function Uu(n,e){let t=e.keyCode,r=Ku(e);if(t==8||ze&&t==72&&r=="c")return Mo(n,-1)||Qt(n,-1);if(t==46&&!e.shiftKey||ze&&t==68&&r=="c")return Mo(n,1)||Qt(n,1);if(t==13||t==27)return!0;if(t==37||ze&&t==66&&r=="c"){let i=t==37?wo(n,n.state.selection.from)=="ltr"?-1:1:-1;return So(n,i,r)||Qt(n,i)}else if(t==39||ze&&t==70&&r=="c"){let i=t==39?wo(n,n.state.selection.from)=="ltr"?1:-1:1;return So(n,i,r)||Qt(n,i)}else{if(t==38||ze&&t==80&&r=="c")return xo(n,-1,r)||Qt(n,-1);if(t==40||ze&&t==78&&r=="c")return Wu(n)||xo(n,1,r)||Qt(n,1);if(r==(ze?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function oa(n,e){n.someProp("transformCopied",f=>{e=f(e,n)});let t=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let f=r.firstChild;t.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let o=n.someProp("clipboardSerializer")||Xe.fromSchema(n.state.schema),l=ha(),a=l.createElement("div");a.appendChild(o.serializeFragment(r,{document:l}));let c=a.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=da[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=l.createElement(u[f]);for(;a.firstChild;)p.appendChild(a.firstChild);a.appendChild(p),d++}c=a.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${s}${d?` -${d}`:""} ${JSON.stringify(t)}`);let h=n.someProp("clipboardTextSerializer",f=>f(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:a,text:h}}function la(n,e,t,r,i){let s=i.parent.type.spec.code,o,l;if(!t&&!e)return null;let a=e&&(r||s||!t);if(a){if(n.someProp("transformPastedText",h=>{e=h(e,s||r,n)}),s)return e?new A(S.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):A.empty;let d=n.someProp("clipboardTextParser",h=>h(e,i,r,n));if(d)l=d;else{let h=i.marks(),{schema:f}=n.state,p=Xe.fromSchema(f);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=o.appendChild(document.createElement("p"));m&&g.appendChild(p.serializeNode(f.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=Gu(t),Vr&&Yu(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=o.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;o=h}if(l||(l=(n.someProp("clipboardParser")||n.someProp("domParser")||pn.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(a||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!Ju.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)l=Xu(Eo(l,+u[1],+u[2]),u[4]);else if(l=A.maxOpen(qu(l.content,i),!0),l.openStart||l.openEnd){let d=0,h=0;for(let f=l.content.firstChild;d<l.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=l.content.lastChild;h<l.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);l=Eo(l,d,h)}return n.someProp("transformPasted",d=>{l=d(l,n)}),l}const Ju=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function qu(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),s,o=[];if(n.forEach(l=>{if(!o)return;let a=i.findWrapping(l.type),c;if(!a)return o=null;if(c=o.length&&s.length&&ca(a,s,l,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=ua(o[o.length-1],s.length));let u=aa(l,a);o.push(u),i=i.matchType(u.type),s=a}}),o)return S.from(o)}return n}function aa(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,S.from(n));return n}function ca(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let s=ca(n,e,t,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(S.from(aa(t,n,i+1))))}}function ua(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,ua(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(S.empty,!0);return n.copy(t.append(r))}function Wi(n,e,t,r,i,s){let o=e<0?n.firstChild:n.lastChild,l=o.content;return n.childCount>1&&(s=0),i<r-1&&(l=Wi(l,e,t,r,i+1,s)),i>=t&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(S.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(l))}function Eo(n,e,t){return e<n.openStart&&(n=new A(Wi(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new A(Wi(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const da={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Oo=null;function ha(){return Oo||(Oo=document.implementation.createHTMLDocument("title"))}function Gu(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=ha().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&da[r[1].toLowerCase()])&&(n=i.map(s=>"<"+s+">").join("")+n+i.map(s=>"</"+s+">").reverse().join("")),t.innerHTML=n,i)for(let s=0;s<i.length;s++)t=t.querySelector(i[s])||t;return t}function Yu(n){let e=n.querySelectorAll(xe?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function Xu(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:s,openEnd:o}=n;for(let l=r.length-2;l>=0;l-=2){let a=t.nodes[r[l]];if(!a||a.hasRequiredAttrs())break;i=S.from(a.create(r[l+1],i)),s++,o++}return new A(i,s,o)}const Oe={},Te={},Qu={touchstart:!0,touchmove:!0};class Zu{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function ed(n){for(let e in Oe){let t=Oe[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{nd(n,r)&&!ps(n,r)&&(n.editable||!(r.type in Te))&&t(n,r)},Qu[e]?{passive:!0}:void 0)}Ee&&n.dom.addEventListener("input",()=>null),Ki(n)}function bt(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function td(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function Ki(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>ps(n,r))})}function ps(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function nd(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function rd(n,e){!ps(n,e)&&Oe[e.type]&&(n.editable||!(e.type in Te))&&Oe[e.type](n,e)}Te.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!pa(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(He&&xe&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),yn&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,It(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||Uu(n,t)?t.preventDefault():bt(n,"key")};Te.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Te.keypress=(n,e)=>{let t=e;if(pa(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||ze&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof H)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function _r(n){return{left:n.clientX,top:n.clientY}}function id(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function ms(n,e,t,r,i){if(r==-1)return!1;let s=n.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(n.someProp(e,l=>o>s.depth?l(n,t,s.nodeAfter,s.before(o),i,!0):l(n,t,s.node(o),s.before(o),i,!1)))return!0;return!1}function fn(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);t=="pointer"&&r.setMeta("pointer",!0),n.dispatch(r)}function sd(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&B.isSelectable(r)?(fn(n,new B(t),"pointer"),!0):!1}function od(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof B&&(r=t.node);let s=n.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(B.isSelectable(l)){r&&t.$from.depth>0&&o>=t.$from.depth&&s.before(t.$from.depth+1)==t.$from.pos?i=s.before(t.$from.depth):i=s.before(o);break}}return i!=null?(fn(n,B.create(n.state.doc,i),"pointer"),!0):!1}function ld(n,e,t,r,i){return ms(n,"handleClickOn",e,t,r)||n.someProp("handleClick",s=>s(n,e,r))||(i?od(n,t):sd(n,t))}function ad(n,e,t,r){return ms(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function cd(n,e,t,r){return ms(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||ud(n,t,r)}function ud(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(fn(n,H.create(r,0,r.content.size),"pointer"),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)fn(n,H.create(r,l+1,l+1+o.content.size),"pointer");else if(B.isSelectable(o))fn(n,B.create(r,l),"pointer");else continue;return!0}}function gs(n){return pr(n)}const fa=ze?"metaKey":"ctrlKey";Oe.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=gs(n),i=Date.now(),s="singleClick";i-n.input.lastClick.time<500&&id(t,n.input.lastClick)&&!t[fa]&&(n.input.lastClick.type=="singleClick"?s="doubleClick":n.input.lastClick.type=="doubleClick"&&(s="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:s};let o=n.posAtCoords(_r(t));o&&(s=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new dd(n,o,t,!!r)):(s=="doubleClick"?ad:cd)(n,o.pos,o.inside,t)?t.preventDefault():bt(n,"pointer"))};class dd{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[fa],this.allowDefault=r.shiftKey;let s,o;if(t.inside>-1)s=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);s=u.parent,o=u.depth?u.before():0}const l=i?null:r.target,a=l?e.docView.nearestDesc(l,!0):null;this.target=a?a.dom:null;let{selection:c}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||c instanceof B&&c.from<=o&&c.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&_e&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),bt(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>lt(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(_r(e))),this.updateAllowDefault(e),this.allowDefault||!t?bt(this.view,"pointer"):ld(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ee&&this.mightDrag&&!this.mightDrag.node.isAtom||xe&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(fn(this.view,j.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):bt(this.view,"pointer")}move(e){this.updateAllowDefault(e),bt(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Oe.touchstart=n=>{n.input.lastTouch=Date.now(),gs(n),bt(n,"pointer")};Oe.touchmove=n=>{n.input.lastTouch=Date.now(),bt(n,"pointer")};Oe.contextmenu=n=>gs(n);function pa(n,e){return n.composing?!0:Ee&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const hd=He?5e3:-1;Te.compositionstart=Te.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),pr(n,!0),n.markCursor=null;else if(pr(n),_e&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else i=o,s=-1}}n.input.composing=!0}ma(n,hd)};Te.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,ma(n,20))};function ma(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>pr(n),e))}function ga(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=fd());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function fd(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function pr(n,e=!1){if(!(He&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),ga(n),e||n.docView&&n.docView.dirty){let t=hs(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function pd(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const bn=Ie&&St<15||yn&&du<604;Oe.copy=Te.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let s=bn?null:t.clipboardData,o=r.content(),{dom:l,text:a}=oa(n,o);s?(t.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",a)):pd(n,l),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function md(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function gd(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Bn(n,r.value,null,i,e):Bn(n,r.textContent,r.innerHTML,i,e)},50)}function Bn(n,e,t,r,i){let s=la(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",a=>a(n,i,s||A.empty)))return!0;if(!s)return!1;let o=md(s),l=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(s);return n.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}Te.paste=(n,e)=>{let t=e;if(n.composing&&!He)return;let r=bn?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Bn(n,r.getData("text/plain"),r.getData("text/html"),i,t)?t.preventDefault():gd(n,t)};class yd{constructor(e,t){this.slice=e,this.move=t}}const ya=ze?"altKey":"ctrlKey";Oe.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,s=i.empty?null:n.posAtCoords(_r(t));if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof B?i.to-1:i.to))){if(r&&r.mightDrag)n.dispatch(n.state.tr.setSelection(B.create(n.state.doc,r.mightDrag.pos)));else if(t.target&&t.target.nodeType==1){let c=n.docView.nearestDesc(t.target,!0);c&&c.node.type.spec.draggable&&c!=n.docView&&n.dispatch(n.state.tr.setSelection(B.create(n.state.doc,c.posBefore)))}}let o=n.state.selection.content(),{dom:l,text:a}=oa(n,o);t.dataTransfer.clearData(),t.dataTransfer.setData(bn?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",bn||t.dataTransfer.setData("text/plain",a),n.dragging=new yd(o,!t[ya])};Oe.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Te.dragover=Te.dragenter=(n,e)=>e.preventDefault();Te.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(_r(t));if(!i)return;let s=n.state.doc.resolve(i.pos),o=r&&r.slice;o?n.someProp("transformPasted",p=>{o=p(o,n)}):o=la(n,t.dataTransfer.getData(bn?"Text":"text/plain"),bn?null:t.dataTransfer.getData("text/html"),!1,s);let l=!!(r&&!t[ya]);if(n.someProp("handleDrop",p=>p(n,t,o||A.empty,l))){t.preventDefault();return}if(!o)return;t.preventDefault();let a=o?Bl(n.state.doc,s.pos,o):s.pos;a==null&&(a=s.pos);let c=n.state.tr;l&&c.deleteSelection();let u=c.mapping.map(a),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(h))return;let f=c.doc.resolve(u);if(d&&B.isSelectable(o.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new B(f));else{let p=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,k,w)=>p=w),c.setSelection(fs(n,f,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Oe.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&lt(n)},20))};Oe.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Oe.beforeinput=(n,e)=>{if(xe&&He&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",s=>s(n,It(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Te)Oe[n]=Te[n];function zn(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class mr{constructor(e,t){this.toDOM=e,this.spec=t||jt,this.side=this.spec.side||0}map(e,t,r,i){let{pos:s,deleted:o}=e.mapResult(t.from+i,this.side<0?-1:1);return o?null:new ve(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof mr&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&zn(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class xt{constructor(e,t){this.attrs=e,this.spec=t||jt}map(e,t,r,i){let s=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new ve(s,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof xt&&zn(this.attrs,e.attrs)&&zn(this.spec,e.spec)}static is(e){return e.type instanceof xt}destroy(){}}class ys{constructor(e,t){this.attrs=e,this.spec=t||jt}map(e,t,r,i){let s=e.mapResult(t.from+i,1);if(s.deleted)return null;let o=e.mapResult(t.to+i,-1);return o.deleted||o.pos<=s.pos?null:new ve(s.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),s;return i==t.from&&!(s=e.child(r)).isText&&i+s.nodeSize==t.to}eq(e){return this==e||e instanceof ys&&zn(this.attrs,e.attrs)&&zn(this.spec,e.spec)}destroy(){}}class ve{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new ve(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new ve(e,e,new mr(t,r))}static inline(e,t,r,i){return new ve(e,t,new xt(r,i))}static node(e,t,r,i){return new ve(e,t,new ys(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof xt}get widget(){return this.type instanceof mr}}const nn=[],jt={};class re{constructor(e,t){this.local=e.length?e:nn,this.children=t.length?t:nn}static create(e,t){return t.length?gr(t,e,0,jt):Se}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=t&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,t-l,r,i+l,s)}}map(e,t,r){return this==Se||e.maps.length==0?this:this.mapInner(e,t,0,0,r||jt)}mapInner(e,t,r,i,s){let o;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(e,r,i);a&&a.type.valid(t,a)?(o||(o=[])).push(a):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?bd(this.children,o||[],e,t,r,i,s):o?new re(o.sort(_t),nn):Se}add(e,t){return t.length?this==Se?re.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,s=0;e.forEach((l,a)=>{let c=a+r,u;if(u=ka(t,l,c)){for(i||(i=this.children.slice());s<i.length&&i[s]<a;)s+=3;i[s]==a?i[s+2]=i[s+2].addInner(l,u,c+1):i.splice(s,0,a,a+l.nodeSize,gr(u,l,c+1,jt)),s+=3}});let o=ba(s?Sa(t):t,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new re(o.length?this.local.concat(o).sort(_t):this.local,i||this.children)}remove(e){return e.length==0||this==Se?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+t,a=r[s+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>l&&d.to<a&&(e[u]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[s+2].removeInner(o,l+1);c!=Se?r[s+2]=c:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,t)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new re(i,r):Se}forChild(e,t){if(this==Se)return this;if(t.isLeaf)return re.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+t.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<o&&a.to>s&&a.type instanceof xt){let c=Math.max(s,a.from)-s,u=Math.min(o,a.to)-s;c<u&&(i||(i=[])).push(a.copy(c,u))}}if(i){let l=new re(i.sort(_t),nn);return r?new pt([l,r]):l}return r||Se}eq(e){if(this==e)return!0;if(!(e instanceof re)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return bs(this.localsInner(e))}localsInner(e){if(this==Se)return nn;if(e.inlineContent||!this.local.some(xt.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof xt||t.push(this.local[r]);return t}}re.empty=new re([],[]);re.removeOverlap=bs;const Se=re.empty;class pt{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,jt));return pt.from(r)}forChild(e,t){if(t.isLeaf)return re.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,t);s!=Se&&(s instanceof pt?r=r.concat(s.members):r.push(s))}return pt.from(r)}eq(e){if(!(e instanceof pt)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!t)t=s;else{r&&(t=t.slice(),r=!1);for(let o=0;o<s.length;o++)t.push(s[o])}}return t?bs(r?t:t.sort(_t)):nn}static from(e){switch(e.length){case 0:return Se;case 1:return e[0];default:return new pt(e.every(t=>t instanceof re)?e:e.reduce((t,r)=>t.concat(r instanceof re?r:r.members),[]))}}}function bd(n,e,t,r,i,s,o){let l=n.slice();for(let c=0,u=s;c<t.maps.length;c++){let d=0;t.maps[c].forEach((h,f,p,m)=>{let g=m-p-(f-h);for(let k=0;k<l.length;k+=3){let w=l[k+1];if(w<0||h>w+u-d)continue;let P=l[k]+u-d;f>=P?l[k+1]=h<=P?-2:-1:p>=i&&g&&(l[k]+=g,l[k+1]+=g)}d+=g}),u=t.maps[c].map(u,-1)}let a=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){a=!0,l[c+1]=-1;continue}let u=t.map(n[c]+s),d=u-i;if(d<0||d>=r.content.size){a=!0;continue}let h=t.map(n[c+1]+s,-1),f=h-i,{index:p,offset:m}=r.content.findIndex(d),g=r.maybeChild(p);if(g&&m==d&&m+g.nodeSize==f){let k=l[c+2].mapInner(t,g,u+1,n[c]+s+1,o);k!=Se?(l[c]=d,l[c+1]=f,l[c+2]=k):(l[c+1]=-2,a=!0)}else a=!0}if(a){let c=kd(l,n,e,t,i,s,o),u=gr(c,r,0,o);e=u.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<l.length&&l[h]<f;)h+=3;l.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new re(e.sort(_t),l)}function ba(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new ve(i.from+e,i.to+e,i.type))}return t}function kd(n,e,t,r,i,s,o){function l(a,c){for(let u=0;u<a.local.length;u++){let d=a.local[u].map(r,i,c);d?t.push(d):o.onRemove&&o.onRemove(a.local[u].spec)}for(let u=0;u<a.children.length;u+=3)l(a.children[u+2],a.children[u]+c+1)}for(let a=0;a<n.length;a+=3)n[a+1]==-1&&l(n[a+2],e[a]+s+1);return t}function ka(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let s=0,o;s<n.length;s++)(o=n[s])&&o.from>t&&o.to<r&&((i||(i=[])).push(o),n[s]=null);return i}function Sa(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function gr(n,e,t,r){let i=[],s=!1;e.forEach((l,a)=>{let c=ka(n,l,a+t);if(c){s=!0;let u=gr(c,l,t+a+1,r);u!=Se&&i.push(a,a+l.nodeSize,u)}});let o=ba(s?Sa(n):n,-t).sort(_t);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new re(o,i):Se}function _t(n,e){return n.from-e.from||n.to-e.to}function bs(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==n&&(e=n.slice()),e[i]=s.copy(s.from,r.to),To(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,s.from),To(e,i,r.copy(s.from,r.to)));break}}}return e}function To(n,e,t){for(;e<n.length&&_t(t,n[e])>0;)e++;n.splice(e,0,t)}function mi(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Se&&e.push(r)}),n.cursorWrapper&&e.push(re.create(n.state.doc,[n.cursorWrapper.deco])),pt.from(e)}const Sd={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},wd=Ie&&St<=11;class xd{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Md{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new xd,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Ie&&St<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),wd&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Sd)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(ko(this.view)){if(this.suppressingSelectionUpdates)return lt(this.view);if(Ie&&St<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Ut(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let s=e.focusNode;s;s=Ln(s))t.add(s);for(let s=e.anchorNode;s;s=Ln(s))if(t.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&ko(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,a=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],a);d&&(s=s<0?d.from:Math.min(d.from,s),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(l=!0))}if(_e&&a.length>1){let u=a.filter(d=>d.nodeName=="BR");if(u.length==2){let d=u[0],h=u[1];d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}}let c=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Hr(r)&&(c=hs(e))&&c.eq(j.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,lt(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),Cd(e)),this.handleDOMChange(s,o,l,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||lt(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++)t.push(e.addedNodes[u]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(Ie&&St<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(s=h)}let o=i&&i.parentNode==e.target?Ce(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),a=s&&s.parentNode==e.target?Ce(s):e.target.childNodes.length,c=r.localPosFromDOM(e.target,a,1);return{from:l,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let Ao=new WeakMap,No=!1;function Cd(n){if(!Ao.has(n)&&(Ao.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=_e,No)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),No=!0}}function Ed(n){let e;function t(a){a.preventDefault(),a.stopImmediatePropagation(),e=a.getTargetRanges()[0]}n.dom.addEventListener("beforeinput",t,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",t,!0);let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,l=n.domAtPos(n.state.selection.anchor);return Ut(l.node,l.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}function Od(n,e,t){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=n.docView.parseRange(e,t),a=n.domSelectionRange(),c,u=a.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:a.anchorOffset}],Hr(a)||c.push({node:a.focusNode,offset:a.focusOffset})),xe&&n.input.lastKeyCode===8)for(let g=s;g>i;g--){let k=r.childNodes[g-1],w=k.pmViewDesc;if(k.nodeName=="BR"&&!w){s=g;break}if(!w||w.size)break}let d=n.state.doc,h=n.someProp("domParser")||pn.fromSchema(n.state.schema),f=d.resolve(o),p=null,m=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:s,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:Td,context:f});if(c&&c[0].pos!=null){let g=c[0].pos,k=c[1]&&c[1].pos;k==null&&(k=g),p={anchor:g+o,head:k+o}}return{doc:m,sel:p,from:o,to:l}}function Td(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ee&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Ee&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const Ad=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Nd(n,e,t,r,i){let s=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let v=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,$=hs(n,v);if($&&!n.state.selection.eq($)){if(xe&&He&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",Le=>Le(n,It(13,"Enter"))))return;let ge=n.state.tr.setSelection($);v=="pointer"?ge.setMeta("pointer",!0):v=="key"&&ge.scrollIntoView(),s&&ge.setMeta("composition",s),n.dispatch(ge)}return}let o=n.state.doc.resolve(e),l=o.sharedDepth(t);e=o.before(l+1),t=n.state.doc.resolve(t).after(l+1);let a=n.state.selection,c=Od(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),h,f;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,f="end"):(h=n.state.selection.from,f="start"),n.input.lastKeyCode=null;let p=Dd(d.content,c.doc.content,c.from,h,f);if((yn&&n.input.lastIOSEnter>Date.now()-225||He)&&i.some(v=>v.nodeType==1&&!Ad.test(v.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",v=>v(n,It(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&a instanceof H&&!a.empty&&a.$head.sameParent(a.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:a.from,endA:a.to,endB:a.to};else{if(c.sel){let v=vo(n,n.state.doc,c.sel);if(v&&!v.eq(n.state.selection)){let $=n.state.tr.setSelection(v);s&&$.setMeta("composition",s),n.dispatch($)}}return}if(xe&&n.cursorWrapper&&c.sel&&c.sel.anchor==n.cursorWrapper.deco.from&&c.sel.head==c.sel.anchor){let v=p.endB-p.start;c.sel={anchor:c.sel.anchor+v,head:c.sel.anchor+v}}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof H&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Ie&&St<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)==" "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),g=c.doc.resolveNoCache(p.endB-c.from),k=u.resolve(p.start),w=m.sameParent(g)&&m.parent.inlineContent&&k.end()>=p.endA,P;if((yn&&n.input.lastIOSEnter>Date.now()-225&&(!w||i.some(v=>v.nodeName=="DIV"||v.nodeName=="P"))||!w&&m.pos<c.doc.content.size&&!m.sameParent(g)&&(P=j.findFrom(c.doc.resolve(m.pos+1),1,!0))&&P.head==g.pos)&&n.someProp("handleKeyDown",v=>v(n,It(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&Id(u,p.start,p.endA,m,g)&&n.someProp("handleKeyDown",v=>v(n,It(8,"Backspace")))){He&&xe&&n.domObserver.suppressSelectionUpdates();return}xe&&He&&p.endB==p.start&&(n.input.lastAndroidDelete=Date.now()),He&&!w&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,g=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(v){return v(n,It(13,"Enter"))})},20));let U=p.start,W=p.endA,N,Y,se;if(w){if(m.pos==g.pos)Ie&&St<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>lt(n),20)),N=n.state.tr.delete(U,W),Y=u.resolve(p.start).marksAcross(u.resolve(p.endA));else if(p.endA==p.endB&&(se=vd(m.parent.content.cut(m.parentOffset,g.parentOffset),k.parent.content.cut(k.parentOffset,p.endA-k.start()))))N=n.state.tr,se.type=="add"?N.addMark(U,W,se.mark):N.removeMark(U,W,se.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let v=m.parent.textBetween(m.parentOffset,g.parentOffset);if(n.someProp("handleTextInput",$=>$(n,U,W,v)))return;N=n.state.tr.insertText(v,U,W)}}if(N||(N=n.state.tr.replace(U,W,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let v=vo(n,N.doc,c.sel);v&&!(xe&&He&&n.composing&&v.empty&&(p.start!=p.endB||n.input.lastAndroidDelete<Date.now()-100)&&(v.head==U||v.head==N.mapping.map(W)-1)||Ie&&v.empty&&v.head==U)&&N.setSelection(v)}Y&&N.ensureMarks(Y),s&&N.setMeta("composition",s),n.dispatch(N.scrollIntoView())}function vo(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:fs(n,e.resolve(t.anchor),e.resolve(t.head))}function vd(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,s=r,o,l,a;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)s=t[u].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",a=u=>u.mark(l.addToSet(u.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",a=u=>u.mark(l.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(a(e.child(u)));if(S.from(c).eq(n))return{mark:l,type:o}}function Id(n,e,t,r,i){if(!r.parent.isTextblock||t-e<=i.pos-r.pos||gi(r,!0,!1)<i.pos)return!1;let s=n.resolve(e);if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=n.resolve(gi(s,!0,!0));return!o.parent.isTextblock||o.pos>t||gi(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function gi(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let s=n.node(r).maybeChild(n.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function Dd(n,e,t,r,i){let s=n.findDiffStart(e,t);if(s==null)return null;let{a:o,b:l}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let a=Math.max(0,s-Math.min(o,l));r-=o+a-s}if(o<s&&n.size<e.size){let a=r<=s&&r>=o?s-r:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=r<=s&&r>=l?s-r:0;s-=a,o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}class Rd{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Zu,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Lo),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Ro(this),Do(this),this.nodeViews=Po(this),this.docView=fo(this.state.doc,Io(this),mi(this),this.dom,this),this.domObserver=new Md(this,(r,i,s,o)=>Nd(this,r,i,s,o)),this.domObserver.start(),ed(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ki(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Lo),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){let r=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(ga(this),s=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let h=Po(this);Ld(h,this.nodeViews)&&(this.nodeViews=h,i=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&Ki(this),this.editable=Ro(this),Do(this);let l=mi(this),a=Io(this),c=r.plugins!=e.plugins&&!r.doc.eq(e.doc)?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=i||!this.docView.matchesNode(e.doc,a,l);(u||!e.selection.eq(r.selection))&&(s=!0);let d=c=="preserve"&&s&&this.dom.style.overflowAnchor==null&&pu(this);if(s){this.domObserver.stop();let h=u&&(Ie||xe)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&Pd(r.selection,e.selection);if(u){let f=xe?this.trackWrites=this.domSelectionRange().focusNode:null;(i||!this.docView.update(e.doc,a,l,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=fo(e.doc,a,l,this.dom,this)),f&&!this.trackWrites&&(h=!0)}h||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&$u(this))?lt(this,h):(ra(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),c=="reset"?this.dom.scrollTop=0:c=="to selection"?this.scrollToSelection():d&&mu(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof B){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&oo(this,t.getBoundingClientRect(),e)}else oo(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=t?t(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=t?t(l):l))return i}}hasFocus(){if(Ie){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&gu(this.dom),lt(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}posAtCoords(e){return wu(this,e)}coordsAtPos(e,t=1){return Gl(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return Ou(this,t||this.state,e)}pasteHTML(e,t){return Bn(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Bn(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(td(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],mi(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return this.docView==null}dispatchEvent(e){return rd(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){return Ee&&this.root.nodeType===11&&lu(this.dom.ownerDocument)==this.dom?Ed(this):this.domSelection()}domSelection(){return this.root.getSelection()}}function Io(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[ve.node(0,n.state.doc.content.size,e)]}function Do(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:ve.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Ro(n){return!n.someProp("editable",e=>e(n.state)===!1)}function Pd(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Po(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function Ld(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function Lo(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ct={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},yr={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Bd=typeof navigator<"u"&&/Mac/.test(navigator.platform),zd=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var fe=0;fe<10;fe++)Ct[48+fe]=Ct[96+fe]=String(fe);for(var fe=1;fe<=24;fe++)Ct[fe+111]="F"+fe;for(var fe=65;fe<=90;fe++)Ct[fe]=String.fromCharCode(fe+32),yr[fe]=String.fromCharCode(fe);for(var yi in Ct)yr.hasOwnProperty(yi)||(yr[yi]=Ct[yi]);function Fd(n){var e=Bd&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||zd&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?yr:Ct)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const $d=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function Hd(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))$d?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+a)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),o&&(t="Meta-"+t),s&&(t="Shift-"+t),t}function Vd(n){let e=Object.create(null);for(let t in n)e[Hd(t)]=n[t];return e}function bi(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function jd(n){return new me({props:{handleKeyDown:wa(n)}})}function wa(n){let e=Vd(n);return function(t,r){let i=Fd(r),s,o=e[bi(i,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[bi(i,r,!1)];if(l&&l(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(s=Ct[r.keyCode])&&s!=i){let l=e[bi(s,r)];if(l&&l(t.state,t.dispatch,t))return!0}}return!1}}const _d=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Wd(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const Kd=(n,e,t)=>{let r=Wd(n,t);if(!r)return!1;let i=xa(r);if(!i){let o=r.blockRange(),l=o&&wn(o);return l==null?!1:(e&&e(n.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(!s.type.spec.isolating&&Ea(n,i,e))return!0;if(r.parent.content.size==0&&(kn(s,"end")||B.isSelectable(s))){let o=as(n.doc,r.before(),r.after(),A.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(kn(s,"end")?j.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):B.create(l.doc,i.pos-s.nodeSize)),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1};function kn(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const Ud=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;s=xa(r)}let o=s&&s.nodeBefore;return!o||!B.isSelectable(o)?!1:(e&&e(n.tr.setSelection(B.create(n.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function xa(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Jd(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const qd=(n,e,t)=>{let r=Jd(n,t);if(!r)return!1;let i=Ma(r);if(!i)return!1;let s=i.nodeAfter;if(Ea(n,i,e))return!0;if(r.parent.content.size==0&&(kn(s,"start")||B.isSelectable(s))){let o=as(n.doc,r.before(),r.after(),A.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=n.tr.step(o);l.setSelection(kn(s,"start")?j.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):B.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},Gd=(n,e,t)=>{let{$head:r,empty:i}=n.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;s=Ma(r)}let o=s&&s.nodeAfter;return!o||!B.isSelectable(o)?!1:(e&&e(n.tr.setSelection(B.create(n.doc,s.pos)).scrollIntoView()),!0)};function Ma(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const Yd=(n,e)=>{let t=n.selection,r=t instanceof B,i;if(r){if(t.node.isTextblock||!Et(n.doc,t.from))return!1;i=t.from}else if(i=Fr(n.doc,t.from,-1),i==null)return!1;if(e){let s=n.tr.join(i);r&&s.setSelection(B.create(s.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},Xd=(n,e)=>{let t=n.selection,r;if(t instanceof B){if(t.node.isTextblock||!Et(n.doc,t.to))return!1;r=t.to}else if(r=Fr(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},Qd=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),s=i&&wn(i);return s==null?!1:(e&&e(n.tr.lift(i,s).scrollIntoView()),!0)},Zd=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Ca(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const eh=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),s=t.indexAfter(-1),o=Ca(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=t.after(),a=n.tr.replaceWith(l,l,o.createAndFill());a.setSelection(j.near(a.doc.resolve(l),1)),e(a.scrollIntoView())}return!0},th=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof je||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=Ca(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=n.tr.insert(o,s.createAndFill());l.setSelection(H.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},nh=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let s=t.before();if(dn(n.doc,s))return e&&e(n.tr.split(s).scrollIntoView()),!0}let r=t.blockRange(),i=r&&wn(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},rh=(n,e)=>{let{$from:t,to:r}=n.selection,i,s=t.sharedDepth(r);return s==0?!1:(i=t.before(s),e&&e(n.tr.setSelection(B.create(n.doc,i))),!0)};function ih(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Et(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Ea(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,s,o;if(r.type.spec.isolating||i.type.spec.isolating)return!1;if(ih(n,e,t))return!0;let l=e.parent.canReplace(e.index(),e.index()+1);if(l&&(s=(o=r.contentMatchAt(r.childCount)).findWrapping(i.type))&&o.matchType(s[0]||i.type).validEnd){if(t){let d=e.pos+i.nodeSize,h=S.empty;for(let m=s.length-1;m>=0;m--)h=S.from(s[m].create(null,h));h=S.from(r.copy(h));let f=n.tr.step(new ae(e.pos-1,d,e.pos,d,new A(h,1,0),s.length,!0)),p=d+2*s.length;Et(f.doc,p)&&f.join(p),t(f.scrollIntoView())}return!0}let a=j.findFrom(e,1),c=a&&a.$from.blockRange(a.$to),u=c&&wn(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(l&&kn(i,"start",!0)&&kn(r,"end")){let d=r,h=[];for(;h.push(d),!d.isTextblock;)d=d.lastChild;let f=i,p=1;for(;!f.isTextblock;f=f.firstChild)p++;if(d.canReplace(d.childCount,d.childCount,f.content)){if(t){let m=S.empty;for(let k=h.length-1;k>=0;k--)m=S.from(h[k].copy(m));let g=n.tr.step(new ae(e.pos-h.length,e.pos+i.nodeSize,e.pos+p,e.pos+i.nodeSize-p,new A(m,h.length,0),0,!0));t(g.scrollIntoView())}return!0}}return!1}function Oa(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(t&&t(e.tr.setSelection(H.create(e.doc,n<0?i.start(s):i.end(s)))),!0):!1}}const sh=Oa(-1),oh=Oa(1);function lh(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),l=o&&ls(o,n,e);return l?(r&&r(t.tr.wrap(o,l).scrollIntoView()),!0):!1}}function Bo(n,e=null){return function(t,r){let i=!1;for(let s=0;s<t.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=t.selection.ranges[s];t.doc.nodesBetween(o,l,(a,c)=>{if(i)return!1;if(!(!a.isTextblock||a.hasMarkup(n,e)))if(a.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let s=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:a}}=t.selection.ranges[o];s.setBlockType(l,a,n,e)}r(s.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function ah(n,e=null){return function(t,r){let{$from:i,$to:s}=t.selection,o=i.blockRange(s),l=!1,a=o;if(!o)return!1;if(o.depth>=2&&i.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(i.index(o.depth-1)==0)return!1;let u=t.doc.resolve(o.start-2);a=new cr(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new cr(i,t.doc.resolve(s.end(o.depth)),o.depth)),l=!0}let c=ls(a,n,e,o);return c?(r&&r(ch(t.tr,o,c,l,n).scrollIntoView()),!0):!1}}function ch(n,e,t,r,i){let s=S.empty;for(let u=t.length-1;u>=0;u--)s=S.from(t[u].type.create(t[u].attrs,s));n.step(new ae(e.start-(r?2:0),e.end,e.start,e.end,new A(s,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==i&&(o=u+1);let l=t.length-o,a=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&dn(n.doc,a,l)&&(n.split(a,l),a+=2*l),a+=c.child(u).nodeSize;return n}function uh(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==n);return s?t?r.node(s.depth-1).type==n?dh(e,t,n,s):hh(e,t,s):!0:!1}}function dh(n,e,t,r){let i=n.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new ae(s-1,o,s,o,new A(S.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new cr(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=wn(r);if(l==null)return!1;i.lift(r,l);let a=i.mapping.map(s,-1)-1;return Et(i.doc,a)&&i.join(a),e(i.scrollIntoView()),!0}function hh(n,e,t){let r=n.tr,i=t.parent;for(let f=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)f-=i.child(p).nodeSize,r.delete(f-1,f+1);let s=r.doc.resolve(t.start),o=s.nodeAfter;if(r.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let l=t.startIndex==0,a=t.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(l?0:1),u+1,o.content.append(a?S.empty:S.from(i))))return!1;let d=s.pos,h=d+o.nodeSize;return r.step(new ae(d-(l?1:0),h+(a?1:0),d+1,h-1,new A((l?S.empty:S.from(i.copy(S.empty))).append(a?S.empty:S.from(i.copy(S.empty))),l?0:1,a?0:1),l?0:1)),e(r.scrollIntoView()),!0}function fh(n){return function(e,t){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,a=l.child(o-1);if(a.type!=n)return!1;if(t){let c=a.lastChild&&a.lastChild.type==l.type,u=S.from(c?n.create():null),d=new A(S.from(n.create(null,S.from(l.type.create(null,u)))),c?3:1,0),h=s.start,f=s.end;t(e.tr.step(new ae(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function Wr(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:s}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),filterTransaction:e.filterTransaction,plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,s=t.storedMarks,t}}}class Kr{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([l,a])=>[l,(...u)=>{const d=a(...u)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l=[],a=!!e,c=e||s.tr,u=()=>(!a&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),l.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,f])=>[h,(...m)=>{const g=this.buildProps(c,t),k=f(...m)(g);return l.push(k),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l={tr:e,editor:i,view:o,state:Wr({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([a,c])=>[a,(...u)=>c(...u)(l)]))}};return l}}class ph{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function I(n,e,t){return n.config[e]===void 0&&n.parent?I(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?I(n.parent,e,t):null}):n.config[e]}function Ur(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Ta(n){const e=[],{nodeExtensions:t,markExtensions:r}=Ur(n),i=[...t,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},a=I(o,"addGlobalAttributes",l);if(!a)return;a().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...s,...f}})})})})}),i.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},a=I(o,"addAttributes",l);if(!a)return;const c=a();Object.entries(c).forEach(([u,d])=>{const h={...s,...d};typeof h?.default=="function"&&(h.default=h.default()),h?.isRequired&&h?.default===void 0&&delete h.default,e.push({type:o.name,name:u,attribute:h})})}),e}function ue(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function ee(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?s.split(" "):[],a=r[i]?r[i].split(" "):[],c=l.filter(u=>!a.includes(u));r[i]=[...a,...c].join(" ")}else i==="style"?r[i]=[r[i],s].join("; "):r[i]=s}),r},{})}function Ui(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ee(t,r),{})}function Aa(n){return typeof n=="function"}function V(n,e=void 0,...t){return Aa(n)?e?n.bind(e)(...t):n(...t):n}function mh(n={}){return Object.keys(n).length===0&&n.constructor===Object}function gh(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function zo(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(t):gh(t.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function Fo(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&mh(t)?!1:t!=null))}function yh(n,e){var t;const r=Ta(n),{nodeExtensions:i,markExtensions:s}=Ur(n),o=(t=i.find(c=>I(c,"topNode")))===null||t===void 0?void 0:t.name,l=Object.fromEntries(i.map(c=>{const u=r.filter(k=>k.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((k,w)=>{const P=I(w,"extendNodeSchema",d);return{...k,...P?P(c):{}}},{}),f=Fo({...h,content:V(I(c,"content",d)),marks:V(I(c,"marks",d)),group:V(I(c,"group",d)),inline:V(I(c,"inline",d)),atom:V(I(c,"atom",d)),selectable:V(I(c,"selectable",d)),draggable:V(I(c,"draggable",d)),code:V(I(c,"code",d)),defining:V(I(c,"defining",d)),isolating:V(I(c,"isolating",d)),attrs:Object.fromEntries(u.map(k=>{var w;return[k.name,{default:(w=k?.attribute)===null||w===void 0?void 0:w.default}]}))}),p=V(I(c,"parseHTML",d));p&&(f.parseDOM=p.map(k=>zo(k,u)));const m=I(c,"renderHTML",d);m&&(f.toDOM=k=>m({node:k,HTMLAttributes:Ui(k,u)}));const g=I(c,"renderText",d);return g&&(f.toText=g),[c.name,f]})),a=Object.fromEntries(s.map(c=>{const u=r.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((g,k)=>{const w=I(k,"extendMarkSchema",d);return{...g,...w?w(c):{}}},{}),f=Fo({...h,inclusive:V(I(c,"inclusive",d)),excludes:V(I(c,"excludes",d)),group:V(I(c,"group",d)),spanning:V(I(c,"spanning",d)),code:V(I(c,"code",d)),attrs:Object.fromEntries(u.map(g=>{var k;return[g.name,{default:(k=g?.attribute)===null||k===void 0?void 0:k.default}]}))}),p=V(I(c,"parseHTML",d));p&&(f.parseDOM=p.map(g=>zo(g,u)));const m=I(c,"renderHTML",d);return m&&(f.toDOM=g=>m({mark:g,HTMLAttributes:Ui(g,u)})),[c.name,f]}));return new Oc({topNode:o,nodes:l,marks:a})}function ki(n,e){return e.nodes[n]||e.marks[n]||null}function $o(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const bh=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,l)=>{var a,c;const u=((c=(a=i.type.spec).toText)===null||c===void 0?void 0:c.call(a,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";t+=u.slice(0,Math.max(0,r-s))}),t};function ks(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Jr{constructor(e){this.find=e.find,this.handler=e.handler}}const kh=(n,e)=>{if(ks(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Si(n){var e;const{editor:t,from:r,to:i,text:s,rules:o,plugin:l}=n,{view:a}=t;if(a.composing)return!1;const c=a.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=bh(c)+s;return o.forEach(h=>{if(u)return;const f=kh(d,h.find);if(!f)return;const p=a.state.tr,m=Wr({state:a.state,transaction:p}),g={from:r-(f[0].length-s.length),to:i},{commands:k,chain:w,can:P}=new Kr({editor:t,state:m});h.handler({state:m,range:g,match:f,commands:k,chain:w,can:P})===null||!p.steps.length||(p.setMeta(l,{transform:p,from:r,to:i,text:s}),a.dispatch(p),u=!0)}),u}function Sh(n){const{editor:e,rules:t}=n,r=new me({state:{init(){return null},apply(i,s){const o=i.getMeta(r);return o||(i.selectionSet||i.docChanged?null:s)}},props:{handleTextInput(i,s,o,l){return Si({editor:e,from:s,to:o,text:l,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&Si({editor:e,from:s.pos,to:s.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?Si({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function wh(n){return typeof n=="number"}class xh{constructor(e){this.find=e.find,this.handler=e.handler}}const Mh=(n,e)=>{if(ks(e))return[...n.matchAll(e)];const t=e(n);return t?t.map(r=>{const i=[r.text];return i.index=r.index,i.input=n,i.data=r.data,r.replaceWith&&(r.text.includes(r.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(r.replaceWith)),i}):[]};function Ch(n){const{editor:e,state:t,from:r,to:i,rule:s}=n,{commands:o,chain:l,can:a}=new Kr({editor:e,state:t}),c=[];return t.doc.nodesBetween(r,i,(d,h)=>{if(!d.isTextblock||d.type.spec.code)return;const f=Math.max(r,h),p=Math.min(i,h+d.content.size),m=d.textBetween(f-h,p-h,void 0,"");Mh(m,s.find).forEach(k=>{if(k.index===void 0)return;const w=f+k.index+1,P=w+k[0].length,U={from:t.tr.mapping.map(w),to:t.tr.mapping.map(P)},W=s.handler({state:t,range:U,match:k,commands:o,chain:l,can:a});c.push(W)})}),c.every(d=>d!==null)}function Eh(n){const{editor:e,rules:t}=n;let r=null,i=!1,s=!1;return t.map(l=>new me({view(a){const c=u=>{var d;r=!((d=a.dom.parentElement)===null||d===void 0)&&d.contains(u.target)?a.dom.parentElement:null};return window.addEventListener("dragstart",c),{destroy(){window.removeEventListener("dragstart",c)}}},props:{handleDOMEvents:{drop:a=>(s=r===a.dom.parentElement,!1),paste:(a,c)=>{var u;const d=(u=c.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return i=!!d?.includes("data-pm-slice"),!1}}},appendTransaction:(a,c,u)=>{const d=a[0],h=d.getMeta("uiEvent")==="paste"&&!i,f=d.getMeta("uiEvent")==="drop"&&!s;if(!h&&!f)return;const p=c.doc.content.findDiffStart(u.doc.content),m=c.doc.content.findDiffEnd(u.doc.content);if(!wh(p)||!m||p===m.b)return;const g=u.tr,k=Wr({state:u,transaction:g});if(!(!Ch({editor:e,state:k,from:Math.max(p-1,0),to:m.b-1,rule:l})||!g.steps.length))return g}}))}function Oh(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class on{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=on.resolve(e),this.schema=yh(this.extensions,t),this.extensions.forEach(r=>{var i;this.editor.extensionStorage[r.name]=r.storage;const s={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:ki(r.name,this.schema)};r.type==="mark"&&(!((i=V(I(r,"keepOnSplit",s)))!==null&&i!==void 0)||i)&&this.splittableMarks.push(r.name);const o=I(r,"onBeforeCreate",s);o&&this.editor.on("beforeCreate",o);const l=I(r,"onCreate",s);l&&this.editor.on("create",l);const a=I(r,"onUpdate",s);a&&this.editor.on("update",a);const c=I(r,"onSelectionUpdate",s);c&&this.editor.on("selectionUpdate",c);const u=I(r,"onTransaction",s);u&&this.editor.on("transaction",u);const d=I(r,"onFocus",s);d&&this.editor.on("focus",d);const h=I(r,"onBlur",s);h&&this.editor.on("blur",h);const f=I(r,"onDestroy",s);f&&this.editor.on("destroy",f)})}static resolve(e){const t=on.sort(on.flatten(e)),r=Oh(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=I(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=I(r,"priority")||100,o=I(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:ki(t.name,this.schema)},i=I(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=on.sort([...this.extensions].reverse()),r=[],i=[],s=t.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:ki(o.name,this.schema)},a=[],c=I(o,"addKeyboardShortcuts",l);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>Ae.handleExit({editor:e,mark:o})),c){const m=Object.fromEntries(Object.entries(c()).map(([g,k])=>[g,()=>k({editor:e})]));u={...u,...m}}const d=jd(u);a.push(d);const h=I(o,"addInputRules",l);$o(o,e.options.enableInputRules)&&h&&r.push(...h());const f=I(o,"addPasteRules",l);$o(o,e.options.enablePasteRules)&&f&&i.push(...f());const p=I(o,"addProseMirrorPlugins",l);if(p){const m=p();a.push(...m)}return a}).flat();return[Sh({editor:e,rules:r}),...Eh({editor:e,rules:i}),...s]}get attributes(){return Ta(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Ur(this.extensions);return Object.fromEntries(t.filter(r=>!!I(r,"addNodeView")).map(r=>{const i=this.attributes.filter(a=>a.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:ue(r.name,this.schema)},o=I(r,"addNodeView",s);if(!o)return[];const l=(a,c,u,d)=>{const h=Ui(a,i);return o()({editor:e,node:a,getPos:u,decorations:d,HTMLAttributes:h,extension:r})};return[r.name,l]}))}}function Th(n){return Object.prototype.toString.call(n).slice(8,-1)}function wi(n){return Th(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function qr(n,e){const t={...n};return wi(n)&&wi(e)&&Object.keys(e).forEach(r=>{wi(e[r])?r in n?t[r]=qr(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class De{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(I(this,"addOptions",{name:this.name}))),this.storage=V(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new De(e)}configure(e={}){const t=this.extend();return t.options=qr(this.options,e),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new De(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=V(I(t,"addOptions",{name:t.name})),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}}function Na(n,e,t){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=t||{};let l="",a=!0;return n.nodesBetween(r,i,(c,u,d,h)=>{var f;const p=o?.[c.type.name];p?(c.isBlock&&!a&&(l+=s,a=!0),d&&(l+=p({node:c,pos:u,parent:d,index:h,range:e}))):c.isText?(l+=(f=c?.text)===null||f===void 0?void 0:f.slice(Math.max(r,u)-u,i-u),a=!1):c.isBlock&&!a&&(l+=s,a=!0)}),l}function va(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const Ah=De.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new me({key:new Pe("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(u=>u.$from.pos)),l=Math.max(...s.map(u=>u.$to.pos)),a=va(t);return Na(r,{from:o,to:l},{textSerializers:a})}}})]}}),Nh=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window?.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),vh=(n=!1)=>({commands:e})=>e.setContent("",n),Ih=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:s,$to:o})=>{n.doc.nodesBetween(s.pos,o.pos,(l,a)=>{if(l.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(a)),h=c.resolve(u.map(a+l.nodeSize)),f=d.blockRange(h);if(!f)return;const p=wn(f);if(l.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,m)}(p||p===0)&&e.lift(f,p)})}),!0},Dh=n=>e=>n(e),Rh=()=>({state:n,dispatch:e})=>th(n,e),Ph=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,s=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,s.content),r.setSelection(new H(r.doc.resolve(o-1))),!0},Lh=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const l=i.before(s),a=i.after(s);n.delete(l,a).scrollIntoView()}return!0}return!1},Bh=n=>({tr:e,state:t,dispatch:r})=>{const i=ue(n,t.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const a=s.before(o),c=s.after(o);e.delete(a,c).scrollIntoView()}return!0}return!1},zh=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},Fh=()=>({state:n,dispatch:e})=>_d(n,e),$h=()=>({commands:n})=>n.keyboardShortcut("Enter"),Hh=()=>({state:n,dispatch:e})=>eh(n,e);function br(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:ks(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Ji(n,e,t={}){return n.find(r=>r.type===e&&br(r.attrs,t))}function Vh(n,e,t={}){return!!Ji(n,e,t)}function Ss(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const i=Ji([...r.node.marks],e,t);if(!i)return;let s=r.index,o=n.start()+r.offset,l=s+1,a=o+r.node.nodeSize;for(Ji([...r.node.marks],e,t);s>0&&i.isInSet(n.parent.child(s-1).marks);)s-=1,o-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&Vh([...n.parent.child(l).marks],e,t);)a+=n.parent.child(l).nodeSize,l+=1;return{from:o,to:a}}function Tt(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const jh=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const s=Tt(n,r.schema),{doc:o,selection:l}=t,{$from:a,from:c,to:u}=l;if(i){const d=Ss(a,s,e);if(d&&d.from<=c&&d.to>=u){const h=H.create(o,d.from,d.to);t.setSelection(h)}}return!0},_h=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Ia(n){return n instanceof H}function zt(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Da(n,e=null){if(!e)return null;const t=j.atStart(n),r=j.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,s=r.to;return e==="all"?H.create(n,zt(0,i,s),zt(n.content.size,i,s)):H.create(n,zt(e,i,s),zt(e,i,s))}function ws(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const Wh=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{ws()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e?.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(s&&n===null&&!Ia(t.state.selection))return o(),!0;const l=Da(i.doc,n)||t.state.selection,a=t.state.selection.eq(l);return s&&(a||i.setSelection(l),a&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},Kh=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),Uh=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e);function Ho(n){const e=`<body>${n}</body>`;return new window.DOMParser().parseFromString(e,"text/html").body}function kr(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)&&n.length>0?S.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),kr("",e,t)}if(typeof n=="string"){const r=pn.fromSchema(e);return t.slice?r.parseSlice(Ho(n),t.parseOptions).content:r.parse(Ho(n),t.parseOptions)}return kr("",e,t)}function Jh(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof he||i instanceof ae))return;const s=n.mapping.maps[r];let o=0;s.forEach((l,a,c,u)=>{o===0&&(o=u)}),n.setSelection(j.near(n.doc.resolve(o),t))}const qh=n=>n.toString().startsWith("<"),Gh=(n,e,t)=>({tr:r,dispatch:i,editor:s})=>{if(i){t={parseOptions:{},updateSelection:!0,...t};const o=kr(e,s.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:l,to:a}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,u=!0;if((qh(o)?o:[o]).forEach(h=>{h.check(),c=c?h.isText&&h.marks.length===0:!1,u=u?h.isBlock:!1}),l===a&&u){const{parent:h}=r.doc.resolve(l);h.isTextblock&&!h.type.spec.code&&!h.childCount&&(l-=1,a+=1)}c?Array.isArray(e)?r.insertText(e.map(h=>h.text||"").join(""),l,a):typeof e=="object"&&e&&e.text?r.insertText(e.text,l,a):r.insertText(e,l,a):r.replaceWith(l,a,o),t.updateSelection&&Jh(r,r.steps.length-1,-1)}return!0},Yh=()=>({state:n,dispatch:e})=>Yd(n,e),Xh=()=>({state:n,dispatch:e})=>Xd(n,e),Qh=()=>({state:n,dispatch:e})=>Kd(n,e),Zh=()=>({state:n,dispatch:e})=>qd(n,e),ef=()=>({tr:n,state:e,dispatch:t})=>{try{const r=Fr(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},tf=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Fr(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}};function xs(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function nf(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,s,o;for(let l=0;l<e.length-1;l+=1){const a=e[l];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))r=!0;else if(/^(c|ctrl|control)$/i.test(a))i=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))ws()||xs()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${a}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),s&&(t=`Shift-${t}`),t}const rf=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const s=nf(n).split(/-(?!$)/),o=s.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),a=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,l))});return a?.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Fn(n,e,t={}){const{from:r,to:i,empty:s}=n.selection,o=e?ue(e,n.schema):null,l=[];n.doc.nodesBetween(r,i,(d,h)=>{if(d.isText)return;const f=Math.max(r,h),p=Math.min(i,h+d.nodeSize);l.push({node:d,from:f,to:p})});const a=i-r,c=l.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>br(d.node.attrs,t,{strict:!1}));return s?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=a}const sf=(n,e={})=>({state:t,dispatch:r})=>{const i=ue(n,t.schema);return Fn(t,i,e)?Qd(t,r):!1},of=()=>({state:n,dispatch:e})=>nh(n,e),lf=n=>({state:e,dispatch:t})=>{const r=ue(n,e.schema);return uh(r)(e,t)},af=()=>({state:n,dispatch:e})=>Zd(n,e);function Gr(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function Vo(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const cf=(n,e)=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const l=Gr(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(s=ue(n,r.schema)),l==="mark"&&(o=Tt(n,r.schema)),i&&t.selection.ranges.forEach(a=>{r.doc.nodesBetween(a.$from.pos,a.$to.pos,(c,u)=>{s&&s===c.type&&t.setNodeMarkup(u,void 0,Vo(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&t.addMark(u,u+c.nodeSize,o.create(Vo(d.attrs,e)))})})}),!0):!1},uf=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),df=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),hf=()=>({state:n,dispatch:e})=>Ud(n,e),ff=()=>({state:n,dispatch:e})=>Gd(n,e),pf=()=>({state:n,dispatch:e})=>rh(n,e),mf=()=>({state:n,dispatch:e})=>oh(n,e),gf=()=>({state:n,dispatch:e})=>sh(n,e);function Ra(n,e,t={}){return kr(n,e,{slice:!1,parseOptions:t})}const yf=(n,e=!1,t={})=>({tr:r,editor:i,dispatch:s})=>{const{doc:o}=r,l=Ra(n,i.schema,t);return s&&r.replaceWith(0,o.content.size,l).setMeta("preventUpdate",!e),!0};function Yr(n,e){const t=Tt(e,n.schema),{from:r,to:i,empty:s}=n.selection,o=[];s?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,a=>{o.push(...a.marks)});const l=o.find(a=>a.type.name===t.name);return l?{...l.attrs}:{}}function bf(n,e){const t=new Vl(n);return e.forEach(r=>{r.steps.forEach(i=>{t.step(i)})}),t}function kf(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function qi(n,e){const t=[];return n.descendants((r,i)=>{e(r)&&t.push({node:r,pos:i})}),t}function Sf(n,e,t){const r=[];return n.nodesBetween(e.from,e.to,(i,s)=>{t(i)&&r.push({node:i,pos:s})}),r}function wf(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Ms(n){return e=>wf(e.$from,n)}function xf(n,e){const t=Xe.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}function Mf(n,e){const t={from:0,to:n.content.size};return Na(n,t,e)}function Cf(n,e){const t=ue(e,n.schema),{from:r,to:i}=n.selection,s=[];n.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===t.name);return o?{...o.attrs}:{}}function Pa(n,e){const t=Gr(typeof e=="string"?e:e.name,n.schema);return t==="node"?Cf(n,e):t==="mark"?Yr(n,e):{}}function Ef(n,e=JSON.stringify){const t={};return n.filter(r=>{const i=e(r);return Object.prototype.hasOwnProperty.call(t,i)?!1:t[i]=!0})}function Of(n){const e=Ef(n);return e.length===1?e:e.filter((t,r)=>!e.filter((s,o)=>o!==r).some(s=>t.oldRange.from>=s.oldRange.from&&t.oldRange.to<=s.oldRange.to&&t.newRange.from>=s.newRange.from&&t.newRange.to<=s.newRange.to))}function Tf(n){const{mapping:e,steps:t}=n,r=[];return e.maps.forEach((i,s)=>{const o=[];if(i.ranges.length)i.forEach((l,a)=>{o.push({from:l,to:a})});else{const{from:l,to:a}=t[s];if(l===void 0||a===void 0)return;o.push({from:l,to:a})}o.forEach(({from:l,to:a})=>{const c=e.slice(s).map(l,-1),u=e.slice(s).map(a),d=e.invert().map(c,-1),h=e.invert().map(u);r.push({oldRange:{from:d,to:h},newRange:{from:c,to:u}})})}),Of(r)}function Cs(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const s=t.resolve(n-1),o=Ss(s,i.type);o&&r.push({mark:i,...o})}):t.nodesBetween(n,e,(i,s)=>{r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function nr(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function Gi(n,e,t={}){const{empty:r,ranges:i}=n.selection,s=e?Tt(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>s?s.name===d.type.name:!0).find(d=>br(d.attrs,t,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;n.doc.nodesBetween(f,p,(m,g)=>{if(!m.isText&&!m.marks.length)return;const k=Math.max(f,g),w=Math.min(p,g+m.nodeSize),P=w-k;o+=P,l.push(...m.marks.map(U=>({mark:U,from:k,to:w})))})}),o===0)return!1;const a=l.filter(d=>s?s.name===d.mark.type.name:!0).filter(d=>br(d.mark.attrs,t,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=l.filter(d=>s?d.mark.type!==s&&d.mark.type.excludes(s):!0).reduce((d,h)=>d+h.to-h.from,0);return(a>0?a+c:a)>=o}function Af(n,e,t={}){if(!e)return Fn(n,null,t)||Gi(n,null,t);const r=Gr(e,n.schema);return r==="node"?Fn(n,e,t):r==="mark"?Gi(n,e,t):!1}function jo(n,e){const{nodeExtensions:t}=Ur(e),r=t.find(o=>o.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=V(I(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function Nf(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function vf(n,e,t){var r;const{selection:i}=e;let s=null;if(Ia(i)&&(s=i.$cursor),s){const l=(r=n.storedMarks)!==null&&r!==void 0?r:s.marks();return!!t.isInSet(l)||!l.some(a=>a.type.excludes(t))}const{ranges:o}=i;return o.some(({$from:l,$to:a})=>{let c=l.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(l.pos,a.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const f=!h||h.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=f&&p}return!c}),c})}const If=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:s}=t,{empty:o,ranges:l}=s,a=Tt(n,r.schema);if(i)if(o){const c=Yr(r,a);t.addStoredMark(a.create({...c,...e}))}else l.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,f)=>{const p=Math.max(f,u),m=Math.min(f+h.nodeSize,d);h.marks.find(k=>k.type===a)?h.marks.forEach(k=>{a===k.type&&t.addMark(p,m,a.create({...k.attrs,...e}))}):t.addMark(p,m,a.create(e))})});return vf(r,t,a)},Df=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),Rf=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const s=ue(n,t.schema);return s.isTextblock?i().command(({commands:o})=>Bo(s,e)(t)?!0:o.clearNodes()).command(({state:o})=>Bo(s,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},Pf=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=zt(n,0,r.content.size),s=B.create(r,i);e.setSelection(s)}return!0},Lf=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:s}=typeof n=="number"?{from:n,to:n}:n,o=H.atStart(r).from,l=H.atEnd(r).to,a=zt(i,o,l),c=zt(s,o,l),u=H.create(r,a,c);e.setSelection(u)}return!0},Bf=n=>({state:e,dispatch:t})=>{const r=ue(n,e.schema);return fh(r)(e,t)};function _o(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e?.includes(i.type.name));n.tr.ensureMarks(r)}}const zf=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:l,$to:a}=s,c=i.extensionManager.attributes,u=nr(c,l.node().type.name,l.node().attrs);if(s instanceof B&&s.node.isBlock)return!l.parentOffset||!dn(o,l.pos)?!1:(r&&(n&&_o(t,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;if(r){const d=a.parentOffset===a.parent.content.size;s instanceof H&&e.deleteSelection();const h=l.depth===0?void 0:kf(l.node(-1).contentMatchAt(l.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=dn(e.doc,e.mapping.map(l.pos),1,f);if(!f&&!p&&dn(e.doc,e.mapping.map(l.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:u}]:void 0),p&&(e.split(e.mapping.map(l.pos),1,f),h&&!d&&!l.parentOffset&&l.parent.type!==h)){const m=e.mapping.map(l.before()),g=e.doc.resolve(m);l.node(-1).canReplaceWith(g.index(),g.index()+1,h)&&e.setNodeMarkup(e.mapping.map(l.before()),h)}n&&_o(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return!0},Ff=n=>({tr:e,state:t,dispatch:r,editor:i})=>{var s;const o=ue(n,t.schema),{$from:l,$to:a}=t.selection,c=t.selection.node;if(c&&c.isBlock||l.depth<2||!l.sameParent(a))return!1;const u=l.node(-1);if(u.type!==o)return!1;const d=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==o||l.index(-2)!==l.node(-2).childCount-1)return!1;if(r){let g=S.empty;const k=l.index(-1)?1:l.index(-2)?2:3;for(let Y=l.depth-k;Y>=l.depth-3;Y-=1)g=S.from(l.node(Y).copy(g));const w=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,P=nr(d,l.node().type.name,l.node().attrs),U=((s=o.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(P))||void 0;g=g.append(S.from(o.createAndFill(null,U)||void 0));const W=l.before(l.depth-(k-1));e.replace(W,l.after(-w),new A(g,4-k,0));let N=-1;e.doc.nodesBetween(W,e.doc.content.size,(Y,se)=>{if(N>-1)return!1;Y.isTextblock&&Y.content.size===0&&(N=se+1)}),N>-1&&e.setSelection(H.near(e.doc.resolve(N))),e.scrollIntoView()}return!0}const h=a.pos===l.end()?u.contentMatchAt(0).defaultType:null,f=nr(d,u.type.name,u.attrs),p=nr(d,l.node().type.name,l.node().attrs);e.delete(l.pos,a.pos);const m=h?[{type:o,attrs:f},{type:h,attrs:p}]:[{type:o,attrs:f}];if(!dn(e.doc,l.pos,2))return!1;if(r){const{selection:g,storedMarks:k}=t,{splittableMarks:w}=i.extensionManager,P=k||g.$to.parentOffset&&g.$from.marks();if(e.split(l.pos,2,m).scrollIntoView(),!P||!r)return!0;const U=P.filter(W=>w.includes(W.type.name));e.ensureMarks(U)}return!0},xi=(n,e)=>{const t=Ms(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&Et(n.doc,t.pos)&&n.join(t.pos),!0},Mi=(n,e)=>{const t=Ms(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===i?.type&&Et(n.doc,r)&&n.join(r),!0},$f=(n,e,t,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:a,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,f=ue(n,o.schema),p=ue(e,o.schema),{selection:m,storedMarks:g}=o,{$from:k,$to:w}=m,P=k.blockRange(w),U=g||m.$to.parentOffset&&m.$from.marks();if(!P)return!1;const W=Ms(N=>jo(N.type.name,d))(m);if(P.depth>=1&&W&&P.depth-W.depth<=1){if(W.node.type===f)return c.liftListItem(p);if(jo(W.node.type.name,d)&&f.validContent(W.node.content)&&l)return a().command(()=>(s.setNodeMarkup(W.pos,f),!0)).command(()=>xi(s,f)).command(()=>Mi(s,f)).run()}return!t||!U||!l?a().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>xi(s,f)).command(()=>Mi(s,f)).run():a().command(()=>{const N=u().wrapInList(f,r),Y=U.filter(se=>h.includes(se.type.name));return s.ensureMarks(Y),N?!0:c.clearNodes()}).wrapInList(f,r).command(()=>xi(s,f)).command(()=>Mi(s,f)).run()},Hf=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=t,o=Tt(n,r.schema);return Gi(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},Vf=(n,e,t={})=>({state:r,commands:i})=>{const s=ue(n,r.schema),o=ue(e,r.schema);return Fn(r,s,t)?i.setNode(o):i.setNode(s,t)},jf=(n,e={})=>({state:t,commands:r})=>{const i=ue(n,t.schema);return Fn(t,i,e)?r.lift(i):r.wrapIn(i,e)},_f=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let s;if(i.spec.isInputRules&&(s=i.getState(n))){if(e){const o=n.tr,l=s.transform;for(let a=l.steps.length-1;a>=0;a-=1)o.step(l.steps[a].invert(l.docs[a]));if(s.text){const a=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,n.schema.text(s.text,a))}else o.delete(s.from,s.to)}return!0}}return!1},Wf=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(s=>{n.removeMark(s.$from.pos,s.$to.pos)}),!0},Kf=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=t,a=Tt(n,r.schema),{$from:c,empty:u,ranges:d}=l;if(!i)return!0;if(u&&o){let{from:h,to:f}=l;const p=(s=c.marks().find(g=>g.type===a))===null||s===void 0?void 0:s.attrs,m=Ss(c,a,p);m&&(h=m.from,f=m.to),t.removeMark(h,f,a)}else d.forEach(h=>{t.removeMark(h.$from.pos,h.$to.pos,a)});return t.removeStoredMark(a),!0},Uf=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let s=null,o=null;const l=Gr(typeof n=="string"?n:n.name,r.schema);return l?(l==="node"&&(s=ue(n,r.schema)),l==="mark"&&(o=Tt(n,r.schema)),i&&t.selection.ranges.forEach(a=>{const c=a.$from.pos,u=a.$to.pos;r.doc.nodesBetween(c,u,(d,h)=>{s&&s===d.type&&t.setNodeMarkup(h,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(f=>{if(o===f.type){const p=Math.max(h,c),m=Math.min(h+d.nodeSize,u);t.addMark(p,m,o.create({...f.attrs,...e}))}})})}),!0):!1},Jf=(n,e={})=>({state:t,dispatch:r})=>{const i=ue(n,t.schema);return lh(i,e)(t,r)},qf=(n,e={})=>({state:t,dispatch:r})=>{const i=ue(n,t.schema);return ah(i,e)(t,r)};var Gf=Object.freeze({__proto__:null,blur:Nh,clearContent:vh,clearNodes:Ih,command:Dh,createParagraphNear:Rh,cut:Ph,deleteCurrentNode:Lh,deleteNode:Bh,deleteRange:zh,deleteSelection:Fh,enter:$h,exitCode:Hh,extendMarkRange:jh,first:_h,focus:Wh,forEach:Kh,insertContent:Uh,insertContentAt:Gh,joinUp:Yh,joinDown:Xh,joinBackward:Qh,joinForward:Zh,joinItemBackward:ef,joinItemForward:tf,keyboardShortcut:rf,lift:sf,liftEmptyBlock:of,liftListItem:lf,newlineInCode:af,resetAttributes:cf,scrollIntoView:uf,selectAll:df,selectNodeBackward:hf,selectNodeForward:ff,selectParentNode:pf,selectTextblockEnd:mf,selectTextblockStart:gf,setContent:yf,setMark:If,setMeta:Df,setNode:Rf,setNodeSelection:Pf,setTextSelection:Lf,sinkListItem:Bf,splitBlock:zf,splitListItem:Ff,toggleList:$f,toggleMark:Hf,toggleNode:Vf,toggleWrap:jf,undoInputRule:_f,unsetAllMarks:Wf,unsetMark:Kf,updateAttributes:Uf,wrapIn:Jf,wrapInList:qf});const Yf=De.create({name:"commands",addCommands(){return{...Gf}}}),Xf=De.create({name:"editable",addProseMirrorPlugins(){return[new me({key:new Pe("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Qf=De.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new me({key:new Pe("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),Zf=De.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:a,doc:c}=l,{empty:u,$anchor:d}=a,{pos:h,parent:f}=d,p=d.parent.isTextblock?l.doc.resolve(h-1):d,m=p.parent.type.spec.isolating,g=d.pos-d.parentOffset,k=m&&p.parent.childCount===1?g===d.pos:j.atStart(c).from===h;return!u||!k||!f.type.isTextblock||f.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ws()||xs()?s:i},addProseMirrorPlugins(){return[new me({key:new Pe("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(p=>p.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:i,from:s,to:o}=e.selection,l=j.atStart(e.doc).from,a=j.atEnd(e.doc).to;if(i||!(s===l&&o===a)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,h=Wr({state:t,transaction:d}),{commands:f}=new Kr({editor:this.editor,state:h});if(f.clearNodes(),!!d.steps.length)return d}})]}}),ep=De.create({name:"tabindex",addProseMirrorPlugins(){return[new me({key:new Pe("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var tp=Object.freeze({__proto__:null,ClipboardTextSerializer:Ah,Commands:Yf,Editable:Xf,FocusEvents:Qf,Keymap:Zf,Tabindex:ep});const np=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function rp(n,e,t){const r=document.querySelector(`style[data-tiptap-style${t?`-${t}`:""}]`);if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute(`data-tiptap-style${t?`-${t}`:""}`,""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}let ip=class extends ph{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=rp(np,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Aa(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});this.view.updateState(i)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(i=>!i.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){const t=[...this.options.enableCoreExtensions?Object.values(tp):[],...this.options.extensions].filter(r=>["extension","node","mark"].includes(r?.type));this.extensionManager=new on(t,this)}createCommandManager(){this.commandManager=new Kr({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=Ra(this.options.content,this.schema,this.options.parseOptions),t=Da(e,this.options.autofocus);this.view=new Rd(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:sn.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return Pa(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return Af(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return xf(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return Mf(this.state.doc,{blockSeparator:t,textSerializers:{...va(this.schema),...r}})}get isEmpty(){return Nf(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}};function qt(n){return new Jr({find:n.find,handler:({state:e,range:t,match:r})=>{const i=V(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],l=r[0];if(o){const a=l.search(/\S/),c=t.from+l.indexOf(o),u=c+o.length;if(Cs(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===n.type&&m!==f.mark.type)).filter(f=>f.to>c).length)return null;u<t.to&&s.delete(u,t.to),c>t.from&&s.delete(t.from+a,c);const h=t.from+a+o.length;s.addMark(t.from+a,h,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}function La(n){return new Jr({find:n.find,handler:({state:e,range:t,match:r})=>{const i=V(n.getAttributes,void 0,r)||{},{tr:s}=e,o=t.from;let l=t.to;const a=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>l?u=l:l=u+r[1].length;const d=r[0][r[0].length-1];s.insertText(d,o+r[0].length-1),s.replaceWith(u,l,a)}else r[0]&&s.insert(o-1,n.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l));s.scrollIntoView()}})}function Yi(n){return new Jr({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),s=V(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,s)}})}function $n(n){return new Jr({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const s=V(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),a=o.doc.resolve(t.from).blockRange(),c=a&&ls(a,n.type,s);if(!c)return null;if(o.wrap(a,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:f}=n.editor.extensionManager,p=h||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(g=>f.includes(g.type.name));o.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,s).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Et(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}class Ae{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(I(this,"addOptions",{name:this.name}))),this.storage=V(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ae(e)}configure(e={}){const t=this.extend();return t.options=qr(this.options,e),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Ae(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=V(I(t,"addOptions",{name:t.name})),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(c=>c?.type.name===t.name))return!1;const a=o.find(c=>c?.type.name===t.name);return a&&r.removeStoredMark(a),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}class pe{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(I(this,"addOptions",{name:this.name}))),this.storage=V(I(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new pe(e)}configure(e={}){const t=this.extend();return t.options=qr(this.options,e),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new pe(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=V(I(t,"addOptions",{name:t.name})),t.storage=V(I(t,"addStorage",{name:t.name,options:t.options})),t}}function Gt(n){return new xh({find:n.find,handler:({state:e,range:t,match:r})=>{const i=V(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],l=r[0];let a=t.to;if(o){const c=l.search(/\S/),u=t.from+l.indexOf(o),d=u+o.length;if(Cs(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===n.type&&m!==f.mark.type)).filter(f=>f.to>u).length)return null;d<t.to&&s.delete(d,t.to),u>t.from&&s.delete(t.from+c,u),a=t.from+c+o.length,s.addMark(t.from+c,a,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}const sp=/^```([a-z]+)?[\s\n]$/,op=/^~~~([a-z]+)?[\s\n]$/,Ba=pe.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,s=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ee(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:n.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:s}=t;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0||r.nodeAt(l)?!1:n.commands.exitCode()}}},addInputRules(){return[Yi({find:sp,type:this.type,getAttributes:n=>({language:n[1]})}),Yi({find:op,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new me({key:new Pe("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i?.mode;if(!t||!s)return!1;const{tr:o}=n.state;return o.replaceSelectionWith(this.type.create({language:s})),o.setSelection(H.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(t.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}});var Es={exports:{}};function Os(n){return n instanceof Map?n.clear=n.delete=n.set=function(){throw new Error("map is read-only")}:n instanceof Set&&(n.add=n.clear=n.delete=function(){throw new Error("set is read-only")}),Object.freeze(n),Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];typeof t=="object"&&!Object.isFrozen(t)&&Os(t)}),n}Es.exports=Os;Es.exports.default=Os;class Wo{constructor(e){e.data===void 0&&(e.data={}),this.data=e.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function za(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function kt(n,...e){const t=Object.create(null);for(const r in n)t[r]=n[r];return e.forEach(function(r){for(const i in r)t[i]=r[i]}),t}const lp="</span>",Ko=n=>!!n.scope||n.sublanguage&&n.language,ap=(n,{prefix:e})=>{if(n.includes(".")){const t=n.split(".");return[`${e}${t.shift()}`,...t.map((r,i)=>`${r}${"_".repeat(i+1)}`)].join(" ")}return`${e}${n}`};class cp{constructor(e,t){this.buffer="",this.classPrefix=t.classPrefix,e.walk(this)}addText(e){this.buffer+=za(e)}openNode(e){if(!Ko(e))return;let t="";e.sublanguage?t=`language-${e.language}`:t=ap(e.scope,{prefix:this.classPrefix}),this.span(t)}closeNode(e){Ko(e)&&(this.buffer+=lp)}value(){return this.buffer}span(e){this.buffer+=`<span class="${e}">`}}const Uo=(n={})=>{const e={children:[]};return Object.assign(e,n),e};class Ts{constructor(){this.rootNode=Uo(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(e){this.top.children.push(e)}openNode(e){const t=Uo({scope:e});this.add(t),this.stack.push(t)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(e){return this.constructor._walk(e,this.rootNode)}static _walk(e,t){return typeof t=="string"?e.addText(t):t.children&&(e.openNode(t),t.children.forEach(r=>this._walk(e,r)),e.closeNode(t)),e}static _collapse(e){typeof e!="string"&&e.children&&(e.children.every(t=>typeof t=="string")?e.children=[e.children.join("")]:e.children.forEach(t=>{Ts._collapse(t)}))}}class up extends Ts{constructor(e){super(),this.options=e}addKeyword(e,t){e!==""&&(this.openNode(t),this.addText(e),this.closeNode())}addText(e){e!==""&&this.add(e)}addSublanguage(e,t){const r=e.root;r.sublanguage=!0,r.language=t,this.add(r)}toHTML(){return new cp(this,this.options).value()}finalize(){return!0}}function Hn(n){return n?typeof n=="string"?n:n.source:null}function Fa(n){return Yt("(?=",n,")")}function dp(n){return Yt("(?:",n,")*")}function hp(n){return Yt("(?:",n,")?")}function Yt(...n){return n.map(t=>Hn(t)).join("")}function fp(n){const e=n[n.length-1];return typeof e=="object"&&e.constructor===Object?(n.splice(n.length-1,1),e):{}}function As(...n){return"("+(fp(n).capture?"":"?:")+n.map(r=>Hn(r)).join("|")+")"}function $a(n){return new RegExp(n.toString()+"|").exec("").length-1}function pp(n,e){const t=n&&n.exec(e);return t&&t.index===0}const mp=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function Ns(n,{joinWith:e}){let t=0;return n.map(r=>{t+=1;const i=t;let s=Hn(r),o="";for(;s.length>0;){const l=mp.exec(s);if(!l){o+=s;break}o+=s.substring(0,l.index),s=s.substring(l.index+l[0].length),l[0][0]==="\\"&&l[1]?o+="\\"+String(Number(l[1])+i):(o+=l[0],l[0]==="("&&t++)}return o}).map(r=>`(${r})`).join(e)}const gp=/\b\B/,Ha="[a-zA-Z]\\w*",vs="[a-zA-Z_]\\w*",Va="\\b\\d+(\\.\\d+)?",ja="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",_a="\\b(0b[01]+)",yp="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",bp=(n={})=>{const e=/^#![ ]*\//;return n.binary&&(n.begin=Yt(e,/.*\b/,n.binary,/\b.*/)),kt({scope:"meta",begin:e,end:/$/,relevance:0,"on:begin":(t,r)=>{t.index!==0&&r.ignoreMatch()}},n)},Vn={begin:"\\\\[\\s\\S]",relevance:0},kp={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Vn]},Sp={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Vn]},wp={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},Xr=function(n,e,t={}){const r=kt({scope:"comment",begin:n,end:e,contains:[]},t);r.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const i=As("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return r.contains.push({begin:Yt(/[ ]+/,"(",i,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),r},xp=Xr("//","$"),Mp=Xr("/\\*","\\*/"),Cp=Xr("#","$"),Ep={scope:"number",begin:Va,relevance:0},Op={scope:"number",begin:ja,relevance:0},Tp={scope:"number",begin:_a,relevance:0},Ap={begin:/(?=\/[^/\n]*\/)/,contains:[{scope:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[Vn,{begin:/\[/,end:/\]/,relevance:0,contains:[Vn]}]}]},Np={scope:"title",begin:Ha,relevance:0},vp={scope:"title",begin:vs,relevance:0},Ip={begin:"\\.\\s*"+vs,relevance:0},Dp=function(n){return Object.assign(n,{"on:begin":(e,t)=>{t.data._beginMatch=e[1]},"on:end":(e,t)=>{t.data._beginMatch!==e[1]&&t.ignoreMatch()}})};var Yn=Object.freeze({__proto__:null,MATCH_NOTHING_RE:gp,IDENT_RE:Ha,UNDERSCORE_IDENT_RE:vs,NUMBER_RE:Va,C_NUMBER_RE:ja,BINARY_NUMBER_RE:_a,RE_STARTERS_RE:yp,SHEBANG:bp,BACKSLASH_ESCAPE:Vn,APOS_STRING_MODE:kp,QUOTE_STRING_MODE:Sp,PHRASAL_WORDS_MODE:wp,COMMENT:Xr,C_LINE_COMMENT_MODE:xp,C_BLOCK_COMMENT_MODE:Mp,HASH_COMMENT_MODE:Cp,NUMBER_MODE:Ep,C_NUMBER_MODE:Op,BINARY_NUMBER_MODE:Tp,REGEXP_MODE:Ap,TITLE_MODE:Np,UNDERSCORE_TITLE_MODE:vp,METHOD_GUARD:Ip,END_SAME_AS_BEGIN:Dp});function Rp(n,e){n.input[n.index-1]==="."&&e.ignoreMatch()}function Pp(n,e){n.className!==void 0&&(n.scope=n.className,delete n.className)}function Lp(n,e){e&&n.beginKeywords&&(n.begin="\\b("+n.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",n.__beforeBegin=Rp,n.keywords=n.keywords||n.beginKeywords,delete n.beginKeywords,n.relevance===void 0&&(n.relevance=0))}function Bp(n,e){Array.isArray(n.illegal)&&(n.illegal=As(...n.illegal))}function zp(n,e){if(n.match){if(n.begin||n.end)throw new Error("begin & end are not supported with match");n.begin=n.match,delete n.match}}function Fp(n,e){n.relevance===void 0&&(n.relevance=1)}const $p=(n,e)=>{if(!n.beforeMatch)return;if(n.starts)throw new Error("beforeMatch cannot be used with starts");const t=Object.assign({},n);Object.keys(n).forEach(r=>{delete n[r]}),n.keywords=t.keywords,n.begin=Yt(t.beforeMatch,Fa(t.begin)),n.starts={relevance:0,contains:[Object.assign(t,{endsParent:!0})]},n.relevance=0,delete t.beforeMatch},Hp=["of","and","for","in","not","or","if","then","parent","list","value"],Vp="keyword";function Wa(n,e,t=Vp){const r=Object.create(null);return typeof n=="string"?i(t,n.split(" ")):Array.isArray(n)?i(t,n):Object.keys(n).forEach(function(s){Object.assign(r,Wa(n[s],e,s))}),r;function i(s,o){e&&(o=o.map(l=>l.toLowerCase())),o.forEach(function(l){const a=l.split("|");r[a[0]]=[s,jp(a[0],a[1])]})}}function jp(n,e){return e?Number(e):_p(n)?0:1}function _p(n){return Hp.includes(n.toLowerCase())}const Jo={},Wt=n=>{console.error(n)},qo=(n,...e)=>{console.log(`WARN: ${n}`,...e)},Zt=(n,e)=>{Jo[`${n}/${e}`]||(console.log(`Deprecated as of ${n}. ${e}`),Jo[`${n}/${e}`]=!0)},Sr=new Error;function Ka(n,e,{key:t}){let r=0;const i=n[t],s={},o={};for(let l=1;l<=e.length;l++)o[l+r]=i[l],s[l+r]=!0,r+=$a(e[l-1]);n[t]=o,n[t]._emit=s,n[t]._multi=!0}function Wp(n){if(Array.isArray(n.begin)){if(n.skip||n.excludeBegin||n.returnBegin)throw Wt("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),Sr;if(typeof n.beginScope!="object"||n.beginScope===null)throw Wt("beginScope must be object"),Sr;Ka(n,n.begin,{key:"beginScope"}),n.begin=Ns(n.begin,{joinWith:""})}}function Kp(n){if(Array.isArray(n.end)){if(n.skip||n.excludeEnd||n.returnEnd)throw Wt("skip, excludeEnd, returnEnd not compatible with endScope: {}"),Sr;if(typeof n.endScope!="object"||n.endScope===null)throw Wt("endScope must be object"),Sr;Ka(n,n.end,{key:"endScope"}),n.end=Ns(n.end,{joinWith:""})}}function Up(n){n.scope&&typeof n.scope=="object"&&n.scope!==null&&(n.beginScope=n.scope,delete n.scope)}function Jp(n){Up(n),typeof n.beginScope=="string"&&(n.beginScope={_wrap:n.beginScope}),typeof n.endScope=="string"&&(n.endScope={_wrap:n.endScope}),Wp(n),Kp(n)}function qp(n){function e(o,l){return new RegExp(Hn(o),"m"+(n.case_insensitive?"i":"")+(n.unicodeRegex?"u":"")+(l?"g":""))}class t{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(l,a){a.position=this.position++,this.matchIndexes[this.matchAt]=a,this.regexes.push([a,l]),this.matchAt+=$a(l)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const l=this.regexes.map(a=>a[1]);this.matcherRe=e(Ns(l,{joinWith:"|"}),!0),this.lastIndex=0}exec(l){this.matcherRe.lastIndex=this.lastIndex;const a=this.matcherRe.exec(l);if(!a)return null;const c=a.findIndex((d,h)=>h>0&&d!==void 0),u=this.matchIndexes[c];return a.splice(0,c),Object.assign(a,u)}}class r{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(l){if(this.multiRegexes[l])return this.multiRegexes[l];const a=new t;return this.rules.slice(l).forEach(([c,u])=>a.addRule(c,u)),a.compile(),this.multiRegexes[l]=a,a}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(l,a){this.rules.push([l,a]),a.type==="begin"&&this.count++}exec(l){const a=this.getMatcher(this.regexIndex);a.lastIndex=this.lastIndex;let c=a.exec(l);if(this.resumingScanAtSamePosition()&&!(c&&c.index===this.lastIndex)){const u=this.getMatcher(0);u.lastIndex=this.lastIndex+1,c=u.exec(l)}return c&&(this.regexIndex+=c.position+1,this.regexIndex===this.count&&this.considerAll()),c}}function i(o){const l=new r;return o.contains.forEach(a=>l.addRule(a.begin,{rule:a,type:"begin"})),o.terminatorEnd&&l.addRule(o.terminatorEnd,{type:"end"}),o.illegal&&l.addRule(o.illegal,{type:"illegal"}),l}function s(o,l){const a=o;if(o.isCompiled)return a;[Pp,zp,Jp,$p].forEach(u=>u(o,l)),n.compilerExtensions.forEach(u=>u(o,l)),o.__beforeBegin=null,[Lp,Bp,Fp].forEach(u=>u(o,l)),o.isCompiled=!0;let c=null;return typeof o.keywords=="object"&&o.keywords.$pattern&&(o.keywords=Object.assign({},o.keywords),c=o.keywords.$pattern,delete o.keywords.$pattern),c=c||/\w+/,o.keywords&&(o.keywords=Wa(o.keywords,n.case_insensitive)),a.keywordPatternRe=e(c,!0),l&&(o.begin||(o.begin=/\B|\b/),a.beginRe=e(a.begin),!o.end&&!o.endsWithParent&&(o.end=/\B|\b/),o.end&&(a.endRe=e(a.end)),a.terminatorEnd=Hn(a.end)||"",o.endsWithParent&&l.terminatorEnd&&(a.terminatorEnd+=(o.end?"|":"")+l.terminatorEnd)),o.illegal&&(a.illegalRe=e(o.illegal)),o.contains||(o.contains=[]),o.contains=[].concat(...o.contains.map(function(u){return Gp(u==="self"?o:u)})),o.contains.forEach(function(u){s(u,a)}),o.starts&&s(o.starts,l),a.matcher=i(a),a}if(n.compilerExtensions||(n.compilerExtensions=[]),n.contains&&n.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return n.classNameAliases=kt(n.classNameAliases||{}),s(n)}function Ua(n){return n?n.endsWithParent||Ua(n.starts):!1}function Gp(n){return n.variants&&!n.cachedVariants&&(n.cachedVariants=n.variants.map(function(e){return kt(n,{variants:null},e)})),n.cachedVariants?n.cachedVariants:Ua(n)?kt(n,{starts:n.starts?kt(n.starts):null}):Object.isFrozen(n)?kt(n):n}var Yp="11.6.0";class Xp extends Error{constructor(e,t){super(e),this.name="HTMLInjectionError",this.html=t}}const Ci=za,Go=kt,Yo=Symbol("nomatch"),Qp=7,Zp=function(n){const e=Object.create(null),t=Object.create(null),r=[];let i=!0;const s="Could not find the language '{}', did you forget to load/include a language module?",o={disableAutodetect:!0,name:"Plain text",contains:[]};let l={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:up};function a(y){return l.noHighlightRe.test(y)}function c(y){let b=y.className+" ";b+=y.parentNode?y.parentNode.className:"";const M=l.languageDetectRe.exec(b);if(M){const E=v(M[1]);return E||(qo(s.replace("{}",M[1])),qo("Falling back to no-highlight mode for this block.",y)),E?M[1]:"no-highlight"}return b.split(/\s+/).find(E=>a(E)||v(E))}function u(y,b,M){let E="",L="";typeof b=="object"?(E=y,M=b.ignoreIllegals,L=b.language):(Zt("10.7.0","highlight(lang, code, ...args) has been deprecated."),Zt("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),L=y,E=b),M===void 0&&(M=!0);const K={code:E,language:L};O("before:highlight",K);const J=K.result?K.result:d(K.language,K.code,M);return J.code=K.code,O("after:highlight",J),J}function d(y,b,M,E){const L=Object.create(null);function K(T,R){return T.keywords[R]}function J(){if(!F.keywords){oe.addText(Z);return}let T=0;F.keywordPatternRe.lastIndex=0;let R=F.keywordPatternRe.exec(Z),_="";for(;R;){_+=Z.substring(T,R.index);const q=ct.case_insensitive?R[0].toLowerCase():R[0],be=K(F,q);if(be){const[rt,lc]=be;if(oe.addText(_),_="",L[q]=(L[q]||0)+1,L[q]<=Qp&&(Un+=lc),rt.startsWith("_"))_+=R[0];else{const ac=ct.classNameAliases[rt]||rt;oe.addKeyword(R[0],ac)}}else _+=R[0];T=F.keywordPatternRe.lastIndex,R=F.keywordPatternRe.exec(Z)}_+=Z.substring(T),oe.addText(_)}function X(){if(Z==="")return;let T=null;if(typeof F.subLanguage=="string"){if(!e[F.subLanguage]){oe.addText(Z);return}T=d(F.subLanguage,Z,!0,Hs[F.subLanguage]),Hs[F.subLanguage]=T._top}else T=f(Z,F.subLanguage.length?F.subLanguage:null);F.relevance>0&&(Un+=T.relevance),oe.addSublanguage(T._emitter,T.language)}function Q(){F.subLanguage!=null?X():J(),Z=""}function Me(T,R){let _=1;const q=R.length-1;for(;_<=q;){if(!T._emit[_]){_++;continue}const be=ct.classNameAliases[T[_]]||T[_],rt=R[_];be?oe.addKeyword(rt,be):(Z=rt,J(),Z=""),_++}}function We(T,R){return T.scope&&typeof T.scope=="string"&&oe.openNode(ct.classNameAliases[T.scope]||T.scope),T.beginScope&&(T.beginScope._wrap?(oe.addKeyword(Z,ct.classNameAliases[T.beginScope._wrap]||T.beginScope._wrap),Z=""):T.beginScope._multi&&(Me(T.beginScope,R),Z="")),F=Object.create(T,{parent:{value:F}}),F}function at(T,R,_){let q=pp(T.endRe,_);if(q){if(T["on:end"]){const be=new Wo(T);T["on:end"](R,be),be.isMatchIgnored&&(q=!1)}if(q){for(;T.endsParent&&T.parent;)T=T.parent;return T}}if(T.endsWithParent)return at(T.parent,R,_)}function tt(T){return F.matcher.regexIndex===0?(Z+=T[0],1):(ti=!0,0)}function ye(T){const R=T[0],_=T.rule,q=new Wo(_),be=[_.__beforeBegin,_["on:begin"]];for(const rt of be)if(rt&&(rt(T,q),q.isMatchIgnored))return tt(R);return _.skip?Z+=R:(_.excludeBegin&&(Z+=R),Q(),!_.returnBegin&&!_.excludeBegin&&(Z=R)),We(_,T),_.returnBegin?0:R.length}function Ke(T){const R=T[0],_=b.substring(T.index),q=at(F,T,_);if(!q)return Yo;const be=F;F.endScope&&F.endScope._wrap?(Q(),oe.addKeyword(R,F.endScope._wrap)):F.endScope&&F.endScope._multi?(Q(),Me(F.endScope,T)):be.skip?Z+=R:(be.returnEnd||be.excludeEnd||(Z+=R),Q(),be.excludeEnd&&(Z=R));do F.scope&&oe.closeNode(),!F.skip&&!F.subLanguage&&(Un+=F.relevance),F=F.parent;while(F!==q.parent);return q.starts&&We(q.starts,T),be.returnEnd?0:R.length}function At(){const T=[];for(let R=F;R!==ct;R=R.parent)R.scope&&T.unshift(R.scope);T.forEach(R=>oe.openNode(R))}let nt={};function $s(T,R){const _=R&&R[0];if(Z+=T,_==null)return Q(),0;if(nt.type==="begin"&&R.type==="end"&&nt.index===R.index&&_===""){if(Z+=b.slice(R.index,R.index+1),!i){const q=new Error(`0 width match regex (${y})`);throw q.languageName=y,q.badRule=nt.rule,q}return 1}if(nt=R,R.type==="begin")return ye(R);if(R.type==="illegal"&&!M){const q=new Error('Illegal lexeme "'+_+'" for mode "'+(F.scope||"<unnamed>")+'"');throw q.mode=F,q}else if(R.type==="end"){const q=Ke(R);if(q!==Yo)return q}if(R.type==="illegal"&&_==="")return 1;if(ei>1e5&&ei>R.index*3)throw new Error("potential infinite loop, way more iterations than matches");return Z+=_,_.length}const ct=v(y);if(!ct)throw Wt(s.replace("{}",y)),new Error('Unknown language: "'+y+'"');const oc=qp(ct);let Zr="",F=E||oc;const Hs={},oe=new l.__emitter(l);At();let Z="",Un=0,Nt=0,ei=0,ti=!1;try{for(F.matcher.considerAll();;){ei++,ti?ti=!1:F.matcher.considerAll(),F.matcher.lastIndex=Nt;const T=F.matcher.exec(b);if(!T)break;const R=b.substring(Nt,T.index),_=$s(R,T);Nt=T.index+_}return $s(b.substring(Nt)),oe.closeAllNodes(),oe.finalize(),Zr=oe.toHTML(),{language:y,value:Zr,relevance:Un,illegal:!1,_emitter:oe,_top:F}}catch(T){if(T.message&&T.message.includes("Illegal"))return{language:y,value:Ci(b),illegal:!0,relevance:0,_illegalBy:{message:T.message,index:Nt,context:b.slice(Nt-100,Nt+100),mode:T.mode,resultSoFar:Zr},_emitter:oe};if(i)return{language:y,value:Ci(b),illegal:!1,relevance:0,errorRaised:T,_emitter:oe,_top:F};throw T}}function h(y){const b={value:Ci(y),illegal:!1,relevance:0,_top:o,_emitter:new l.__emitter(l)};return b._emitter.addText(y),b}function f(y,b){b=b||l.languages||Object.keys(e);const M=h(y),E=b.filter(v).filter(ge).map(Q=>d(Q,y,!1));E.unshift(M);const L=E.sort((Q,Me)=>{if(Q.relevance!==Me.relevance)return Me.relevance-Q.relevance;if(Q.language&&Me.language){if(v(Q.language).supersetOf===Me.language)return 1;if(v(Me.language).supersetOf===Q.language)return-1}return 0}),[K,J]=L,X=K;return X.secondBest=J,X}function p(y,b,M){const E=b&&t[b]||M;y.classList.add("hljs"),y.classList.add(`language-${E}`)}function m(y){let b=null;const M=c(y);if(a(M))return;if(O("before:highlightElement",{el:y,language:M}),y.children.length>0&&(l.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(y)),l.throwUnescapedHTML))throw new Xp("One of your code blocks includes unescaped HTML.",y.innerHTML);b=y;const E=b.textContent,L=M?u(E,{language:M,ignoreIllegals:!0}):f(E);y.innerHTML=L.value,p(y,M,L.language),y.result={language:L.language,re:L.relevance,relevance:L.relevance},L.secondBest&&(y.secondBest={language:L.secondBest.language,relevance:L.secondBest.relevance}),O("after:highlightElement",{el:y,result:L,text:E})}function g(y){l=Go(l,y)}const k=()=>{U(),Zt("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function w(){U(),Zt("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let P=!1;function U(){if(document.readyState==="loading"){P=!0;return}document.querySelectorAll(l.cssSelector).forEach(m)}function W(){P&&U()}typeof window<"u"&&window.addEventListener&&window.addEventListener("DOMContentLoaded",W,!1);function N(y,b){let M=null;try{M=b(n)}catch(E){if(Wt("Language definition for '{}' could not be registered.".replace("{}",y)),i)Wt(E);else throw E;M=o}M.name||(M.name=y),e[y]=M,M.rawDefinition=b.bind(null,n),M.aliases&&$(M.aliases,{languageName:y})}function Y(y){delete e[y];for(const b of Object.keys(t))t[b]===y&&delete t[b]}function se(){return Object.keys(e)}function v(y){return y=(y||"").toLowerCase(),e[y]||e[t[y]]}function $(y,{languageName:b}){typeof y=="string"&&(y=[y]),y.forEach(M=>{t[M.toLowerCase()]=b})}function ge(y){const b=v(y);return b&&!b.disableAutodetect}function Le(y){y["before:highlightBlock"]&&!y["before:highlightElement"]&&(y["before:highlightElement"]=b=>{y["before:highlightBlock"](Object.assign({block:b.el},b))}),y["after:highlightBlock"]&&!y["after:highlightElement"]&&(y["after:highlightElement"]=b=>{y["after:highlightBlock"](Object.assign({block:b.el},b))})}function z(y){Le(y),r.push(y)}function O(y,b){const M=y;r.forEach(function(E){E[M]&&E[M](b)})}function C(y){return Zt("10.7.0","highlightBlock will be removed entirely in v12.0"),Zt("10.7.0","Please use highlightElement now."),m(y)}Object.assign(n,{highlight:u,highlightAuto:f,highlightAll:U,highlightElement:m,highlightBlock:C,configure:g,initHighlighting:k,initHighlightingOnLoad:w,registerLanguage:N,unregisterLanguage:Y,listLanguages:se,getLanguage:v,registerAliases:$,autoDetection:ge,inherit:Go,addPlugin:z}),n.debugMode=function(){i=!1},n.safeMode=function(){i=!0},n.versionString=Yp,n.regex={concat:Yt,lookahead:Fa,either:As,optional:hp,anyNumberOfTimes:dp};for(const y in Yn)typeof Yn[y]=="object"&&Es.exports(Yn[y]);return Object.assign(n,Yn),n};var jn=Zp({}),em=jn;jn.HighlightJS=jn;jn.default=jn;var tm=em;function Ja(n,e=[]){return n.map(t=>{const r=[...e,...t.properties?t.properties.className:[]];return t.children?Ja(t.children,r):{text:t.value,classes:r}}).flat()}function Xo(n){return n.value||n.children||[]}function nm(n){return!!tm.getLanguage(n)}function Qo({doc:n,name:e,lowlight:t,defaultLanguage:r}){const i=[];return qi(n,s=>s.type.name===e).forEach(s=>{let o=s.pos+1;const l=s.node.attrs.language||r,a=t.listLanguages(),c=l&&(a.includes(l)||nm(l))?Xo(t.highlight(l,s.node.textContent)):Xo(t.highlightAuto(s.node.textContent));Ja(c).forEach(u=>{const d=o+u.text.length;if(u.classes.length){const h=ve.inline(o,d,{class:u.classes.join(" ")});i.push(h)}o=d})}),re.create(n,i)}function rm(n){return typeof n=="function"}function im({name:n,lowlight:e,defaultLanguage:t}){if(!["highlight","highlightAuto","listLanguages"].every(i=>rm(e[i])))throw Error("You should provide an instance of lowlight to use the code-block-lowlight extension");const r=new me({key:new Pe("lowlight"),state:{init:(i,{doc:s})=>Qo({doc:s,name:n,lowlight:e,defaultLanguage:t}),apply:(i,s,o,l)=>{const a=o.selection.$head.parent.type.name,c=l.selection.$head.parent.type.name,u=qi(o.doc,h=>h.type.name===n),d=qi(l.doc,h=>h.type.name===n);return i.docChanged&&([a,c].includes(n)||d.length!==u.length||i.steps.some(h=>h.from!==void 0&&h.to!==void 0&&u.some(f=>f.pos>=h.from&&f.pos+f.node.nodeSize<=h.to)))?Qo({doc:i.doc,name:n,lowlight:e,defaultLanguage:t}):s.map(i.mapping,i.doc)}},props:{decorations(i){return r.getState(i)}}});return r}Ba.extend({addOptions(){var n;return{...(n=this.parent)===null||n===void 0?void 0:n.call(this),lowlight:{},defaultLanguage:null}},addProseMirrorPlugins(){var n;return[...((n=this.parent)===null||n===void 0?void 0:n.call(this))||[],im({name:this.name,lowlight:this.options.lowlight,defaultLanguage:this.options.defaultLanguage})]}});const qa=pe.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ee(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Yi({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}}),sm=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))$/,om=/(?:^|\s)((?:==)((?:[^~=]+))(?:==))/g,lm=Ae.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:n=>n.getAttribute("data-color")||n.style.backgroundColor,renderHTML:n=>n.color?{"data-color":n.color,style:`background-color: ${n.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:n}){return["mark",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setHighlight:n=>({commands:e})=>e.setMark(this.name,n),toggleHighlight:n=>({commands:e})=>e.toggleMark(this.name,n),unsetHighlight:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[qt({find:sm,type:this.type})]},addPasteRules(){return[Gt({find:om,type:this.type})]}}),am=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,cm=pe.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:n}){return["img",ee(this.options.HTMLAttributes,n)]},addCommands(){return{setImage:n=>({commands:e})=>e.insertContent({type:this.name,attrs:n})}},addInputRules(){return[La({find:am,type:this.type,getAttributes:n=>{const[,,e,t,r]=n;return{src:t,alt:e,title:r}}})]}}),um="aaa1rp3barth4b0ott3vie4c1le2ogado5udhabi7c0ademy5centure6ountant0s9o1tor4d0s1ult4e0g1ro2tna4f0l1rica5g0akhan5ency5i0g1rbus3force5tel5kdn3l0faromeo7ibaba4pay4lfinanz6state5y2sace3tom5m0azon4ericanexpress7family11x2fam3ica3sterdam8nalytics7droid5quan4z2o0l2partments8p0le4q0uarelle8r0ab1mco4chi3my2pa2t0e3s0da2ia2sociates9t0hleta5torney7u0ction5di0ble3o3spost5thor3o0s4vianca6w0s2x0a2z0ure5ba0by2idu3namex3narepublic11d1k2r0celona5laycard4s5efoot5gains6seball5ketball8uhaus5yern5b0c1t1va3cg1n2d1e0ats2uty4er2ntley5rlin4st0buy5t2f1g1h0arti5i0ble3d1ke2ng0o3o1z2j1lack0friday9ockbuster8g1omberg7ue3m0s1w2n0pparibas9o0ats3ehringer8fa2m1nd2o0k0ing5sch2tik2on4t1utique6x2r0adesco6idgestone9oadway5ker3ther5ussels7s1t1uild0ers6siness6y1zz3v1w1y1z0h3ca0b1fe2l0l1vinklein9m0era3p2non3petown5ital0one8r0avan4ds2e0er0s4s2sa1e1h1ino4t0ering5holic7ba1n1re2s2c1d1enter4o1rn3f0a1d2g1h0anel2nel4rity4se2t2eap3intai5ristmas6ome4urch5i0priani6rcle4sco3tadel4i0c2y0eats7k1l0aims4eaning6ick2nic1que6othing5ud3ub0med6m1n1o0ach3des3ffee4llege4ogne5m0cast4mbank4unity6pany2re3uter5sec4ndos3struction8ulting7tact3ractors9oking0channel11l1p2rsica5untry4pon0s4rses6pa2r0edit0card4union9icket5own3s1uise0s6u0isinella9v1w1x1y0mru3ou3z2dabur3d1nce3ta1e1ing3sun4y2clk3ds2e0al0er2s3gree4livery5l1oitte5ta3mocrat6ntal2ist5si0gn4v2hl2iamonds6et2gital5rect0ory7scount3ver5h2y2j1k1m1np2o0cs1tor4g1mains5t1wnload7rive4tv2ubai3nlop4pont4rban5vag2r2z2earth3t2c0o2deka3u0cation8e1g1mail3erck5nergy4gineer0ing9terprises10pson4quipment8r0icsson6ni3s0q1tate5t0isalat7u0rovision8s2vents5xchange6pert3osed4ress5traspace10fage2il1rwinds6th3mily4n0s2rm0ers5shion4t3edex3edback6rrari3ero6i0at2delity5o2lm2nal1nce1ial7re0stone6mdale6sh0ing5t0ness6j1k1lickr3ghts4r2orist4wers5y2m1o0o0d0network8tball6rd1ex2sale4um3undation8x2r0ee1senius7l1ogans4ntdoor4ier7tr2ujitsu5n0d2rniture7tbol5yi3ga0l0lery3o1up4me0s3p1rden4y2b0iz3d0n2e0a1nt0ing5orge5f1g0ee3h1i0ft0s3ves2ing5l0ass3e1obal2o4m0ail3bh2o1x2n1odaddy5ld0point6f2o0dyear5g0le4p1t1v2p1q1r0ainger5phics5tis4een3ipe3ocery4up4s1t1u0ardian6cci3ge2ide2tars5ru3w1y2hair2mburg5ngout5us3bo2dfc0bank7ealth0care8lp1sinki6re1mes5gtv3iphop4samitsu7tachi5v2k0t2m1n1ockey4ldings5iday5medepot5goods5s0ense7nda3rse3spital5t0ing5t0eles2s3mail5use3w2r1sbc3t1u0ghes5yatt3undai7ibm2cbc2e1u2d1e0ee3fm2kano4l1m0amat4db2mo0bilien9n0c1dustries8finiti5o2g1k1stitute6urance4e4t0ernational10uit4vestments10o1piranga7q1r0ish4s0maili5t0anbul7t0au2v3jaguar4va3cb2e0ep2tzt3welry6io2ll2m0p2nj2o0bs1urg4t1y2p0morgan6rs3uegos4niper7kaufen5ddi3e0rryhotels6logistics9properties14fh2g1h1i0a1ds2m1nder2le4tchen5wi3m1n1oeln3matsu5sher5p0mg2n2r0d1ed3uokgroup8w1y0oto4z2la0caixa5mborghini8er3ncaster5ia3d0rover6xess5salle5t0ino3robe5w0yer5b1c1ds2ease3clerc5frak4gal2o2xus4gbt3i0dl2fe0insurance9style7ghting6ke2lly3mited4o2ncoln4de2k2psy3ve1ing5k1lc1p2oan0s3cker3us3l1ndon4tte1o3ve3pl0financial11r1s1t0d0a3u0ndbeck6xe1ury5v1y2ma0cys3drid4if1son4keup4n0agement7go3p1rket0ing3s4riott5shalls7serati6ttel5ba2c0kinsey7d1e0d0ia3et2lbourne7me1orial6n0u2rckmsd7g1h1iami3crosoft7l1ni1t2t0subishi9k1l0b1s2m0a2n1o0bi0le4da2e1i1m1nash3ey2ster5rmon3tgage6scow4to0rcycles9v0ie4p1q1r1s0d2t0n1r2u0seum3ic3tual5v1w1x1y1z2na0b1goya4me2tura4vy3ba2c1e0c1t0bank4flix4work5ustar5w0s2xt0direct7us4f0l2g0o2hk2i0co2ke1on3nja3ssan1y5l1o0kia3rthwesternmutual14on4w0ruz3tv4p1r0a1w2tt2u1yc2z2obi1server7ffice5kinawa6layan0group9dnavy5lo3m0ega4ne1g1l0ine5oo2pen3racle3nge4g0anic5igins6saka4tsuka4t2vh3pa0ge2nasonic7ris2s1tners4s1y3ssagens7y2ccw3e0t2f0izer5g1h0armacy6d1ilips5one2to0graphy6s4ysio5ics1tet2ures6d1n0g1k2oneer5zza4k1l0ace2y0station9umbing5s3m1n0c2ohl2ker3litie5rn2st3r0america6xi3ess3ime3o0d0uctions8f1gressive8mo2perties3y5tection8u0dential9s1t1ub2w0c2y2qa1pon3uebec3st5racing4dio4e0ad1lestate6tor2y4cipes5d0stone5umbrella9hab3ise0n3t2liance6n0t0als5pair3ort3ublican8st0aurant8view0s5xroth6ich0ardli6oh3l1o1p2o0cher3ks3deo3gers4om3s0vp3u0gby3hr2n2w0e2yukyu6sa0arland6fe0ty4kura4le1on3msclub4ung5ndvik0coromant12ofi4p1rl2s1ve2xo3b0i1s2c0a1b1haeffler7midt4olarships8ol3ule3warz5ience5ot3d1e0arch3t2cure1ity6ek2lect4ner3rvices6ven3w1x0y3fr2g1h0angrila6rp2w2ell3ia1ksha5oes2p0ping5uji3w0time7i0lk2na1gles5te3j1k0i0n2y0pe4l0ing4m0art3ile4n0cf3o0ccer3ial4ftbank4ware6hu2lar2utions7ng1y2y2pa0ce3ort2t3r0l2s1t0ada2ples4r1tebank4farm7c0group6ockholm6rage3e3ream4udio2y3yle4u0cks3pplies3y2ort5rf1gery5zuki5v1watch4iss4x1y0dney4stems6z2tab1ipei4lk2obao4rget4tamotors6r2too4x0i3c0i2d0k2eam2ch0nology8l1masek5nnis4va3f1g1h0d1eater2re6iaa2ckets5enda4ffany5ps2res2ol4j0maxx4x2k0maxx5l1m0all4n1o0day3kyo3ols3p1ray3shiba5tal3urs3wn2yota3s3r0ade1ing4ining5vel0channel7ers0insurance16ust3v2t1ube2i1nes3shu4v0s2w1z2ua1bank3s2g1k1nicom3versity8o2ol2ps2s1y1z2va0cations7na1guard7c1e0gas3ntures6risign5mgensberater2ung14sicherung10t2g1i0ajes4deo3g1king4llas4n1p1rgin4sa1ion4va1o3laanderen9n1odka3lkswagen7vo3te1ing3o2yage5u0elos6wales2mart4ter4ng0gou5tch0es6eather0channel12bcam3er2site5d0ding5ibo2r3f1hoswho6ien2ki2lliamhill9n0dows4e1ners6me2olterskluwer11odside6rk0s2ld3w2s1tc1f3xbox3erox4finity6ihuan4n2xx2yz3yachts4hoo3maxun5ndex5e1odobashi7ga2kohama6u0tube6t1un3za0ppos4ra3ero3ip2m1one3uerich6w2",dm="1213426321653223333353565455655552435435422463632574574330355524444661154543332344423364211133222221212112052232222232212222223222241112222224322321222",Sn=(n,e)=>{for(const t in e)n[t]=e[t];return n},Xi="numeric",Qi="ascii",Zi="alpha",rr="asciinumeric",Xn="alphanumeric",es="domain",Ga="emoji",hm="scheme",fm="slashscheme",Zo="whitespace";function pm(n,e){return n in e||(e[n]=[]),e[n]}function Ft(n,e,t){e[Xi]&&(e[rr]=!0,e[Xn]=!0),e[Qi]&&(e[rr]=!0,e[Zi]=!0),e[rr]&&(e[Xn]=!0),e[Zi]&&(e[Xn]=!0),e[Xn]&&(e[es]=!0),e[Ga]&&(e[es]=!0);for(const r in e){const i=pm(r,t);i.indexOf(n)<0&&i.push(n)}}function mm(n,e){const t={};for(const r in e)e[r].indexOf(n)>=0&&(t[r]=!0);return t}function Ne(n){n===void 0&&(n=null),this.j={},this.jr=[],this.jd=null,this.t=n}Ne.groups={};Ne.prototype={accepts(){return!!this.t},go(n){const e=this,t=e.j[n];if(t)return t;for(let r=0;r<e.jr.length;r++){const i=e.jr[r][0],s=e.jr[r][1];if(s&&i.test(n))return s}return e.jd},has(n,e){return e===void 0&&(e=!1),e?n in this.j:!!this.go(n)},ta(n,e,t,r){for(let i=0;i<n.length;i++)this.tt(n[i],e,t,r)},tr(n,e,t,r){r=r||Ne.groups;let i;return e&&e.j?i=e:(i=new Ne(e),t&&r&&Ft(e,t,r)),this.jr.push([n,i]),i},ts(n,e,t,r){let i=this;const s=n.length;if(!s)return i;for(let o=0;o<s-1;o++)i=i.tt(n[o]);return i.tt(n[s-1],e,t,r)},tt(n,e,t,r){r=r||Ne.groups;const i=this;if(e&&e.j)return i.j[n]=e,e;const s=e;let o,l=i.go(n);if(l?(o=new Ne,Sn(o.j,l.j),o.jr.push.apply(o.jr,l.jr),o.jd=l.jd,o.t=l.t):o=new Ne,s){if(r)if(o.t&&typeof o.t=="string"){const a=Sn(mm(o.t,r),t);Ft(s,a,r)}else t&&Ft(s,t,r);o.t=s}return i.j[n]=o,o}};const D=(n,e,t,r,i)=>n.ta(e,t,r,i),Be=(n,e,t,r,i)=>n.tr(e,t,r,i),el=(n,e,t,r,i)=>n.ts(e,t,r,i),x=(n,e,t,r,i)=>n.tt(e,t,r,i),st="WORD",ts="UWORD",_n="LOCALHOST",ns="TLD",rs="UTLD",ir="SCHEME",rn="SLASH_SCHEME",Is="NUM",Ya="WS",Ds="NL",ln="OPENBRACE",vn="OPENBRACKET",In="OPENANGLEBRACKET",Dn="OPENPAREN",Rt="CLOSEBRACE",an="CLOSEBRACKET",cn="CLOSEANGLEBRACKET",Pt="CLOSEPAREN",wr="AMPERSAND",xr="APOSTROPHE",Mr="ASTERISK",ht="AT",Cr="BACKSLASH",Er="BACKTICK",Or="CARET",mt="COLON",Rs="COMMA",Tr="DOLLAR",Ue="DOT",Ar="EQUALS",Ps="EXCLAMATION",Je="HYPHEN",Nr="PERCENT",vr="PIPE",Ir="PLUS",Dr="POUND",Rr="QUERY",Ls="QUOTE",Bs="SEMI",qe="SLASH",Rn="TILDE",Pr="UNDERSCORE",Xa="EMOJI",Lr="SYM";var Qa=Object.freeze({__proto__:null,WORD:st,UWORD:ts,LOCALHOST:_n,TLD:ns,UTLD:rs,SCHEME:ir,SLASH_SCHEME:rn,NUM:Is,WS:Ya,NL:Ds,OPENBRACE:ln,OPENBRACKET:vn,OPENANGLEBRACKET:In,OPENPAREN:Dn,CLOSEBRACE:Rt,CLOSEBRACKET:an,CLOSEANGLEBRACKET:cn,CLOSEPAREN:Pt,AMPERSAND:wr,APOSTROPHE:xr,ASTERISK:Mr,AT:ht,BACKSLASH:Cr,BACKTICK:Er,CARET:Or,COLON:mt,COMMA:Rs,DOLLAR:Tr,DOT:Ue,EQUALS:Ar,EXCLAMATION:Ps,HYPHEN:Je,PERCENT:Nr,PIPE:vr,PLUS:Ir,POUND:Dr,QUERY:Rr,QUOTE:Ls,SEMI:Bs,SLASH:qe,TILDE:Rn,UNDERSCORE:Pr,EMOJI:Xa,SYM:Lr});const en=/[a-z]/,Ei=/\p{L}/u,Oi=/\p{Emoji}/u,Ti=/\d/,tl=/\s/,nl=`
`,gm="",ym="";let Qn=null,Zn=null;function bm(n){n===void 0&&(n=[]);const e={};Ne.groups=e;const t=new Ne;Qn==null&&(Qn=rl(um)),Zn==null&&(Zn=rl(dm)),x(t,"'",xr),x(t,"{",ln),x(t,"[",vn),x(t,"<",In),x(t,"(",Dn),x(t,"}",Rt),x(t,"]",an),x(t,">",cn),x(t,")",Pt),x(t,"&",wr),x(t,"*",Mr),x(t,"@",ht),x(t,"`",Er),x(t,"^",Or),x(t,":",mt),x(t,",",Rs),x(t,"$",Tr),x(t,".",Ue),x(t,"=",Ar),x(t,"!",Ps),x(t,"-",Je),x(t,"%",Nr),x(t,"|",vr),x(t,"+",Ir),x(t,"#",Dr),x(t,"?",Rr),x(t,'"',Ls),x(t,"/",qe),x(t,";",Bs),x(t,"~",Rn),x(t,"_",Pr),x(t,"\\",Cr);const r=Be(t,Ti,Is,{[Xi]:!0});Be(r,Ti,r);const i=Be(t,en,st,{[Qi]:!0});Be(i,en,i);const s=Be(t,Ei,ts,{[Zi]:!0});Be(s,en),Be(s,Ei,s);const o=Be(t,tl,Ya,{[Zo]:!0});x(t,nl,Ds,{[Zo]:!0}),x(o,nl),Be(o,tl,o);const l=Be(t,Oi,Xa,{[Ga]:!0});Be(l,Oi,l),x(l,gm,l);const a=x(l,ym);Be(a,Oi,l);const c=[[en,i]],u=[[en,null],[Ei,s]];for(let d=0;d<Qn.length;d++)ut(t,Qn[d],ns,st,c);for(let d=0;d<Zn.length;d++)ut(t,Zn[d],rs,ts,u);Ft(ns,{tld:!0,ascii:!0},e),Ft(rs,{utld:!0,alpha:!0},e),ut(t,"file",ir,st,c),ut(t,"mailto",ir,st,c),ut(t,"http",rn,st,c),ut(t,"https",rn,st,c),ut(t,"ftp",rn,st,c),ut(t,"ftps",rn,st,c),Ft(ir,{scheme:!0,ascii:!0},e),Ft(rn,{slashscheme:!0,ascii:!0},e),n=n.sort((d,h)=>d[0]>h[0]?1:-1);for(let d=0;d<n.length;d++){const h=n[d][0],p=n[d][1]?{[hm]:!0}:{[fm]:!0};h.indexOf("-")>=0?p[es]=!0:en.test(h)?Ti.test(h)?p[rr]=!0:p[Qi]=!0:p[Xi]=!0,el(t,h,h,p)}return el(t,"localhost",_n,{ascii:!0}),t.jd=new Ne(Lr),{start:t,tokens:Sn({groups:e},Qa)}}function km(n,e){const t=Sm(e.replace(/[A-Z]/g,l=>l.toLowerCase())),r=t.length,i=[];let s=0,o=0;for(;o<r;){let l=n,a=null,c=0,u=null,d=-1,h=-1;for(;o<r&&(a=l.go(t[o]));)l=a,l.accepts()?(d=0,h=0,u=l):d>=0&&(d+=t[o].length,h++),c+=t[o].length,s+=t[o].length,o++;s-=d,o-=h,c-=d,i.push({t:u.t,v:e.slice(s-c,s),s:s-c,e:s})}return i}function Sm(n){const e=[],t=n.length;let r=0;for(;r<t;){let i=n.charCodeAt(r),s,o=i<55296||i>56319||r+1===t||(s=n.charCodeAt(r+1))<56320||s>57343?n[r]:n.slice(r,r+2);e.push(o),r+=o.length}return e}function ut(n,e,t,r,i){let s;const o=e.length;for(let l=0;l<o-1;l++){const a=e[l];n.j[a]?s=n.j[a]:(s=new Ne(r),s.jr=i.slice(),n.j[a]=s),n=s}return s=new Ne(t),s.jr=i.slice(),n.j[e[o-1]]=s,s}function rl(n){const e=[],t=[];let r=0,i="0123456789";for(;r<n.length;){let s=0;for(;i.indexOf(n[r+s])>=0;)s++;if(s>0){e.push(t.join(""));for(let o=parseInt(n.substring(r,r+s),10);o>0;o--)t.pop();r+=s}else t.push(n[r]),r++}return e}const Wn={defaultProtocol:"http",events:null,format:il,formatHref:il,nl2br:!1,tagName:"a",target:null,rel:null,validate:!0,truncate:1/0,className:null,attributes:null,ignoreTags:[],render:null};function zs(n,e){e===void 0&&(e=null);let t=Sn({},Wn);n&&(t=Sn(t,n instanceof zs?n.o:n));const r=t.ignoreTags,i=[];for(let s=0;s<r.length;s++)i.push(r[s].toUpperCase());this.o=t,e&&(this.defaultRender=e),this.ignoreTags=i}zs.prototype={o:Wn,ignoreTags:[],defaultRender(n){return n},check(n){return this.get("validate",n.toString(),n)},get(n,e,t){const r=e!=null;let i=this.o[n];return i&&(typeof i=="object"?(i=t.t in i?i[t.t]:Wn[n],typeof i=="function"&&r&&(i=i(e,t))):typeof i=="function"&&r&&(i=i(e,t.t,t)),i)},getObj(n,e,t){let r=this.o[n];return typeof r=="function"&&e!=null&&(r=r(e,t.t,t)),r},render(n){const e=n.render(this);return(this.get("render",null,n)||this.defaultRender)(e,n.t,n)}};function il(n){return n}function Za(n,e){this.t="token",this.v=n,this.tk=e}Za.prototype={isLink:!1,toString(){return this.v},toHref(n){return this.toString()},toFormattedString(n){const e=this.toString(),t=n.get("truncate",e,this),r=n.get("format",e,this);return t&&r.length>t?r.substring(0,t)+"":r},toFormattedHref(n){return n.get("formatHref",this.toHref(n.get("defaultProtocol")),this)},startIndex(){return this.tk[0].s},endIndex(){return this.tk[this.tk.length-1].e},toObject(n){return n===void 0&&(n=Wn.defaultProtocol),{type:this.t,value:this.toString(),isLink:this.isLink,href:this.toHref(n),start:this.startIndex(),end:this.endIndex()}},toFormattedObject(n){return{type:this.t,value:this.toFormattedString(n),isLink:this.isLink,href:this.toFormattedHref(n),start:this.startIndex(),end:this.endIndex()}},validate(n){return n.get("validate",this.toString(),this)},render(n){const e=this,t=this.toHref(n.get("defaultProtocol")),r=n.get("formatHref",t,this),i=n.get("tagName",t,e),s=this.toFormattedString(n),o={},l=n.get("className",t,e),a=n.get("target",t,e),c=n.get("rel",t,e),u=n.getObj("attributes",t,e),d=n.getObj("events",t,e);return o.href=r,l&&(o.class=l),a&&(o.target=a),c&&(o.rel=c),u&&Sn(o,u),{tagName:i,attributes:o,content:s,eventListeners:d}}};function Qr(n,e){class t extends Za{constructor(i,s){super(i,s),this.t=n}}for(const r in e)t.prototype[r]=e[r];return t.t=n,t}const sl=Qr("email",{isLink:!0,toHref(){return"mailto:"+this.toString()}}),ol=Qr("text"),wm=Qr("nl"),vt=Qr("url",{isLink:!0,toHref(n){return n===void 0&&(n=Wn.defaultProtocol),this.hasProtocol()?this.v:`${n}://${this.v}`},hasProtocol(){const n=this.tk;return n.length>=2&&n[0].t!==_n&&n[1].t===mt}}),le=n=>new Ne(n);function xm(n){let{groups:e}=n;const t=e.domain.concat([wr,Mr,ht,Cr,Er,Or,Tr,Ar,Je,Is,Nr,vr,Ir,Dr,qe,Lr,Rn,Pr]),r=[xr,cn,Rt,an,Pt,mt,Rs,Ue,Ps,In,ln,vn,Dn,Rr,Ls,Bs],i=[wr,xr,Mr,Cr,Er,Or,Rt,Tr,Ar,Je,ln,Nr,vr,Ir,Dr,Rr,qe,Lr,Rn,Pr],s=le(),o=x(s,Rn);D(o,i,o),D(o,e.domain,o);const l=le(),a=le(),c=le();D(s,e.domain,l),D(s,e.scheme,a),D(s,e.slashscheme,c),D(l,i,o),D(l,e.domain,l);const u=x(l,ht);x(o,ht,u),x(a,ht,u),x(c,ht,u);const d=x(o,Ue);D(d,i,o),D(d,e.domain,o);const h=le();D(u,e.domain,h),D(h,e.domain,h);const f=x(h,Ue);D(f,e.domain,h);const p=le(sl);D(f,e.tld,p),D(f,e.utld,p),x(u,_n,p);const m=x(h,Je);D(m,e.domain,h),D(p,e.domain,h),x(p,Ue,f),x(p,Je,m);const g=x(p,mt);D(g,e.numeric,sl);const k=x(l,Je),w=x(l,Ue);D(k,e.domain,l),D(w,i,o),D(w,e.domain,l);const P=le(vt);D(w,e.tld,P),D(w,e.utld,P),D(P,e.domain,l),D(P,i,o),x(P,Ue,w),x(P,Je,k),x(P,ht,u);const U=x(P,mt),W=le(vt);D(U,e.numeric,W);const N=le(vt),Y=le();D(N,t,N),D(N,r,Y),D(Y,t,N),D(Y,r,Y),x(P,qe,N),x(W,qe,N);const se=x(a,mt),v=x(c,mt),$=x(v,qe),ge=x($,qe);D(a,e.domain,l),x(a,Ue,w),x(a,Je,k),D(c,e.domain,l),x(c,Ue,w),x(c,Je,k),D(se,e.domain,N),x(se,qe,N),D(ge,e.domain,N),D(ge,t,N),x(ge,qe,N);const Le=x(N,ln),z=x(N,vn),O=x(N,In),C=x(N,Dn);x(Y,ln,Le),x(Y,vn,z),x(Y,In,O),x(Y,Dn,C),x(Le,Rt,N),x(z,an,N),x(O,cn,N),x(C,Pt,N),x(Le,Rt,N);const y=le(vt),b=le(vt),M=le(vt),E=le(vt);D(Le,t,y),D(z,t,b),D(O,t,M),D(C,t,E);const L=le(),K=le(),J=le(),X=le();return D(Le,r),D(z,r),D(O,r),D(C,r),D(y,t,y),D(b,t,b),D(M,t,M),D(E,t,E),D(y,r,y),D(b,r,b),D(M,r,M),D(E,r,E),D(L,t,L),D(K,t,b),D(J,t,M),D(X,t,E),D(L,r,L),D(K,r,K),D(J,r,J),D(X,r,X),x(b,an,N),x(M,cn,N),x(E,Pt,N),x(y,Rt,N),x(K,an,N),x(J,cn,N),x(X,Pt,N),x(L,Pt,N),x(s,_n,P),x(s,Ds,wm),{start:s,tokens:Qa}}function Mm(n,e,t){let r=t.length,i=0,s=[],o=[];for(;i<r;){let l=n,a=null,c=null,u=0,d=null,h=-1;for(;i<r&&!(a=l.go(t[i].t));)o.push(t[i++]);for(;i<r&&(c=a||l.go(t[i].t));)a=null,l=c,l.accepts()?(h=0,d=l):h>=0&&h++,i++,u++;if(h<0)i-=u,i<r&&(o.push(t[i]),i++);else{o.length>0&&(s.push(Ai(ol,e,o)),o=[]),i-=h,u-=h;const f=d.t,p=t.slice(i-u,i);s.push(Ai(f,e,p))}}return o.length>0&&s.push(Ai(ol,e,o)),s}function Ai(n,e,t){const r=t[0].s,i=t[t.length-1].e,s=e.slice(r,i);return new n(s,t)}const Cm=typeof console<"u"&&console&&console.warn||(()=>{}),Em="until manual call of linkify.init(). Register all schemes and plugins before invoking linkify the first time.",te={scanner:null,parser:null,tokenQueue:[],pluginQueue:[],customSchemes:[],initialized:!1};function Om(){Ne.groups={},te.scanner=null,te.parser=null,te.tokenQueue=[],te.pluginQueue=[],te.customSchemes=[],te.initialized=!1}function ll(n,e){if(e===void 0&&(e=!1),te.initialized&&Cm(`linkifyjs: already initialized - will not register custom scheme "${n}" ${Em}`),!/^[0-9a-z]+(-[0-9a-z]+)*$/.test(n))throw new Error(`linkifyjs: incorrect scheme format.
 1. Must only contain digits, lowercase ASCII letters or "-"
 2. Cannot start or end with "-"
 3. "-" cannot repeat`);te.customSchemes.push([n,e])}function Tm(){te.scanner=bm(te.customSchemes);for(let n=0;n<te.tokenQueue.length;n++)te.tokenQueue[n][1]({scanner:te.scanner});te.parser=xm(te.scanner.tokens);for(let n=0;n<te.pluginQueue.length;n++)te.pluginQueue[n][1]({scanner:te.scanner,parser:te.parser});te.initialized=!0}function Am(n){return te.initialized||Tm(),Mm(te.parser.start,n,km(te.scanner.start,n))}function is(n,e,t){if(e===void 0&&(e=null),t===void 0&&(t=null),e&&typeof e=="object"){if(t)throw Error(`linkifyjs: Invalid link type ${e}; must be a string`);t=e,e=null}const r=new zs(t),i=Am(n),s=[];for(let o=0;o<i.length;o++){const l=i[o];l.isLink&&(!e||l.t===e)&&s.push(l.toFormattedObject(r))}return s}function Nm(n){return new me({key:new Pe("autolink"),appendTransaction:(e,t,r)=>{const i=e.some(c=>c.docChanged)&&!t.doc.eq(r.doc),s=e.some(c=>c.getMeta("preventAutolink"));if(!i||s)return;const{tr:o}=r,l=bf(t.doc,[...e]);if(Tf(l).forEach(({newRange:c})=>{const u=Sf(r.doc,c,f=>f.isTextblock);let d,h;if(u.length>1?(d=u[0],h=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(c.from,c.to," "," ").endsWith(" ")&&(d=u[0],h=r.doc.textBetween(d.pos,c.to,void 0," ")),d&&h){const f=h.split(" ").filter(g=>g!=="");if(f.length<=0)return!1;const p=f[f.length-1],m=d.pos+h.lastIndexOf(p);if(!p)return!1;is(p).filter(g=>g.isLink).map(g=>({...g,from:m+g.start+1,to:m+g.end+1})).filter(g=>r.schema.marks.code?!r.doc.rangeHasMark(g.from,g.to,r.schema.marks.code):!0).filter(g=>n.validate?n.validate(g.value):!0).forEach(g=>{Cs(g.from,g.to,r.doc).some(k=>k.mark.type===n.type)||o.addMark(g.from,g.to,n.type.create({href:g.href}))})}}),!!o.steps.length)return o}})}function vm(n){return new me({key:new Pe("handleClickLink"),props:{handleClick:(e,t,r)=>{var i,s;if(r.button!==0||r.target.nodeName!=="A")return!1;const l=Pa(e.state,n.type.name),a=r.target,c=(i=a?.href)!==null&&i!==void 0?i:l.href,u=(s=a?.target)!==null&&s!==void 0?s:l.target;return a&&c?(e.editable&&window.open(c,u),!0):!1}}})}function Im(n){return new me({key:new Pe("handlePasteLink"),props:{handlePaste:(e,t,r)=>{var i,s;const{state:o}=e,{selection:l}=o;if(o.doc.resolve(l.from).parent.type.spec.code)return!1;let a="";r.content.forEach(w=>{a+=w.textContent});let c=!1;if(r.content.descendants(w=>{w.marks.some(P=>P.type.name===n.type.name)&&(c=!0)}),c)return;const u=is(a).find(w=>w.isLink&&w.value===a);if(!l.empty&&n.linkOnPaste){const w=u?.href||null;if(w)return n.editor.commands.setMark(n.type,{href:w}),!0}const d=((i=r.content.firstChild)===null||i===void 0?void 0:i.type.name)==="text",h=(s=r.content.firstChild)===null||s===void 0?void 0:s.marks.some(w=>w.type.name===n.type.name);if(d&&h||!n.linkOnPaste)return!1;if(u&&l.empty)return n.editor.commands.insertContent(`<a href="${u.href}">${u.href}</a>`),!0;const{tr:f}=o;let p=!1;l.empty||(p=!0,f.delete(l.from,l.to));let m=l.from,g=[];r.content.forEach(w=>{g=is(w.textContent),f.insert(m-1,w),g.length>0&&(p=!1,g.forEach(P=>{const U=m+P.start,W=m+P.end;f.doc.rangeHasMark(U,W,n.type)||f.addMark(U,W,n.type.create({href:P.href}))})),m+=w.nodeSize});const k=g.length>0;return f.docChanged&&!p&&k?(n.editor.view.dispatch(f),!0):!1}}})}const Dm=Ae.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach(n=>{if(typeof n=="string"){ll(n);return}ll(n.scheme,n.optionalSlashes)})},onDestroy(){Om()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}},addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:'a[href]:not([href *= "javascript:" i])'}]},renderHTML({HTMLAttributes:n}){return["a",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setLink:n=>({chain:e})=>e().setMark(this.name,n).setMeta("preventAutolink",!0).run(),toggleLink:n=>({chain:e})=>e().toggleMark(this.name,n,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:n})=>n().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addProseMirrorPlugins(){const n=[];return this.options.autolink&&n.push(Nm({type:this.type,validate:this.options.validate})),this.options.openOnClick&&n.push(vm({type:this.type})),n.push(Im({editor:this.editor,type:this.type,linkOnPaste:this.options.linkOnPaste})),n}}),Rm=De.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something ",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new me({key:new Pe("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!t)return null;const s=n.type.createAndFill(),o=s?.sameMarkup(n)&&s.content.findDiffStart(n.content)===null;return n.descendants((l,a)=>{const c=r>=a&&r<=a+l.nodeSize,u=!l.isLeaf&&!l.childCount;if((c||!this.options.showOnlyCurrent)&&u){const d=[this.options.emptyNodeClass];o&&d.push(this.options.emptyEditorClass);const h=ve.node(a,a+l.nodeSize,{class:d.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:l,pos:a,hasAnchor:c}):this.options.placeholder});i.push(h)}return this.options.includeChildren}),re.create(n,i)}}})]}}),Pm=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Lm=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,ec=Ae.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){const n={};return xs()?n["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():n["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),n},addInputRules(){return[qt({find:Pm,type:this.type})]},addPasteRules(){return[Gt({find:Lm,type:this.type})]}}),Bm=Ae.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(n){return n!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sub",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setSubscript:()=>({commands:n})=>n.setMark(this.name),toggleSubscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSubscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),zm=Ae.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(n){return n!=="super"?!1:null}}]},renderHTML({HTMLAttributes:n}){return["sup",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setSuperscript:()=>({commands:n})=>n.setMark(this.name),toggleSuperscript:()=>({commands:n})=>n.toggleMark(this.name),unsetSuperscript:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),Fm=Ae.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["u",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setUnderline:()=>({commands:n})=>n.setMark(this.name),toggleUnderline:()=>({commands:n})=>n.toggleMark(this.name),unsetUnderline:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),$m=({renderers:n})=>we.createElement(we.Fragment,null,Object.entries(n).map(([e,t])=>dc.createPortal(t.reactElement,t.element,e)));class Hm extends we.Component{constructor(e){super(e),this.editorContentRef=we.createRef(),this.initialized=!1,this.state={renderers:{}}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const{editor:e}=this.props;if(e&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=this,e.createNodeViews(),this.initialized=!0}}maybeFlushSync(e){this.initialized?uc.flushSync(e):e()}setRenderer(e,t){this.maybeFlushSync(()=>{this.setState(({renderers:r})=>({renderers:{...r,[e]:t}}))})}removeRenderer(e){this.maybeFlushSync(()=>{this.setState(({renderers:t})=>{const r={...t};return delete r[e],{renderers:r}})})}componentWillUnmount(){const{editor:e}=this.props;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,...t}=this.props;return we.createElement(we.Fragment,null,we.createElement("div",{ref:this.editorContentRef,...t}),we.createElement($m,{renderers:this.state.renderers}))}}const Vm=n=>{const e=we.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return we.createElement(Hm,{key:e,...n})},jm=we.memo(Vm);let _m=class extends ip{constructor(){super(...arguments),this.contentComponent=null}};function Wm(){const[,n]=ke.useState(0);return()=>n(e=>e+1)}const Km=(n={},e=[])=>{const[t,r]=ke.useState(null),i=Wm(),{onBeforeCreate:s,onBlur:o,onCreate:l,onDestroy:a,onFocus:c,onSelectionUpdate:u,onTransaction:d,onUpdate:h}=n,f=ke.useRef(s),p=ke.useRef(o),m=ke.useRef(l),g=ke.useRef(a),k=ke.useRef(c),w=ke.useRef(u),P=ke.useRef(d),U=ke.useRef(h);return ke.useEffect(()=>{t&&(s&&(t.off("beforeCreate",f.current),t.on("beforeCreate",s),f.current=s),o&&(t.off("blur",p.current),t.on("blur",o),p.current=o),l&&(t.off("create",m.current),t.on("create",l),m.current=l),a&&(t.off("destroy",g.current),t.on("destroy",a),g.current=a),c&&(t.off("focus",k.current),t.on("focus",c),k.current=c),u&&(t.off("selectionUpdate",w.current),t.on("selectionUpdate",u),w.current=u),d&&(t.off("transaction",P.current),t.on("transaction",d),P.current=d),h&&(t.off("update",U.current),t.on("update",h),U.current=h))},[s,o,l,a,c,u,d,h,t]),ke.useEffect(()=>{let W=!0;const N=new _m(n);return r(N),N.on("transaction",()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{W&&i()})})}),()=>{W=!1}},e),ke.useEffect(()=>()=>{t?.destroy()},[t]),t},tc=ke.createContext({editor:null}),Um=tc.Consumer,Jm=({children:n,slotAfter:e,slotBefore:t,...r})=>{const i=Km(r);return i?we.createElement(tc.Provider,{value:{editor:i}},t,we.createElement(Um,null,({editor:s})=>we.createElement(jm,{editor:s})),n,e):null},qm=ke.createContext({onDragStart:void 0}),Gm=()=>ke.useContext(qm);we.forwardRef((n,e)=>{const{onDragStart:t}=Gm(),r=n.as||"div";return we.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const Ym=/^\s*>\s$/,Xm=pe.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[$n({find:Ym,type:this.type})]}}),Qm=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,Zm=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,eg=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,tg=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,ng=Ae.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[qt({find:Qm,type:this.type}),qt({find:eg,type:this.type})]},addPasteRules(){return[Gt({find:Zm,type:this.type}),Gt({find:tg,type:this.type})]}}),rg=pe.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ee(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),al=Ae.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Yr(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),cl=/^\s*([-+*])\s$/,ig=pe.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(rg.name,this.editor.getAttributes(al.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=$n({find:cl,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=$n({find:cl,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(al.name),editor:this.editor})),[n]}}),sg=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,og=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,lg=Ae.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[qt({find:sg,type:this.type})]},addPasteRules(){return[Gt({find:og,type:this.type})]}}),ag=pe.create({name:"doc",topNode:!0,content:"block+"});function cg(n={}){return new me({view(e){return new ug(e,n)}})}class ug{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let l=e.nodeBefore,a=e.nodeAfter;if(l||a){let c=this.editorView.nodeDOM(this.cursorPos-(l?l.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=l?u.bottom:u.top;l&&a&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let l=this.editorView.coordsAtPos(this.cursorPos);r={left:l.left-this.width/2,right:l.left+this.width/2,top:l.top,bottom:l.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let s,o;if(!i||i==document.body&&getComputedStyle(i).position=="static")s=-pageXOffset,o=-pageYOffset;else{let l=i.getBoundingClientRect();s=l.left-i.scrollLeft,o=l.top-i.scrollTop}this.element.style.left=r.left-s+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!s){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=Bl(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const dg=De.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[cg(this.options)]}});class ne extends j{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ne.valid(r)?new ne(r):j.near(r)}content(){return A.empty}eq(e){return e instanceof ne&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ne(e.resolve(t.pos))}getBookmark(){return new Fs(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!hg(e)||!fg(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ne.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(t>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=t;let a=e.doc.resolve(i);if(ne.valid(a))return a}for(;;){let o=t>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!B.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*t),r=!1;continue e}break}s=o,i+=t;let l=e.doc.resolve(i);if(ne.valid(l))return l}return null}}}ne.prototype.visible=!1;ne.findFrom=ne.findGapCursorFrom;j.jsonID("gapcursor",ne);class Fs{constructor(e){this.pos=e}map(e){return new Fs(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ne.valid(t)?new ne(t):j.near(t)}}function hg(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function fg(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function pg(){return new me({props:{decorations:bg,createSelectionBetween(n,e,t){return e.pos==t.pos&&ne.valid(t)?new ne(t):null},handleClick:gg,handleKeyDown:mg,handleDOMEvents:{beforeinput:yg}}})}const mg=wa({ArrowLeft:er("horiz",-1),ArrowRight:er("horiz",1),ArrowUp:er("vert",-1),ArrowDown:er("vert",1)});function er(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,a=o.empty;if(o instanceof H){if(!s.endOfTextblock(t)||l.depth==0)return!1;a=!1,l=r.doc.resolve(e>0?l.after():l.before())}let c=ne.findGapCursorFrom(l,e,a);return c?(i&&i(r.tr.setSelection(new ne(c))),!0):!1}}function gg(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ne.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&B.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ne(r))),!0)}function yg(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ne))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=S.empty;for(let o=r.length-1;o>=0;o--)i=S.from(r[o].createAndFill(null,i));let s=n.state.tr.replace(t.pos,t.pos,new A(i,0,0));return s.setSelection(H.near(s.doc.resolve(t.pos+1))),n.dispatch(s),!1}function bg(n){if(!(n.selection instanceof ne))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",re.create(n.doc,[ve.widget(n.selection.head,e,{key:"gapcursor"})])}const kg=De.create({name:"gapCursor",addProseMirrorPlugins(){return[pg()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=V(I(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),Sg=pe.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ee(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:s}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,a=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&a&&o){const d=a.filter(h=>l.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});var Br=200,ce=function(){};ce.prototype.append=function(e){return e.length?(e=ce.from(e),!this.length&&e||e.length<Br&&this.leafAppend(e)||this.length<Br&&e.leafPrepend(this)||this.appendInner(e)):this};ce.prototype.prepend=function(e){return e.length?ce.from(e).append(this):this};ce.prototype.appendInner=function(e){return new wg(this,e)};ce.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?ce.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};ce.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ce.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};ce.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},t,r),i};ce.from=function(e){return e instanceof ce?e:e&&e.length?new nc(e):ce.empty};var nc=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var a=s;a<o;a++)if(i(this.values[a],l+a)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var a=s-1;a>=o;a--)if(i(this.values[a],l+a)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=Br)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=Br)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(ce);ce.empty=new nc([]);var wg=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ce);const xg=500;class Ve{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,a,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){i||(i=this.remapping(r,h+1),s=i.maps.length),s--,u.push(d);return}if(i){u.push(new Ge(d.map));let f=d.step.map(i.slice(s)),p;f&&o.maybeStep(f).doc&&(p=o.mapping.maps[o.mapping.maps.length-1],c.push(new Ge(p,void 0,void 0,c.length+u.length))),s--,p&&i.appendMap(p,s)}else o.maybeStep(d.step);if(d.selection)return l=i?d.selection.map(i.slice(s)):d.selection,a=new Ve(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:a,transform:o,selection:l}}addTransform(e,t,r,i){let s=[],o=this.eventCount,l=this.items,a=!i&&l.length?l.get(l.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new Ge(e.mapping.maps[u],d,t),f;(f=a&&a.merge(h))&&(h=f,u?s.pop():l=l.slice(0,l.length-1)),s.push(h),t&&(o++,t=void 0),i||(a=h)}let c=o-r.depth;return c>Cg&&(l=Mg(l,c),o-=c),new Ve(l.append(s),o)}remapping(e,t){let r=new un;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new Ve(this.items.append(e.map(t=>new Ge(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(h=>{h.selection&&l--},i);let a=t;this.items.forEach(h=>{let f=s.getMirror(--a);if(f==null)return;o=Math.min(o,f);let p=s.maps[f];if(h.step){let m=e.steps[f].invert(e.docs[f]),g=h.selection&&h.selection.map(s.slice(a+1,f));g&&l++,r.push(new Ge(p,m,g))}else r.push(new Ge(p))},i);let c=[];for(let h=t;h<o;h++)c.push(new Ge(s.maps[h]));let u=this.items.slice(0,i).append(c).append(r),d=new Ve(u,l);return d.emptyItemCount()>xg&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let a=o.step.map(t.slice(r)),c=a&&a.getMap();if(r--,c&&t.appendMap(c,r),a){let u=o.selection&&o.selection.map(t.slice(r));u&&s++;let d=new Ge(c.invert(),a,u),h,f=i.length-1;(h=i.length&&i[f].merge(d))?i[f]=h:i.push(d)}}else o.map&&r--},this.items.length,0),new Ve(ce.from(i.reverse()),s)}}Ve.empty=new Ve(ce.empty,0);function Mg(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Ge{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Ge(t.getMap().invert(),t,this.selection)}}}class ft{constructor(e,t,r,i,s){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const Cg=20;function Eg(n,e,t,r){let i=t.getMeta(Mt),s;if(i)return i.historyState;t.getMeta(Tg)&&(n=new ft(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Mt))return o.getMeta(Mt).redo?new ft(n.done.addTransform(t,void 0,r,sr(e)),n.undone,ul(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new ft(n.done,n.undone.addTransform(t,void 0,r,sr(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=t.getMeta("composition"),a=n.prevTime==0||!o&&n.prevComposition!=l&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Og(t,n.prevRanges)),c=o?Ni(n.prevRanges,t.mapping):ul(t.mapping.maps[t.steps.length-1]);return new ft(n.done.addTransform(t,a?e.selection.getBookmark():void 0,r,sr(e)),Ve.empty,c,t.time,l??n.prevComposition)}else return(s=t.getMeta("rebased"))?new ft(n.done.rebased(t,s),n.undone.rebased(t,s),Ni(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new ft(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Ni(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Og(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(t=!0)}),t}function ul(n){let e=[];return n.forEach((t,r,i,s)=>e.push(i,s)),e}function Ni(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),s=e.map(n[r+1],-1);i<=s&&t.push(i,s)}return t}function rc(n,e,t,r){let i=sr(e),s=Mt.get(e).spec.config,o=(r?n.undone:n.done).popEvent(e,i);if(!o)return;let l=o.selection.resolve(o.transform.doc),a=(r?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),s,i),c=new ft(r?a:o.remaining,r?o.remaining:a,null,0,-1);t(o.transform.setSelection(l).setMeta(Mt,{redo:r,historyState:c}).scrollIntoView())}let vi=!1,dl=null;function sr(n){let e=n.plugins;if(dl!=e){vi=!1,dl=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){vi=!0;break}}return vi}const Mt=new Pe("history"),Tg=new Pe("closeHistory");function Ag(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new me({key:Mt,state:{init(){return new ft(Ve.empty,Ve.empty,null,0,-1)},apply(e,t,r){return Eg(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?ic:r=="historyRedo"?sc:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}const ic=(n,e)=>{let t=Mt.getState(n);return!t||t.done.eventCount==0?!1:(e&&rc(t,n,e,!1),!0)},sc=(n,e)=>{let t=Mt.getState(n);return!t||t.undone.eventCount==0?!1:(e&&rc(t,n,e,!0),!0)},Ng=De.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>ic(n,e),redo:()=>({state:n,dispatch:e})=>sc(n,e)}},addProseMirrorPlugins(){return[Ag(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),vg=pe.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ee(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:i,dispatch:s})=>{var o;if(s){const{$to:l}=i.selection,a=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?i.setSelection(H.create(i.doc,l.pos+1)):l.nodeAfter.isBlock?i.setSelection(B.create(i.doc,l.pos)):i.setSelection(H.create(i.doc,l.pos));else{const c=(o=l.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();c&&(i.insert(a,c),i.setSelection(H.create(i.doc,a+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[La({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),Ig=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Dg=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,Rg=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Pg=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,Lg=Ae.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[qt({find:Ig,type:this.type}),qt({find:Rg,type:this.type})]},addPasteRules(){return[Gt({find:Dg,type:this.type}),Gt({find:Pg,type:this.type})]}}),Bg=pe.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ee(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),zg=pe.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ee(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),hl=Ae.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Yr(n,this.type);return Object.entries(t).some(([,i])=>!!i)?!0:e.unsetMark(this.name)}}}}),fl=/^(\d+)\.\s$/,Fg=pe.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ee(this.options.HTMLAttributes,t),0]:["ol",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(zg.name,this.editor.getAttributes(hl.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=$n({find:fl,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=$n({find:fl,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(hl.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),$g=pe.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ee(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Hg=pe.create({name:"text",group:"inline"}),Vg=De.create({name:"starterKit",addExtensions(){var n,e,t,r,i,s,o,l,a,c,u,d,h,f,p,m,g,k;const w=[];return this.options.blockquote!==!1&&w.push(Xm.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&w.push(ng.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&w.push(ig.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&w.push(lg.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&w.push(Ba.configure((i=this.options)===null||i===void 0?void 0:i.codeBlock)),this.options.document!==!1&&w.push(ag.configure((s=this.options)===null||s===void 0?void 0:s.document)),this.options.dropcursor!==!1&&w.push(dg.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&w.push(kg.configure((l=this.options)===null||l===void 0?void 0:l.gapcursor)),this.options.hardBreak!==!1&&w.push(Sg.configure((a=this.options)===null||a===void 0?void 0:a.hardBreak)),this.options.heading!==!1&&w.push(qa.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&w.push(Ng.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&w.push(vg.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&w.push(Lg.configure((h=this.options)===null||h===void 0?void 0:h.italic)),this.options.listItem!==!1&&w.push(Bg.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&w.push(Fg.configure((p=this.options)===null||p===void 0?void 0:p.orderedList)),this.options.paragraph!==!1&&w.push($g.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&w.push(ec.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&w.push(Hg.configure((k=this.options)===null||k===void 0?void 0:k.text)),w}});var jg={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(cc,function(){var t=1e3,r=6e4,i=36e5,s="millisecond",o="second",l="minute",a="hour",c="day",u="week",d="month",h="quarter",f="year",p="date",m="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(z){var O=["th","st","nd","rd"],C=z%100;return"["+z+(O[(C-20)%10]||O[C]||O[0])+"]"}},P=function(z,O,C){var y=String(z);return!y||y.length>=O?z:""+Array(O+1-y.length).join(C)+z},U={s:P,z:function(z){var O=-z.utcOffset(),C=Math.abs(O),y=Math.floor(C/60),b=C%60;return(O<=0?"+":"-")+P(y,2,"0")+":"+P(b,2,"0")},m:function z(O,C){if(O.date()<C.date())return-z(C,O);var y=12*(C.year()-O.year())+(C.month()-O.month()),b=O.clone().add(y,d),M=C-b<0,E=O.clone().add(y+(M?-1:1),d);return+(-(y+(C-b)/(M?b-E:E-b))||0)},a:function(z){return z<0?Math.ceil(z)||0:Math.floor(z)},p:function(z){return{M:d,y:f,w:u,d:c,D:p,h:a,m:l,s:o,ms:s,Q:h}[z]||String(z||"").toLowerCase().replace(/s$/,"")},u:function(z){return z===void 0}},W="en",N={};N[W]=w;var Y=function(z){return z instanceof ge},se=function z(O,C,y){var b;if(!O)return W;if(typeof O=="string"){var M=O.toLowerCase();N[M]&&(b=M),C&&(N[M]=C,b=M);var E=O.split("-");if(!b&&E.length>1)return z(E[0])}else{var L=O.name;N[L]=O,b=L}return!y&&b&&(W=b),b||!y&&W},v=function(z,O){if(Y(z))return z.clone();var C=typeof O=="object"?O:{};return C.date=z,C.args=arguments,new ge(C)},$=U;$.l=se,$.i=Y,$.w=function(z,O){return v(z,{locale:O.$L,utc:O.$u,x:O.$x,$offset:O.$offset})};var ge=function(){function z(C){this.$L=se(C.locale,null,!0),this.parse(C)}var O=z.prototype;return O.parse=function(C){this.$d=function(y){var b=y.date,M=y.utc;if(b===null)return new Date(NaN);if($.u(b))return new Date;if(b instanceof Date)return new Date(b);if(typeof b=="string"&&!/Z$/i.test(b)){var E=b.match(g);if(E){var L=E[2]-1||0,K=(E[7]||"0").substring(0,3);return M?new Date(Date.UTC(E[1],L,E[3]||1,E[4]||0,E[5]||0,E[6]||0,K)):new Date(E[1],L,E[3]||1,E[4]||0,E[5]||0,E[6]||0,K)}}return new Date(b)}(C),this.$x=C.x||{},this.init()},O.init=function(){var C=this.$d;this.$y=C.getFullYear(),this.$M=C.getMonth(),this.$D=C.getDate(),this.$W=C.getDay(),this.$H=C.getHours(),this.$m=C.getMinutes(),this.$s=C.getSeconds(),this.$ms=C.getMilliseconds()},O.$utils=function(){return $},O.isValid=function(){return this.$d.toString()!==m},O.isSame=function(C,y){var b=v(C);return this.startOf(y)<=b&&b<=this.endOf(y)},O.isAfter=function(C,y){return v(C)<this.startOf(y)},O.isBefore=function(C,y){return this.endOf(y)<v(C)},O.$g=function(C,y,b){return $.u(C)?this[y]:this.set(b,C)},O.unix=function(){return Math.floor(this.valueOf()/1e3)},O.valueOf=function(){return this.$d.getTime()},O.startOf=function(C,y){var b=this,M=!!$.u(y)||y,E=$.p(C),L=function(tt,ye){var Ke=$.w(b.$u?Date.UTC(b.$y,ye,tt):new Date(b.$y,ye,tt),b);return M?Ke:Ke.endOf(c)},K=function(tt,ye){return $.w(b.toDate()[tt].apply(b.toDate("s"),(M?[0,0,0,0]:[23,59,59,999]).slice(ye)),b)},J=this.$W,X=this.$M,Q=this.$D,Me="set"+(this.$u?"UTC":"");switch(E){case f:return M?L(1,0):L(31,11);case d:return M?L(1,X):L(0,X+1);case u:var We=this.$locale().weekStart||0,at=(J<We?J+7:J)-We;return L(M?Q-at:Q+(6-at),X);case c:case p:return K(Me+"Hours",0);case a:return K(Me+"Minutes",1);case l:return K(Me+"Seconds",2);case o:return K(Me+"Milliseconds",3);default:return this.clone()}},O.endOf=function(C){return this.startOf(C,!1)},O.$set=function(C,y){var b,M=$.p(C),E="set"+(this.$u?"UTC":""),L=(b={},b[c]=E+"Date",b[p]=E+"Date",b[d]=E+"Month",b[f]=E+"FullYear",b[a]=E+"Hours",b[l]=E+"Minutes",b[o]=E+"Seconds",b[s]=E+"Milliseconds",b)[M],K=M===c?this.$D+(y-this.$W):y;if(M===d||M===f){var J=this.clone().set(p,1);J.$d[L](K),J.init(),this.$d=J.set(p,Math.min(this.$D,J.daysInMonth())).$d}else L&&this.$d[L](K);return this.init(),this},O.set=function(C,y){return this.clone().$set(C,y)},O.get=function(C){return this[$.p(C)]()},O.add=function(C,y){var b,M=this;C=Number(C);var E=$.p(y),L=function(X){var Q=v(M);return $.w(Q.date(Q.date()+Math.round(X*C)),M)};if(E===d)return this.set(d,this.$M+C);if(E===f)return this.set(f,this.$y+C);if(E===c)return L(1);if(E===u)return L(7);var K=(b={},b[l]=r,b[a]=i,b[o]=t,b)[E]||1,J=this.$d.getTime()+C*K;return $.w(J,this)},O.subtract=function(C,y){return this.add(-1*C,y)},O.format=function(C){var y=this,b=this.$locale();if(!this.isValid())return b.invalidDate||m;var M=C||"YYYY-MM-DDTHH:mm:ssZ",E=$.z(this),L=this.$H,K=this.$m,J=this.$M,X=b.weekdays,Q=b.months,Me=b.meridiem,We=function(ye,Ke,At,nt){return ye&&(ye[Ke]||ye(y,M))||At[Ke].slice(0,nt)},at=function(ye){return $.s(L%12||12,ye,"0")},tt=Me||function(ye,Ke,At){var nt=ye<12?"AM":"PM";return At?nt.toLowerCase():nt};return M.replace(k,function(ye,Ke){return Ke||function(At){switch(At){case"YY":return String(y.$y).slice(-2);case"YYYY":return $.s(y.$y,4,"0");case"M":return J+1;case"MM":return $.s(J+1,2,"0");case"MMM":return We(b.monthsShort,J,Q,3);case"MMMM":return We(Q,J);case"D":return y.$D;case"DD":return $.s(y.$D,2,"0");case"d":return String(y.$W);case"dd":return We(b.weekdaysMin,y.$W,X,2);case"ddd":return We(b.weekdaysShort,y.$W,X,3);case"dddd":return X[y.$W];case"H":return String(L);case"HH":return $.s(L,2,"0");case"h":return at(1);case"hh":return at(2);case"a":return tt(L,K,!0);case"A":return tt(L,K,!1);case"m":return String(K);case"mm":return $.s(K,2,"0");case"s":return String(y.$s);case"ss":return $.s(y.$s,2,"0");case"SSS":return $.s(y.$ms,3,"0");case"Z":return E}return null}(ye)||E.replace(":","")})},O.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},O.diff=function(C,y,b){var M,E=this,L=$.p(y),K=v(C),J=(K.utcOffset()-this.utcOffset())*r,X=this-K,Q=function(){return $.m(E,K)};switch(L){case f:M=Q()/12;break;case d:M=Q();break;case h:M=Q()/3;break;case u:M=(X-J)/6048e5;break;case c:M=(X-J)/864e5;break;case a:M=X/i;break;case l:M=X/r;break;case o:M=X/t;break;default:M=X}return b?M:$.a(M)},O.daysInMonth=function(){return this.endOf(d).$D},O.$locale=function(){return N[this.$L]},O.locale=function(C,y){if(!C)return this.$L;var b=this.clone(),M=se(C,y,!0);return M&&(b.$L=M),b},O.clone=function(){return $.w(this.$d,this)},O.toDate=function(){return new Date(this.valueOf())},O.toJSON=function(){return this.isValid()?this.toISOString():null},O.toISOString=function(){return this.$d.toISOString()},O.toString=function(){return this.$d.toUTCString()},z}(),Le=ge.prototype;return v.prototype=Le,[["$ms",s],["$s",o],["$m",l],["$H",a],["$W",c],["$M",d],["$y",f],["$D",p]].forEach(function(z){Le[z[1]]=function(O){return this.$g(O,z[0],z[1])}}),v.extend=function(z,O){return z.$i||(z(O,ge,v),z.$i=!0),v},v.locale=se,v.isDayjs=Y,v.unix=function(z){return v(1e3*z)},v.en=N[W],v.Ls=N,v.p={},v})})(jg);function qg(){const n=[Vg,qa.configure({levels:[1,2,3]}),lm,cm,Dm.configure({autolink:!0,openOnLink:!0}),Rm.configure({placeholder:"Start writing!"}),ec,Bm,zm,Fm];return ni.jsxs("div",{className:"prose",id:"editor",children:[ni.jsx(Jm,{content:`<p>Ah! Day one of making.</p>
<p>First, about this specific one! (Yes, you can start your own.) This is the original one, with a start date of 09/15/2023 and a time period of 365 days, or exactly one year.</p>
<p>So what exactly do <a href="https://jianminchen.com">I</a> plan to do during this one year? Well, right now Id like to get my hands to start tinkering a tad bit more with hard(ware) things, and Id also like to explore low-level computer stuff a bit more too.</p>
<p>So I sat down and thought about what Id like to be able to do and/or build by the end of the year:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled=""> Graduation cap (or any other surface) but add lights! PCB designed to power a grid of LEDS (e.g., 50x50) and design a <a href="https://github.com/jianmin-chen/lights">custom programming language</a> to program the lights over Bluetooth with programs like Conways Game of Life or the Life Engine. (Maybe ones to hang on walls, as a Christmas/birthday gift.)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> DIY typewriter for the iPad! Learn 3D printing (Onshape) and design parts for typewriter (keys, etc.) and then wire up to custom designed PCB to have a typewriter iPad.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Sorting hat! Design PCB to write up to mic and speaker, with the mic feeding content into ChatGPT and returning a result (the houses! Hufflepuff, Ravenclaw, Gryffindor, and Slytherin) based on the given content (i.e., an icebreaker).</li>
<li class="task-list-item"><input type="checkbox" disabled=""> A cheap and easy drone kit from scratch, with support for a protocol like <a href="https://mavlink.io/en/">Mavlink</a> so we can create something like <a href="https://github.com/jianmin-chen/beav">Beav</a>, a programming language that will be to take in sensor data and map that a LOGO inspired language</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Adjust <a href="https://blot.hackclub.com">Blot</a> to become an actual moving turtle, as in <a href="http://www.secret-coders.com/">Secret Coders</a> (highly recommend as a birthday gift for kids!)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Clue but in Slack. (One of the things I learned how to do recently was build Slack bots.)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write a explainer on Rust, with a couple of projects (I see this as <em>Rust but Fun</em>):
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled=""> A tarot card simulator (and an explanation on how tarot cards work?! Ive always wanted to learn)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write <code>netcrab</code>, chat over sockets but in Rust (<code>netc</code>  <code>netcrab</code>, get it?)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write a web server and deploy a static site with it</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write a static site generator to be used in conjunction with the web server!</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write a Markdown parser for the static site generator, and explore how to port that to WebAssembly for funsies</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Write a chess engine in Rust. (Maybe pair program with <a href="https://github.com/pensquid/yobmef">someone</a> on this?)</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Build a game. This is in its infant stages and Im not sure what this entails, but well see.</li>
</ul>
<p>Whew, thats a lot already, and Im 110% sure this list will grow as the year goes on! And some cool projects that I never finished but would love to finish and do a writeup on:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled=""> <a href="https://github.com/jianmin-chen/marrow"><code>marrow</code></a>, a minimal modal-based text editor like Vim.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <a href="https://github.com/jianmin-chen/faceterm"><code>faceterm</code></a>, FaceTime over the terminal.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <a href="https://github.com/jianmin-chen/pokegotchi"><code>pokegotchi</code></a>, what happens when you combine Pokemon with Tamagotchi with exercise. (Although, <a href="#extras">what if I use my own art</a>?)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <a href="https://github.com/racoagency/startwebdev"><code>startwebdev</code></a>, a little guide on web development zero to hero that I never actually got around to writing</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <code>nest</code>, a DIY PaaS from scratch (very basic, literally just interfacing with Docker on a VM on DigitalOcean) to learn a bit more about devops</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Doom but make it multiplayer. Because why not?</li>
</ul>
<h2 id="but-why">But why?</h2>
<p>I kind of had to ask myself the same question. Theres the obvious answer: <strong>its cool</strong>. But I also think that there arent enough resources/demonstrations out there that show how one person got from A to B in the engineering world - or any kind of creative pursuit really - we just kind of assume that people know how to do things. Id like to change that, and Id like to show that its okay to not know how to do something, and that its actually monumental to learn things slowly, one day at a time.</p>
<p>Not only do I want people to be able to see that they can build cool shit just by doing one thing everyday and really appreciating the journey (something that I should start doing more), I want people to also be able to follow along in theory if they want to. <strong>This is why I plan on posting more longform content</strong> vs. a short update every day - I can describe my struggles in more detail. Another thing I plan on doing is actually writing more formal guides on how to do everything Im going to be doing, perhaps through <a href="https://jams.hackclub.com">Hack Club Jams</a>.</p>
<h2 id="how">How?</h2>
<p>Everyday, Ill write one of these and send out a respective newsletter update to those who are subscribed. This website lets me do that (I write more about it below.) Every time I update a day, youll see one of the boxes on the main page unlocked, which I think is a really cool indication of progress. Over time all the boxes will slowly be unlocked, leading up to the final, 365th day!</p>
<p><em>No, but how?</em> Oh, yeah. Lets take a look at some of these. Someone I work with recently recommended <a href="https://fabacademy.org">Fab Academy</a>, which Im going to work through every day kind of like I did with <a href="https://cs50.harvard.edu/college/">CS50</a>. This is going to be super useful for learning hardware stuff (I mean, its a course on how to make almost anything, so). For Rust, Im looking at <a href="https://fasterthanli.me/articles/a-half-hour-to-learn-rust">this</a> excellent article by <a href="https://fasterthanli.me/">Faster Than Lime</a> and Frontend Masters <a href="https://frontendmasters.com/courses/rust/">course</a> (which you can get for <a href="https://education.github.com/pack">free</a> if youre a teen!) on Rust. I also am super grateful that I know a bunch of people around me who are super well-versed in topics that fall in line with what Im trying to learn, which is perfect.</p>
<h2 id="today">Today</h2>
<p>Okay, so what am I planning to do today? Well, for starters, I just finished and deployed this website, which is awesome. I built it with <a href="https://astro.build/">Astro</a> and <a href="https://firebase.google.com/">Firebase</a>, which I havent really worked with. (Ok, Ive worked with Firebase before, but it was a long time ago when I didnt know what leaking API keys meant.)</p>
<p>Most of this site is statically generated with Asto. Astro is actually really easy to use! It reminds me of <a href="https://svelte.dev/">Svelte</a> but more compromising - it lets you add adapters for other libraries/frameworks. For example, the header and the webring on this site is written with React.</p>
<p>I can <a href="/signin">login</a> and write newsletters with Markdown, which gets sent using <a href="https://www.mailgun.com/">Mailgun</a>s Node wrapper. All newsletters are saved within Firebase so that you can see them if youre not interested in subbing to updates.</p>
<p>The comment system is powered by <a href="https://giscus.app/"><code>giscus</code></a>, which lets me use GitHub Discussions for commenting with replies.</p>
<h2 id="extras">Extras</h2>
<p>I would consider myself to be a generally creative person and also want to explore other venues for expressing creativity outside of software/hardware stuff this year. I really think Ill enjoy doing these things and posting about them occasionally:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled=""> Learn digital art, as in making art with Procreate. I would love to be able to make art for a redesign of a personal website or perhaps for <a href="https://hackathons.hackclub.com">events</a> that Ill be helping run.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Learn how to make music. As in, producing a song. Id like to learn how to do that, I just need to do a tad bit more research on how exactly. It would be awesome to listen to something I made that I can jam out to.</li>
<li class="task-list-item"><input type="checkbox" disabled=""> Learn photography. Really, expressing emotion through photography. I was in the New York Public Library recently and I found two really nice books that I might read: <a href="https://www.goodreads.com/book/show/35209766-zen-camera">Zen Camera</a> and <a href="https://www.goodreads.com/book/show/29027800-langford-s-basic-photography">Langfords Basic Photography</a>. I also need a camera currently, <a href="https://www.kenrockwell.com/tech/recommended-cameras.htm">Ken Rockwells</a> website (recommended by a <a href="https://www.hugohu.me/">friend</a>) has been really useful and I may consider (or I mean, I have to) buy a camera.</li>
</ul>
<p>That reminds me - in newsletters, Ill occasionally also post other daily things - maybe an cool article I found, or a cool video I found. If youre not subscribed to these newsletters but still want to view them, theyll be embed at the bottom of every one of these daily entries after I send them out.</p>
<p>P.S. learning how to do these things reminds me of this quote:</p>
<blockquote>
<p>Nobody tells this to people who are beginners, I wish someone told me. All of us who do creative work, we get into it because we have good taste. But there is this gap. For the first couple years you make stuff, its just not that good. Its trying to be good, it has potential, but its not. But your taste, the thing that got you into the game, is still killer. And your taste is why your work disappoints you. A lot of people never get past this phase, they quit. Most people I know who do interesting, creative work went through years of this. We know our work doesnt have this special thing that we want it to have. We all go through this. And if you are just starting out or you are still in this phase, you gotta know its normal and the most important thing you can do is do a lot of work. Put yourself on a deadline so that every week you will finish one story. It is only by going through a volume of work that you will close that gap, and your work will be as good as your ambitions. And I took longer to figure out how to do this than anyone Ive ever met. Its gonna take a while. Its normal to take a while. Youve just gotta fight your way through.  Ira Glass</p>
</blockquote>
<p>See you tomorrow!</p><p>Have a question? Fire below.</p>`,extensions:n}),ni.jsx("button",{children:"Send "})]})}export{qg as default};
